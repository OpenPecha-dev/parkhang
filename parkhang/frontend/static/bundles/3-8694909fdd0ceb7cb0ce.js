(window.webpackJsonpparkhang=window.webpackJsonpparkhang||[]).push([[3],{1005:function(t,e,n){t.exports={textlist:"TextList---textlist",open:"TextList---open",listToggelBtn:"TextList---listToggelBtn"}},1038:function(t,e,n){"use strict";n.r(e);var r=n(953),o=n.n(r),i=(r=n(930),n.n(r)),a=(r=n(938),n.n(r)),s=n(0),l=n.n(s),c=(r=n(33),n(23)),u=n(129),p=n(89),f=n(130),d=n(44),h=n(58),y=n(55),m=n.n(y),g=(y=(n(159),n(928)),n.n(y)),b=(y=n(939),n.n(y)),v=(y=n(87),n.n(y)),w=(n(50),n(309)),O=n(308),S=n(254),x=(y=(n(445),n(972)),n.n(y)),E=(y=(n(167),n(307)),n.n(y)),A=(y=n(940),n.n(y));function T(){return(T=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n,r=arguments[e];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t}).apply(this,arguments)}function j(t){return l.a.createElement("svg",T({viewBox:"0 0 30 40",fill:"currentColor"},t),k,I,P)}var k=l.a.createElement("path",{d:"M3 0h24v15H3z"}),I=l.a.createElement("path",{stroke:"currentColor",strokeWidth:3,d:"M0 20h8M11 20h8M22 20h8"}),P=l.a.createElement("path",{d:"M3 25h24v15H3z"});function C(t){return(C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function R(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(t);!(a=(r=n.next()).done)&&(i.push(r.value),!e||i.length!==e);a=!0);}catch(t){s=!0,o=t}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(t,e)||function(t,e){if(t){if("string"==typeof t)return _(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function B(t,e){var n,r=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)),r}function W(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?B(Object(n),!0).forEach((function(e){var r,o;r=t,o=n[e=e],e in r?Object.defineProperty(r,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[e]=o})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):B(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function N(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function D(t,e){return(D=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function L(t){return(L=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function q(t){return"s_"+t.start}function H(t){return"ds_"+t.start}function M(t){return"i_"+t.start}function z(t){return"p_"+(t.end+1)}function V(t){return"l_"+(t.end+1)}var Q=String.fromCharCode(182),U=A.a.renderToStaticMarkup(l.a.createElement(j,null)),F=function(t){var e=r;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&D(e,t);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=L(t);n=e?(n=L(this).constructor,Reflect.construct(r,arguments,n)):r.apply(this,arguments),r=this;if(n&&("object"===C(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==r)return r;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(r);function r(t){var e;if(this instanceof r)return(e=n.call(this,t)).textAlignmentById=[],e.textRef=l.a.createRef(),e.state={segmentedText:t.segmentedText},e.textAlignmentById=e.props.textAlignmentById,e._renderedSegments=null,e._renderedHtml=null,e.rangeSelect=[],e;throw new TypeError("Cannot call a class as a function")}return e=r,(t=[{key:"UNSAFE_componentWillReceiveProps",value:function(t){this.setState((function(e,n){return W(W({},e),{},{segmentedText:t.segmentedText})}))}},{key:"annotationsForSegment",value:function(t){var e=[],n=this.props.annotationPositions[String(t.start)],r=this.props.annotationPositions[h.c+t.start]||[],o=this.props.annotationPositions[h.b+t.start]||[],i=this.props.annotationPositions[h.e+(t.end+1)]||[];t=this.props.annotationPositions[h.d+(t.end+1)]||[];return(e=n||e).concat(r,o,i,t)}},{key:"segmentsContainSegment",value:function(t,e){for(var n=0;n<t.length;n++){var r=t[n];if(r.start===e.start&&r.text===e.text)return!0}return!1}},{key:"selectedElement",value:function(t){var e=[],n=[],r=document.getSelection();if(null!=t&&t.id.includes("s_")&&this.props.isPanelLinked){for(var o=parseInt(t.id.replace("s_","")),i=(this.props.changeSyncIdOnClick(o),this.props.changeSyncIdOnScroll(null),parseInt(t.id.replace("s_",""))),a=this.textAlignmentById.find((function(t){return i>=t.start&&i<t.end})),s=a.start;s<a.end;s++)e.push(s);for(var l=a.TStart;l<a.TEnd;l++)n.push(l);this.props.changeSelectedRange({source:e,target:n})}r&&"Range"===r.type||(this.props.selectedSegmentId(t.id),t.id||this.props.changeSelectedRange({source:[],target:[]}))}},{key:"generateHtml",value:function(t,e){var n=this,r=e.segmentedText.segments,o=x.a.textLine,i='<p class="'+o+'">';if(0===r.length)return{__html:i};for(var a=x.a.insertion,s=r[r.length-1].end+1,l=(t.annotationPositions[h.c+s]&&(e=new d.a(s,""),r.push(e)),t.annotationPositions[h.e+s]&&(e=new d.a(s,""),r.push(e)),t.annotationPositions[h.d+s]&&(e=new d.a(s,""),r.push(e)),t.activeAnnotations||{}),u=x.a.highlight,p=x.a.activeHighlight,f=null,y={},g=0;g<r.length&&"break"!==function(e){var h=r[e],g=(e="",[]),b=n.annotationsForSegment(h),v=null,w=!1,O=!1,S=!1,E=!1,A=null;if(b){for(var T=[],j=[],k=[],I=[],P=0,C=b.length;P<C;P++){var _,B=b[P];B.isInsertion?B.uniqueId in l?T.push(B):(_=B.start,y.hasOwnProperty(_)||(j.push(B),y[_]=B)):B.isDeletion?B.uniqueId in l&&I.push(B):B.type!==c.a.pageBreak||t.activeWitness.isWorking?B.type!==c.a.lineBreak||t.activeWitness.isWorking?k.push(B):E=B:A=B}0===T.length&&0<j.length&&(W=j[0],N=M(h),D=a,t.activeAnnotation&&t.activeAnnotation.isInsertion&&t.activeAnnotation.start===W.start&&(D+=" "+x.a.selectedAnnotation),i+="<span id="+N+" key="+N+' class="'+D+'">'+W.content+"</span>"),0<I.length&&(N=I[0],v=t.getBaseAnnotation(N).content,t.activeAnnotation&&t.activeAnnotation.isDeletion&&t.activeAnnotation.start===N.start&&t.activeAnnotation.length===N.length&&0===h.length&&(w=!0)),A&&t.activeAnnotation&&t.activeAnnotation.uniqueId===A.uniqueId&&(O=!0),E&&t.activeAnnotation&&t.activeAnnotation.uniqueId===E.uniqueId&&(S=!0),(0<k.length||0<T.length)&&g.push(x.a.annotation)}if(h.start===s)return"break";var W,N,D=null,L=(0===h.length?(D=H(h),g.push(x.a.removedByAnnotation),v&&(h=new d.a(h.start,v))):D=q(h),(n.segmentsContainSegment(t.selectedAnnotatedSegments,h)||w)&&g.push(x.a.selectedAnnotation),t.selectedSourceRange.includes(h.start)&&g.push(x.a.selectedRange),0<g.length&&(e='class="'+m.a.apply(void 0,g)+'"'),h.text);if(t.searchStringPositions){var F=h.start,$=F,G=(L="",u);t.selectedSearchResult&&t.selectedSearchResult.start<=$&&t.selectedSearchResult.start+t.selectedSearchResult.length>$&&(G=p);for(var J=0;J<h.text.length;J++){var Y,K,X,Z=h.text.charAt(J);$=F+J;f?((Y=R(f,2))[0],0===J&&(L+='<span class="'+G+'">'),$===Y[1]?(L+=Z+"</span>",f=null):J===h.text.length-1?L+=Z+"</span>":L+=Z):$ in t.searchStringPositions?(K=(Y=R(t.searchStringPositions[$],2))[0],X=Y[1],L+='<span class="'+G+'">'+Z,J!==h.text.length-1&&$!==X||(L+="</span>"),$<X&&(f=[K,X])):L+=Z}}null!==n.props.textAlignmentById&&(W=n.props.textAlignmentById.find((function(t){return t.start===h.start})))&&(i+="<span id='alignment_"+h.start+"'><sup class="+x.a.syncIdClass+">".concat(W.id,"</sup>")+"</span>"),i+="<span id="+D+" key="+D+" "+e+">"+L+"</span>",A&&(N=[x.a.pageBreak],O&&N.push(x.a.selectedAnnotation),v=' class="'+N.join(" ")+'" ',i+="<span id="+z(h)+" key="+z(h)+v+">"+U+"</span>"),E&&(w=[x.a.lineBreak],S&&w.push(x.a.selectedAnnotation),g=' class="'+w.join(" ")+'" ',i=(i+="<span id="+V(h)+" key="+V(h)+g+">"+Q+"</span>")+'</p><p class="'+o+'">')}(g);g++);return this._renderedSegments=r,{__html:i+="</p>"}}},{key:"componentDidUpdate",value:function(){}},{key:"shouldComponentUpdate",value:function(t,e){return e=this.generateHtml(t,e),this.props.fontSize!==t.fontSize||(!this._renderedHtml||e.__html!==this._renderedHtml.__html)&&(this._renderedHtml=e,!0)}},{key:"render",value:function(){var t=this,e=[x.a.text],n=(0===this.props.row&&e.push(x.a.textFirstRow),this._renderedHtml||this.generateHtml(this.props,this.state));return this._renderedHtml||(this._renderedHtml=n),l.a.createElement("div",{className:x.a.textContainer},l.a.createElement("div",{ref:this.textRef,className:m.a.apply(void 0,e),dangerouslySetInnerHTML:n,style:{fontSize:this.props.fontSize},onClick:function(e){t.selectedElement(e.target)}}))}}])&&N(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),r}(l.a.Component),$=n(925),G=n(193),J=(y=n(941),n.n(y));function Y(){return(Y=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n,r=arguments[e];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t}).apply(this,arguments)}function K(t){return l.a.createElement("svg",Y({viewBox:"0 0 24 24"},t),X,Z)}var X=l.a.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),Z=l.a.createElement("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"}),tt=(y=n(258),n.n(y)),et=n(975);function nt(t){var e=t.children,n=t.tooltipName,r=void 0===(r=t.format)?null:r,o=t.effect,i=t.className;return t.setTimer,l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{"data-tip":!0,"data-for":n,className:void 0===i?"":i,style:{width:"100%"}},e),l.a.createElement(et.a,{id:n,type:"dark",effect:void 0===o?"solid":o},r?l.a.createElement(G.a,{id:r}):l.a.createElement("span",null,n)))}function rt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function ot(t){(e=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(t);!(a=(r=n.next()).done)&&(i.push(r.value),!e||i.length!==e);a=!0);}catch(t){s=!0,o=t}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(t,e)||function(t,e){if(t){if("string"==typeof t)return rt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?rt(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(Object(s.useState)(null),2))[0],e[1];var e=l.a.createElement("p",null,"<",l.a.createElement(G.a,{id:"annotation.delete"}),">"),n=(""!==(n=t.annotationData.content).trim()&&(250<n.length&&(n=n.substr(0,250)+"…"),e=l.a.createElement("p",null,n)),[J.a.annotationDetail]);t.isActive&&n.push(J.a.active),n=m.a.apply(void 0,n);return l.a.createElement("div",{className:n,onClick:t.selectAnnotationHandler},l.a.createElement("div",{className:J.a.annotationHeader},t.isActive&&l.a.createElement("div",{className:J.a.activeIcon},l.a.createElement(K,{style:{fill:tt.a.activeButton},width:15,height:15})),l.a.createElement("h3",null,t.annotationData.name),t.isLoggedIn&&t.isActive&&l.a.createElement("button",{style:{display:"none"},className:J.a.edit,onClick:t.editAnnotationHandler,id:"editBtn"})),!t.isWorkingSection&&e)}function it(t){var e=t.annotationData.content,n=[J.a.annotationDetail],r=null;t.isActive&&n.push(J.a.active),n=m.a.apply(void 0,n);return l.a.createElement("div",{className:n},l.a.createElement("h3",null,t.annotationData.name),l.a.createElement("div",{className:J.a.editing},l.a.createElement("textarea",{defaultValue:e,autoFocus:!0,onInput:function(t){r.style.height="5px",r.style.height=r.scrollHeight+"px"},ref:function(t){return r=t}}),l.a.createElement("div",{className:J.a.actionButtons},l.a.createElement("div",{className:J.a.save,onClick:function(){r&&t.saveAnnotationHandler(r.value)}},l.a.createElement(G.a,{id:"annotation.save"})),l.a.createElement("div",{className:J.a.cancel,onClick:t.cancelAnnotationHandler},l.a.createElement(G.a,{id:"annotation.cancel"})))))}function at(t){return l.a.createElement("div",{className:ut.a.button,title:t.title,onClick:t.onClick},"+")}y=n(926);var st=n.n(y),lt=(y=(n(66),n(43)),n(978)),ct=n.n(lt),ut=(lt=n(979),n.n(lt));function pt(t){return(pt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ft(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function dt(t,e){return(dt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function ht(t){return(ht=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}lt=function(t){var e=r;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&dt(e,t);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=ht(t);n=e?(n=ht(this).constructor,Reflect.construct(r,arguments,n)):r.apply(this,arguments),r=this;if(n&&("object"===pt(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==r)return r;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(r);function r(){var t=this,e=r;if(t instanceof e)return n.apply(this,arguments);throw new TypeError("Cannot call a class as a function")}return e=r,(t=[{key:"render",value:function(){var t,e=null;return this.props.buttonOnClick&&(t=this.props.buttonTitleId?this.props.intl.formatMessage({id:this.props.buttonTitleId}):"",e=l.a.createElement(at,{title:t,onClick:this.props.buttonOnClick})),l.a.createElement("h3",{className:ct.a.heading},l.a.createElement("span",{className:ct.a.title},l.a.createElement(G.a,{id:this.props.titleId})),e&&l.a.createElement("div",{className:ct.a.button},e))}}])&&ft(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),r}(l.a.Component),Object(y.c)(lt),lt=n(980);var yt=n.n(lt),mt=(lt=n(927),n.n(lt));function gt(t){return(gt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function bt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function vt(t,e){return(vt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function wt(t){return(wt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Ot=function(t){var e=r;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&vt(e,t);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=wt(t);n=e?(n=wt(this).constructor,Reflect.construct(r,arguments,n)):r.apply(this,arguments),r=this;if(n&&("object"===gt(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==r)return r;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(r);function r(t){var e;if(this instanceof r)return(e=n.call(this,t)).state={content:t.note.content},e;throw new TypeError("Cannot call a class as a function")}return e=r,(t=[{key:"save",value:function(){var t=this.textarea?this.textarea.value:"";this.props.saveNote(this.props.note,t)}},{key:"cancel",value:function(){this.props.cancel()}},{key:"handleChange",value:function(t){var e=t.target instanceof HTMLTextAreaElement?t.target.value:"";this.setState((function(t,n){return{content:e}}))}},{key:"render",value:function(){var t=this;return l.a.createElement("div",{className:yt.a.editorContainer},l.a.createElement("textarea",{className:yt.a.textEditor,ref:function(e){return t.textarea=e},value:this.state.content,onChange:this.handleChange.bind(this)}),l.a.createElement("div",{className:mt.a.buttonContainer},l.a.createElement("div",{className:mt.a.save,onClick:this.save.bind(this)},l.a.createElement(G.a,{id:"annotation.save"})),l.a.createElement("div",{className:mt.a.cancel,onClick:this.cancel.bind(this)},l.a.createElement(G.a,{id:"annotation.cancel"}))))}}])&&bt(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),r}(l.a.Component),St=(lt=n(981),n.n(lt)),xt=(lt=(n(256),n(982)),n.n(lt)),Et=(n(192),n(166));function At(t){return(At="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Tt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function jt(t,e){return(jt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function kt(t){return(kt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var It=function(t){var e=r;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&jt(e,t);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=kt(t);n=e?(n=kt(this).constructor,Reflect.construct(r,arguments,n)):r.apply(this,arguments),r=this;if(n&&("object"===At(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==r)return r;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(r);function r(){var t=this,e=r;if(t instanceof e)return n.apply(this,arguments);throw new TypeError("Cannot call a class as a function")}return e=r,(t=[{key:"render",value:function(){return l.a.createElement("div",{className:xt.a.answer},l.a.createElement("p",{className:st.a.text,dangerouslySetInnerHTML:{__html:this.props.answer.content}}),l.a.createElement("p",{className:st.a.subTitle},l.a.createElement(G.a,{id:"question.answeredBy"})," ",this.props.answer.name,","," ",l.a.createElement(Et.FormattedDate,{value:this.props.answer.created})))}}])&&Tt(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),r}(l.a.Component),Pt=n(67);function Ct(t){return(Ct="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Rt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _t(t,e){return(_t=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Bt(t){return(Bt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Wt=function(t){var e=r;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_t(e,t);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Bt(t);n=e?(n=Bt(this).constructor,Reflect.construct(r,arguments,n)):r.apply(this,arguments),r=this;if(n&&("object"===Ct(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==r)return r;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(r);function r(){var t=this,e=r;if(t instanceof e)return n.apply(this,arguments);throw new TypeError("Cannot call a class as a function")}return e=r,(t=[{key:"render",value:function(){var t=Pt.f+this.props.question.topicId,e=[],n=this.props.question.answers;console.log(n);for(var r=0;r<n.length;r++){var o=n[r];e.push(l.a.createElement(It,{answer:o,key:"answer_"+o.created}))}var i=0<this.props.question.name.length?this.props.question.name:this.props.question.username;return l.a.createElement("div",{className:m()(St.a.question,st.a.padding)},l.a.createElement("span",{className:m()(St.a.threadLink,st.a.text)},l.a.createElement("a",{href:t,target:"_blank"},l.a.createElement(G.a,{id:"question.viewThread"}))),l.a.createElement("p",{className:st.a.text,dangerouslySetInnerHTML:{__html:this.props.question.content}}),l.a.createElement("p",{className:st.a.subTitle},i,","," ",l.a.createElement(Et.FormattedDate,{value:this.props.question.created})),e)}}])&&Rt(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),r}(l.a.Component),Nt=(lt=n(983),n.n(lt));function Dt(t){return(Dt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Lt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function qt(t,e){return(qt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Ht(t){return(Ht=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Mt=function(t){var e=r;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&qt(e,t);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Ht(t);n=e?(n=Ht(this).constructor,Reflect.construct(r,arguments,n)):r.apply(this,arguments),r=this;if(n&&("object"===Dt(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==r)return r;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(r);function r(t){var e;if(this instanceof r)return(e=n.call(this,t)).state={content:t.question.content},e;throw new TypeError("Cannot call a class as a function")}return e=r,(t=[{key:"save",value:function(){var t=this.textarea?this.textarea.value:"";this.props.saveQuestion(this.props.question,this.props.defaultTitle,t)}},{key:"cancel",value:function(){this.props.cancel()}},{key:"handleChange",value:function(t){var e=t.target instanceof HTMLTextAreaElement?t.target.value:"";this.setState((function(t,n){return{content:e}}))}},{key:"render",value:function(){var t=this;return l.a.createElement("div",{className:Nt.a.editorContainer},l.a.createElement("div",null,this.props.questionQuote),l.a.createElement("textarea",{className:Nt.a.textEditor,ref:function(e){return t.textarea=e},value:this.state.content,onChange:this.handleChange.bind(this)}),l.a.createElement("div",{className:mt.a.buttonContainer},l.a.createElement("div",{className:mt.a.save,onClick:this.save.bind(this)},l.a.createElement(G.a,{id:"annotation.save"})),l.a.createElement("div",{className:mt.a.cancel,onClick:this.cancel.bind(this)},l.a.createElement(G.a,{id:"annotation.cancel"}))))}}])&&Lt(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),r}(l.a.Component),zt=(lt=n(984),n.n(lt)),Vt=(lt=n(311),n.n(lt));function Qt(t){return(Qt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ut(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ft(t,e){return(Ft=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function $t(t){return($t=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Gt=function(t){var e=r;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ft(e,t);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=$t(t);n=e?(n=$t(this).constructor,Reflect.construct(r,arguments,n)):r.apply(this,arguments),r=this;if(n&&("object"===Qt(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==r)return r;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(r);function r(){var t=this,e=r;if(t instanceof e)return n.apply(this,arguments);throw new TypeError("Cannot call a class as a function")}return e=r,(t=[{key:"render",value:function(){return l.a.createElement("div",{className:m()(zt.a.loading,st.a.text)},l.a.createElement(Vt.a,{loaded:!1,scale:.25,position:"relative",top:"50%",left:"50%",lines:9,width:8,length:8,radius:14}),"Loading questions...")}}])&&Ut(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),r}(l.a.Component),Jt=(lt=n(985),n.n(lt));function Yt(t){return(Yt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Kt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Xt(t,e){return(Xt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Zt(t){return(Zt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var te=function(t){var e=r;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Xt(e,t);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Zt(t);n=e?(n=Zt(this).constructor,Reflect.construct(r,arguments,n)):r.apply(this,arguments),r=this;if(n&&("object"===Yt(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==r)return r;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(r);function r(){var t=this,e=r;if(t instanceof e)return n.apply(this,arguments);throw new TypeError("Cannot call a class as a function")}return e=r,(t=[{key:"delete",value:function(){this.props.delete&&this.props.delete(this.props.note)}},{key:"edit",value:function(){this.props.edit&&this.props.edit(this.props.note)}},{key:"render",value:function(){return l.a.createElement("div",{className:Jt.a.note},l.a.createElement("div",{className:Jt.a.header},l.a.createElement("h4",{className:Jt.a.info},this.props.note.creatorUser.name),this.props.delete&&l.a.createElement("div",{className:Jt.a.delete,onClick:this.delete.bind(this)},"×")),l.a.createElement("div",{className:Jt.a.content,onClick:this.edit.bind(this)},this.props.note.content))}}])&&Kt(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),r}(l.a.Component),ee=n(317),ne=(lt=n(986),n.n(lt));function re(){return(re=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n,r=arguments[e];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t}).apply(this,arguments)}function oe(t){return l.a.createElement("svg",re({viewBox:"0 0 24 24"},t),ie,ae)}var ie=l.a.createElement("path",{d:"M3 18h12v-2H3v2zM3 6v2h18V6H3zm0 7h18v-2H3v2z"}),ae=l.a.createElement("path",{fill:"none",d:"M0 0h24v24H0V0z"});function se(){return(se=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n,r=arguments[e];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t}).apply(this,arguments)}function le(t){return l.a.createElement("svg",se({viewBox:"0 0 24 24",fill:"currentColor"},t),ce,ue)}var ce=l.a.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),ue=l.a.createElement("path",{d:"M21 6h-2v9H6v2c0 .55.45 1 1 1h11l4 4V7c0-.55-.45-1-1-1zm-4 6V3c0-.55-.45-1-1-1H3c-.55 0-1 .45-1 1v14l4-4h10c.55 0 1-.45 1-1z"}),pe=(lt=(n(1016),n(942)),n.n(lt));function fe(t){return(fe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function de(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function he(t,e){return(he=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function ye(t){return(ye=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var me=function(t){var e=r;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&he(e,t);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=ye(t);n=e?(n=ye(this).constructor,Reflect.construct(r,arguments,n)):r.apply(this,arguments),r=this;if(n&&("object"===fe(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==r)return r;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(r);function r(){if(this instanceof r)return n.call(this);throw new TypeError("Cannot call a class as a function")}return e=r,(t=[{key:"render",value:function(){var t=null!=this.props.addPageBreak,e=null!=this.props.addLineBreak;return l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:ne.a.header},l.a.createElement(ee.a,{noBezel:!0,icon:l.a.createElement(oe,{width:21,height:21,style:{fill:"#1A73E8"}}),backgroundColor:"transparent",accessoryType:this.props.addNote?"ADD":null,onClick:this.props.addNote,disabled:!this.props.addNote,align:"center"}),l.a.createElement(ee.a,{noBezel:!0,icon:l.a.createElement(le,{width:21,height:21,style:{fill:"#F2A41F"}}),accessoryType:this.props.addQuestion?"ADD":null,onClick:this.props.addQuestion,disabled:!this.props.addQuestion,align:"left",backgroundColor:"transparent"}),l.a.createElement(ee.a,{noBezel:!0,color:"#1E8E3E",fontSize:"18px",icon:"¶",accessoryType:e?"ADD":null,onClick:this.props.addLineBreak,disabled:!e,align:"left",backgroundColor:"transparent"}),l.a.createElement(ee.a,{noBezel:!0,icon:l.a.createElement(j,{width:21,height:21,style:{fill:"darkgray"}}),accessoryType:t?"ADD":null,onClick:this.props.addPageBreak,disabled:!t,align:"left",backgroundColor:"transparent"}),l.a.createElement(nt,{format:"annotation.edit"},l.a.createElement("div",{onClick:this.props.editAnnotationHandler,className:ne.a.edit},l.a.createElement(pe.a,null)))))}}])&&de(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),r}(l.a.Component);function ge(t){return(ge="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function be(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ve(t,e){return(ve=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function we(t){return(we=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}lt=function(t){var e=r;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ve(e,t);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=we(t);n=e?(n=we(this).constructor,Reflect.construct(r,arguments,n)):r.apply(this,arguments),r=this;if(n&&("object"===ge(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==r)return r;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(r);function r(t){if(this instanceof r)return(t=n.call(this,t)).controls=null,t.arrow=null,t.arrowDs=null,t;throw new TypeError("Cannot call a class as a function")}return e=r,(t=[{key:"componentDidMount",value:function(){this.updatePosition()}},{key:"componentDidUpdate",value:function(){setTimeout(this.updatePosition.bind(this),0),this.fakeLogin=this.props.fake_login_togle}},{key:"updatePosition",value:function(){var t=this.getMeasurements();if(this.props.inline&&this.controls&&this.arrow&&t){var e=this.controls,n=e.offsetHeight,r=e.offsetWidth,o=this.arrow,i=t.bottomGap,a=i<0||n<i,s=t.top,l=t.viewPortWidth||0,c=t.left,u=c+t.width;if(this.props.selectedElementIds)for(var p=0,f=0,d=0;d<this.props.selectedElementIds.length;d++){var h,y,m=this.props.selectedElementIds[d];(m=document.getElementById(m))&&(y=(h=m.offsetLeft)+m.offsetWidth,h<p?(m.offsetTop,m.offsetHeight,c=h,u=f=y):f<y&&(f=y),h<c&&(c=h),u<y&&(u=y),p=h)}var g=u-c,b=3,v=!1,w=0;(v=!a&&i<n||v)?(o.className=st.a.arrowLeft,b=c-r-o.offsetWidth<0?4:2):(c-(a=r/2-g/2)<0&&(w=Math.abs(c-a)),l<u+a&&(w=l-(u+a))),3===b?(a=l=0,this.arrow&&(this.arrow.className=st.a.arrowTop,a=r/2-this.arrow.offsetWidth/2-w,this.arrow.style.left=(a=a<0?0:a)+"px",l=this.arrow.offsetHeight,this.arrow.style.top=0-l+"px"),e.style.top=s+t.height+l+"px",e.style.left=c+g/2-r/2+w+"px"):v?(o.className=st.a.arrowRight,a=o.offsetHeight,l=t.top+t.height/2-a/2,t.top+t.height+i-l<n&&(l=t.top+t.height+i-n),2===b?(o.style.left=r-2+"px",e.style.left=c-r-o.offsetWidth+"px"):(o.className=st.a.arrowLeft,o.style.left=-o.offsetWidth+"px",e.style.left=c+g+o.offsetWidth+"px"),o.style.top=t.top-l+t.height/2-a/2+"px",e.style.top=l+"px"):e.style.top=s+"px"}}},{key:"getMeasurements",value:function(){if(!this.props.selectedElementIds)return null;var t=this.props.selectedElementIds[this.props.selectedElementIds.length-1],e=(t=document.getElementById(t),this.props.selectedElementIds[0]),n=(e=document.getElementById(e),this.props.splitTextRect),r=0;if(this.props.list&&this.props.list.Grid.state.scrollTop,this.props.pechaImageClass&&(r=document.getElementsByClassName(this.props.pechaImageClass)[0].offsetHeight),!t)return console.warn("no valid element found in getMeasurements, elementId: %s",this.props.selectedElementId),{top:0,textTop:0,rowTop:0,left:0,width:1,height:1,topGap:0,bottomGap:0,viewPortWidth:1};r=t.offsetTop+r;var o=t.offsetTop,i=t.offsetLeft,a=t.offsetWidth,s=t.offsetHeight,l=r,c=null,u=0,p=0;return t&&n&&(t=t.getBoundingClientRect(),p=n.height+n.top-t.bottom,c=n.width),e&&n&&(t=e.getBoundingClientRect(),u=n.height-t.top),{top:r,textTop:o,rowTop:l,left:i,width:a,height:s,topGap:u,bottomGap:p,viewPortWidth:c}}},{key:"render",value:function(){var t,e,n=this,r=this.props,o=[],i=[],a=null,l=null,u=r.user.isLoggedIn,p=!1,f=(r.activeAnnotation&&(r.activeAnnotation.isType(c.a.pageBreak)||r.activeAnnotation.isType(c.a.lineBreak))&&(p=!0),r.annotationsData?(r.annotationsData.map((function(t){var e,a=!1,l=!1;t.isTemporary?l=a=!0:r.temporaryAnnotation||t.annotation.uniqueId!=r.activeAnnotation.uniqueId||(l=!0),a?(e=s.createElement(it,{annotationData:t,key:t.annotation.uniqueId,isActive:l,saveAnnotationHandler:function(e){r.saveAnnotation(t.annotation,e)},cancelAnnotationHandler:function(){r.cancelEditAnnotation(t.annotation)},isLoggedIn:u,selectAnnotationHandler:function(){},editAnnotationHandler:function(){}}),i.push(e)):(e=s.createElement(ot,{isWorkingSection:!1,fontSize:r.fontSize,annotationData:t,key:t.annotation.uniqueId,isActive:l,selectAnnotationHandler:function(){u&&!a&&r.didSelectAnnotation(t.annotation)},editAnnotationHandler:function(){u&&!a&&(n.annotation=t.annotation,r.editAnnotation(t.annotation))},isLoggedIn:u}),o.push(e))}),this),r.user.isLoggedIn||(a=s.createElement("div",{className:st.a.anonymousMessage,style:{position:"relative",background:"#eee",width:"fit-content",border:"1px solid gray",paddingInline:10}},s.createElement(G.a,{id:"annotations.loginMessage",values:{loginLink:s.createElement("a",{href:"/accounts/login/"},s.createElement(G.a,{id:"annotations.loginLink"}))}})))):l=s.createElement("div",{className:st.a.nothingSelected},"Nothing Selected"),null),d=!this.props.selectedWitness.isWorking,h=null,y=!this.props.selectedWitness.isWorking,g=(u&&!this.props.selectedWitness.isWorking&&(t=[],e=[],this.props.availableAnnotations&&(t=this.props.availableAnnotations.filter((function(t){return t.type===c.a.pageBreak&&t.creatorWitness.id===n.props.selectedWitness.id})),e=this.props.availableAnnotations.filter((function(t){return t.type===c.a.lineBreak&&t.creatorWitness.id===n.props.selectedWitness.id}))),0<t.length&&(f=s.createElement("div",{className:st.a.breakButtons},s.createElement(ee.a,{title:"Page Break",accessoryType:"DELETE",icon:s.createElement(j,{width:20,height:20}),onClick:function(){n.props.deleteAnnotation(t[0])},isActive:!0,backgroundColor:tt.a.activeButton})),d=!1),0<e.length&&(h=s.createElement("div",{className:st.a.breakButtons},s.createElement(ee.a,{title:"Line Break",accessoryType:"DELETE",icon:"¶",onClick:function(){n.props.deleteAnnotation(e[0])},isActive:!0,backgroundColor:tt.a.activeButton})),y=!1),(y=!!d&&y)||(d=!1)),null),b={},v=(r.temporaryNotes&&0<r.temporaryNotes.length&&(g=r.temporaryNotes.map((function(t){var e="NOTE_"+t.uniqueId;return t.basedOn&&(b[t.basedOn.uniqueId]=t.uniqueId),s.createElement(Ot,{note:t,key:e,saveNote:r.saveAnnotation,cancel:function(){return r.cancelEditAnnotation(t)}})}))),null),w=(r.notes&&0<r.notes.length&&(v=r.notes.filter((function(t){return!b.hasOwnProperty(t.uniqueId)})).map((function(t){var e="NOTE_"+t.uniqueId;return s.createElement(te,{note:t,key:e,delete:n.props.deleteAnnotation,edit:n.props.editNote})}))),null),O={},S=(r.temporaryQuestions&&0<r.temporaryQuestions.length&&r.questionQuote&&(w=r.temporaryQuestions.map((function(t){O[t.uniqueId]=t.uniqueId;var e="QUESTION_"+t.uniqueId;return s.createElement(Mt,{question:t,questionQuote:r.questionQuote,defaultTitle:r.selectedWitness.text.name,key:e,saveQuestion:r.saveQuestion,cancel:function(){return r.cancelEditAnnotation(t)}})}))),[]),x=!1;if(r.questions&&0<r.questions.length){for(var E=[],A=0;A<r.questions.length;A++){var T=r.questions[A];!O.hasOwnProperty(T.uniqueId)&&r.questionsData.hasOwnProperty(T.uniqueId)&&(r.questionsData[T.uniqueId].loading&&(x=!0),E=E.concat(r.questionsData[T.uniqueId].questions))}S=E.map((function(t){return t.annotationUniqueId,s.createElement(Wt,{question:t,key:"question_"+t.annotationUniqueId})}))}var k=null,I=(0<S.length&&(k=s.createElement("h3",{className:st.a.sectionHeading},"Questions")),null),P=(x&&(I=s.createElement(Gt,null)),0===r.questions.length&&0===r.temporaryQuestions.length),C=[st.a.annotationControls],R=(r.inline&&C.push(st.a.inline),!0);return(a||p)&&(R=!1),s.createElement("div",{className:m.a.apply(void 0,C),ref:function(t){return n.controls=t}},R&&s.createElement(me,{addPageBreak:d?r.addPageBreak:null,addLineBreak:y?r.addLineBreak:null,addNote:u&&!g?function(){return r.addNote()}:null,addQuestion:P?r.addQuestion:null,closeAnnotation:r.closeAnnotation,editAnnotationHandler:function(){var t=document.getElementById("editBtn");null!=t&&t.click()},userLoggedIn:u}),s.createElement("div",{className:st.a.annotationContent},a,l,!p&&i,!p&&o,f,h,g,v,k,w,I,S),s.createElement("div",{className:st.a.arrow,ref:function(t){return n.arrow=t}}))}}])&&be(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),r}(s.Component);var Oe=n(987),Se=n.n(Oe),xe=n(60),Ee=n(340),Ae=n(6),Te=n(2);function je(t,e){var n,r=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)),r}function ke(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?je(Object(n),!0).forEach((function(e){var r,o;r=t,o=n[e=e],e in r?Object.defineProperty(r,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[e]=o})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):je(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Ie(t){return function(t){if(Array.isArray(t))return Re(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||Ce(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Pe(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(t);!(a=(r=n.next()).done)&&(i.push(r.value),!e||i.length!==e);a=!0);}catch(t){s=!0,o=t}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(t,e)||Ce(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ce(t,e){if(t){if("string"==typeof t)return Re(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Re(t,e):void 0}}function Re(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function _e(t,e,n,r){var o=[],i=e.filter((function(t){return t.isWorking||t.isBase})).map((function(t){return t.name}));if(t){for(var a={},s=0;s<t.length;s++)!function(e){var n=t[e];e=n.content+n.start;n.isTemporary?(a[Be]={name:n.getSourceName(),content:n.content,id:n.uniqueId,isTemporary:!0,annotation:n},i=i.filter((function(t){return t!==n.getSourceName()})),e=Be):i=a[e]?(a[e].name+=" "+Object(Ee.a)(n.getSourceName()),i.filter((function(t){return t!==n.getSourceName()}))):(a[e]={name:Object(Ee.a)(n.getSourceName()),content:n.content,id:n.uniqueId,userCreated:n.userCreated,annotation:n},i.filter((function(t){return t!==n.getSourceName()}))),!n.userCreated&&n.creatorWitness.isWorking?a[e].isWorking=!0:a[e].isWorking=!1}(s);i.unshift(n);var l=i;"བྱང་ཆུབ་སེམས་དཔའི་སྤྱོད་པ་ལ་འཇུག་པ་བཞུགས་སོ།"!==(null==r?void 0:r.name)&&(l=i.filter((function(t){return"Dominant"!==t}))),o=Object.keys(a).reduce((function(t,e){return(e=a[e]).isWorking&&(e.name=l.reduce((function(t,e){return t+" "+Object(Ee.a)(e,";")}),"")),t.push(e),t}),[])}return o}var Be=-3,We=Object(r.connect)((function(t,e){var n=Ae.cb(t),r=Ae.E(t),o=e.activeAnnotation,a=e.inline,s=Ae.G(t);if(s||r&&(s=Ae.ib(t,r.id)),!o||!s)return{annotationsData:null,activeAnnotation:null,baseAnnotation:null,availableAnnotations:null,user:n,temporaryAnnotation:null,inline:null,firstSelectedSegment:null,splitTextRect:null,selectedWitness:null};var u=function(t,e,n,r,o){return 0<(t=Ae.O(t,n.id,r,o,e)).length?t[0]:null}(t,c.a.variant,s,o.start,o.length),p=function(t,e,n,r){var o=[];n&&e.naturalId===n.naturalId||o.push(e),n&&o.push(n);var a=(s=Pe(t.getPositionOfAnnotation(e),2))[0],s=s[1];if(a){s=a+s;var l,u=[];e.isInsertion?((l=r["i"+a])&&(u=u.concat(l)),(l=r[String(a)])&&(u=u.concat(l))):((l=r[String(a)])&&(u=l),(a=r[String(s)])&&(u=u.concat(a)));for(var p=0;p<u.length;p++){var f=u[p];f.start===e.start&&f.length===e.length?n&&f.naturalId===n.naturalId||o.push(f):t.activeWitness.isWorking||f.type!==c.a.pageBreak&&f.type!==c.a.lineBreak||o.push(f)}o=i()(o,(function(t,e){return t.id===e.id}))}return o}(e.annotatedText,o,u,e.annotationPositions),f=_e(f=p.filter((function(t){return t.type===c.a.variant})),y=Ae.K(t),E=Ae.bb(t,"annotation.workingEdition","Working"),r),d=(r=null,o.id==h.a?r=o:(A=(d=Pe(e.annotatedText.getPositionOfAnnotation(o),2))[0],d=d[1],f=null===A||null===d?null:(A=_e([r=e.annotatedText.getBaseAnnotation(A,d)],y,E),[].concat(Ie(A),Ie(f)))),f&&f.sort((function(t,e){return t.isTemporary?-1:e.isTemporary?1:t.userCreated?-1:!e.userCreated&&t.annotation.id&&e.annotation.id?t.annotation.id-e.annotation.id:1})),p.filter((function(t){return t.type===c.a.note}))),y=Ae.O(t,s.id,o.start,o.length,c.a.note),m=p.filter((function(t){return t.type===c.a.question})),g={};if(0<m.length)for(var b=0;b<m.length;b++){var v=m[b],w=(g[v.uniqueId]={},Ae.sb(t,v));w=(g[v.uniqueId].loading=w,Ae.u(t,v.uniqueId));g[v.uniqueId].questions=w}var O,S,x,E,A=null,T=(0<(E=Ae.O(t,s.id,o.start,o.length,c.a.question)).length&&(T=E[0],S=(T=Pe(e.annotatedText.getPositionOfAnnotation(T),2))[0],T=T[1],S&&(T=(S=Pe(e.annotatedText.segmentedText.extractTextAroundPosition(S,T=T||S+1,["།"," "]),3))[0],O=S[1],S=S[2],x=document.location.href,A=l.a.createElement("blockquote",null,T,l.a.createElement("a",{href:x},O),S))),Object(Ae.T)(t));return{annotationsData:f,activeAnnotation:o,baseAnnotation:r,availableAnnotations:p,user:n,temporaryAnnotation:u,inline:a,firstSelectedSegment:e.firstSelectedSegment,splitTextRect:e.splitTextRect,selectedWitness:s,notes:d,temporaryNotes:y,questions:m,temporaryQuestions:E,questionsData:g,questionQuote:A,fontSize:T}}),null,(function(t,e,n){var r=e.dispatch;if(0<t.questions.length)for(var o=0;o<t.questions.length;o++){var i=t.questions[o],a=!0;(a=(!t.questionsData.hasOwnProperty(i.uniqueId)||!(0<t.questionsData[i.uniqueId].questions.length||t.questionsData[i.uniqueId].loading))&&a)&&r(new Te.ec(i))}function s(e){var o=1<arguments.length&&void 0!==arguments[1]&&arguments[1];return function(){var i=n.activeAnnotation,a=(i=new c.c(null,i.witness,i.end+1,0,null,e,t.selectedWitness,t.user),Ae.d(t.selectedWitness)),s=[];s.push(Te.Xb(i)),s.push(Te.Db(i.uniqueId,a)),o?s.push(Te.Qb(i)):s.push(Te.Qb(null)),r(Object(xe.batchActions)(s))}}function l(e,n){var o,i,a;e.isTemporary?(o=t.selectedWitness,o=Ae.d(o),(n=new c.c(e.id,e.witness,e.start,e.length,n,e.type,e.creatorWitness,t.user,e.uniqueId,e.basedOn)).isSaved=e.isSaved,i=[],a=null,a=n.isSaved?Te.Qc:Te.Xb,i.push(a(n)),i.push(Te.Ac(e)),i.push(Te.Db(n.uniqueId,o)),n.type===c.a.variant&&i.push(Te.Qb(n)),r(Object(xe.batchActions)(i))):console.warn("Tried to save a non-temporary annotation: %o",e)}return ke(ke(ke({},t),n),{},{closeAnnotation:function(){var e;t.activeAnnotation&&(e=Te.Qb(null),r(e))},didSelectAnnotation:function(e){var n=e.id==h.a?t.baseAnnotation:Se()(t.availableAnnotations,(function(t){return t.uniqueId==e.uniqueId}))||null,o=[],i=t.selectedWitness,a=Ae.d(i);e.uniqueId!=t.activeAnnotation.uniqueId&&(i.isWorking?(e.id!=h.a&&o.push(Te.Db(n.uniqueId,a)),t.activeAnnotation.id!=h.a&&o.push(Te.yc(t.activeAnnotation.uniqueId,a))):t.activeAnnotation.creatorWitness.id===i.id?(o.push(Te.zc(t.activeAnnotation.uniqueId,a)),n.id!==h.a&&o.push(Te.Db(n.uniqueId,a))):(n.creatorWitness.id===i.id?o.push(Te.Eb(n.uniqueId,a)):n.id!==h.a&&o.push(Te.Db(n.uniqueId,a)),t.activeAnnotation.id!==h.a&&o.push(Te.yc(t.activeAnnotation.uniqueId,a))),o.push(Te.Qb(n)),r(Object(xe.batchActions)(o)))},editAnnotation:function(e){var n=e.isWorkingAnnotation||e.userCreated||e.id===h.a?null:e;n=new c.b(n,e.witness,e.start,e.length,e.content,e.type,t.selectedWitness,t.user);e.userCreated&&(n.uniqueId=e.uniqueId,n.isSaved=e.isSaved),r(Te.Cb(n,!0))},saveAnnotation:l,cancelEditAnnotation:function(t){var e;t.isTemporary?(e=Te.Ac(t),r(e)):console.warn("Tried to call cancelEditAnnotation on a non-temporary annotation: %o",t)},deleteAnnotation:function(e){var n=t.selectedWitness,o=Ae.d(n),i=[];i=e.userCreated?[Te.Zb(e,n),Te.yc(e.uniqueId,o)]:[Te.zc(e.uniqueId,o)],t.activeAnnotation.uniqueId===e.uniqueId&&i.push(Te.Qb(null)),r(Object(xe.batchActions)(i))},addNote:function(){var e=n.activeAnnotation;e=new c.b(null,e.witness,e.start,e.length,"",c.a.note,t.selectedWitness,t.user);r(Te.Cb(e,!0))},editNote:function(e){e=new c.b(e,e.witness,e.start,e.length,e.content,c.a.note,t.selectedWitness,t.user),r(Te.Cb(e,!0))},addPageBreak:s(c.a.pageBreak),addLineBreak:s(c.a.lineBreak),addQuestion:function(){var e=n.activeAnnotation;e=new c.b(null,e.witness,e.start,e.length,"",c.a.question,t.selectedWitness,t.user);r(Te.Cb(e,!0))},saveQuestion:function(e,o,i){var a=((a=Pe(n.annotatedText.getPositionOfAnnotation(e),2))[0],a[1],A.a.renderToStaticMarkup(t.questionQuote)+i);l(e,i),i=Te.Yb(e,o,a);r(i)}})}))(lt),Ne=(Oe=n(993),n.n(Oe)),De=(lt=n(347),n.n(lt));function Le(t){return(Le="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function qe(t,e){var n,r=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)),r}function He(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?qe(Object(n),!0).forEach((function(e){Me(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):qe(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Me(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ze(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(t);!(a=(r=n.next()).done)&&(i.push(r.value),!e||i.length!==e);a=!0);}catch(t){s=!0,o=t}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(t,e)||function(t,e){if(t){if("string"==typeof t)return Ve(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ve(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ve(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Qe(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ue(t,e){return(Ue=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Fe(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function $e(t){return($e=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}parseInt(st.a.inlineWidth);var Ge="bdrcimg_pre",Je={},Ye=function(t){var e=r;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ue(e,t);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=$e(t);n=e?(n=$e(this).constructor,Reflect.construct(r,arguments,n)):r.apply(this,arguments),r=this;if(n&&("object"===Le(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return Fe(r)}}(r);function r(t){var e;if(this instanceof r)return(e=n.call(this,t)).textAlignmentById=[],e.childRef=s.createRef("0"),e.list=null,e.splitText=null,e.cache=new S.b({fixedWidth:!0,defaultHeight:300}),e.splitTextRef=s.createRef(null),e.rowRenderer=e.rowRenderer.bind(Fe(e)),e.textListVisible=t.textListVisible,e.editMenuVisible=t.editMenuVisible,e.isPanelLinked=t.isPanelLinked,e.activeSelection=null,e.selectedNodes=null,e._mouseDown=!1,e._activeWitness=null,e._didSetInitialScrollPosition=!1,e._modifyingSelection=!1,e.imageHeight=null,e.imageWidth=null,e.calculatedImageHeight=null,e.processProps(t),e.changeSyncIdOnScroll=t.changeSyncIdOnScroll,e.changeSyncIdOnClick=t.changeSyncIdOnClick,e.closeAnnotation=t.closeAnnotation,e.scrollJump=t.scrollJump,e.textAlignmentById=[],e.scrollEvent=e.scrollEvent.bind(Fe(e)),e.selectedWindow=t.selectedWindow,e.fake_login_toggle=De.a.hasFeature("fake_login_toggle"),e;throw new TypeError("Cannot call a class as a function")}return e=r,(t=[{key:"scrollEvent",value:function(t){if(2===this.selectedWindow)return null;var e;1===this.selectedWindow&&this.isPanelLinked&&(e=[],this.textAlignmentById.map((function(t){var n=document.getElementById("s_"+t.start);n&&102<n.getBoundingClientRect().top&&e.push({id:t.id,start:t.start,target:t.TStart})})),v()(e)||1===this.selectedWindow&&this.debouncedSearch(e))}},{key:"updateId",value:function(t){var e=this.textAlignmentById.find((function(t){return segment.start>=t.start&&segment.start<t.end}));console.log(e)}},{key:"updateList",value:function(){var t=!(0<arguments.length&&void 0!==arguments[0])||arguments[0],e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;if(!this.props.showImages&&!this.calculatedImageHeight&&this.imageHeight&&this.imageWidth&&(this.calculatedImageHeight=this.calculateImageHeight()),this.list){var n=this.list;if(t)if(null!==e)if(Array.isArray(e)){if(Array.isArray(e))for(var r=0;r<e.length;r++){var o=e[r];this.cache.clear(o)}}else this.cache.clear(e);else this.cache.clearAll(),n.measureAllRows(),n.recomputeRowHeights(0);n.forceUpdateGrid()}}},{key:"mouseDown",value:function(){this._mouseDown=!0}},{key:"mouseUp",value:function(){var t;this._mouseDown=!1,this.activeSelection&&(t=(t=this.processSelection(this.activeSelection))||[],this.props.didSelectSegmentIds(t),this.activeSelection=null)}},{key:"handleSelection",value:function(t){this._modifyingSelection?(t.stopPropagation(),this._modifyingSelection=!1):(this.activeSelection=document.getSelection(),this._mouseDown||this.mouseUp())}},{key:"processSelection",value:function(t){if(0===t.rangeCount||t.isCollapsed||"Caret"===t.type)return this.selectedNodes=null;var e=(t=t.getRangeAt(0)).startContainer;if(!(e=this.getNodeSegmentSpan(e))||!e.parentNode)return null;var n=this.getRangeNodes(t,e.parentNode),r=(0<n.length&&(r=n[0],t.startOffset===r.textContent.length&&n.shift()),t.endContainer);return(r=this.getNodeSegmentSpan(r))&&r.parentNode?(r&&e.parentNode!==r.parentNode?n=n.concat(this.getRangeNodes(t,r.parentNode)):0===t.endOffset&&n.pop(),e=[],(this.selectedNodes=n).reduce((function(t,e){return e instanceof Element&&t.push(e.id),t}),e),e):null}},{key:"getNodeSegmentSpan",value:function(t){for(var e=t,n=null,r=/^(i|s|ds)_/;!n&&e.parentNode;)e instanceof Element&&r.test(e.id)&&(n=e),e=e.parentNode;return n}},{key:"getRangeNodes",value:function(t,e){for(var n=[],r=0,o=e.childNodes.length;r<o;r++){var i=e.childNodes[r];t.intersectsNode(i)&&n.push(i)}return n}},{key:"getControlsMeasurements",value:function(t){if(!this.splitText)return null;var e=this.splitText,n=null,r=null,o=null,i=null,a=null,s=[],l=0;if(t.activeAnnotation){var u=t.activeAnnotation;if(null===(l=ze(t.splitText.annotatedText.getPositionOfAnnotation(u),1)[0]))return console.warn("No startPos in getControlsMeasurements"),null;u.type===c.a.pageBreak&&--l,u.type===c.a.lineBreak&&--l;var p=l+u.length;0<u.length&&--p,n=t.splitText.getTextIndexOfPosition(p),i=e.getBoundingClientRect()}var f=[];if(t.selectedAnnotatedSegments&&0<t.selectedAnnotatedSegments.length){f=t.selectedAnnotatedSegments;for(var h=0;h<f.length;h++){var y=f[h];if(null===r&&y instanceof d.a){r=y;break}}r&&(a=0===r.length&&t.activeAnnotation&&t.activeAnnotation.isInsertion?(o=M(r),M):(o=q(r),q))}else t.activeAnnotation&&(t.activeAnnotation.isDeletion?(o=H(u=new d.a(l,"")),a=H,f=[r=u]):t.activeAnnotation.isInsertion?(p=ze(t.splitText.annotatedText.getPositionOfAnnotation(t.activeAnnotation),1)[0])&&(o=M(e=new d.a(p,"")),a=M,f=[r=e]):t.activeAnnotation.type===c.a.pageBreak?(f=[r=new d.a(l+1,"")],s=[o=z(new d.a(l,""))]):t.activeAnnotation.type===c.a.lineBreak&&(f=[r=new d.a(l+1,"")],s=[o=V(new d.a(l,""))]));if(a)for(var m=0;m<f.length;m++){var g=f[m];g instanceof d.a&&(g=a(g),s.push(g))}return null!=n&&r&&o&&i?{selectedTextIndex:n,firstSelectedSegment:r,selectedElementId:o,splitTextRect:i,selectedElementIds:s}:null}},{key:"shouldResetListCache",value:function(t,e){var n=!1;return!(t.showImages===e.showImages&&!this.pageBreaksChanged(t,e))||n}},{key:"pageBreaksChanged",value:function(t,e){return t=t.splitText.getTextsFinalPositions(),e=e.splitText.getTextsFinalPositions(),t.length!==e.length||JSON.stringify(t)!==JSON.stringify(e)}},{key:"lineBreaksChanges",value:function(t,e){var n=t.activeAnnotation,r=e.activeAnnotation,o=!1;return n&&n.isType(c.a.lineBreak)&&e.activeAnnotations&&!e.activeAnnotations.hasOwnProperty(n.uniqueId)&&(o=!0),!(!(r&&r.isType(c.a.lineBreak)&&t.activeAnnotations)||t.activeAnnotations.hasOwnProperty(r.uniqueId))||o}},{key:"selectedListRow",value:function(t){var e=null;return t.activeAnnotation?t.splitText.getTextIndexOfPosition(t.activeAnnotation.start):e}},{key:"processProps",value:function(t){var e=this,n=!1;if((o=((!this.props.selectedWitness||t.selectedWitness&&t.selectedWitness.id!==this.props.selectedWitness.id)&&(this._didSetInitialScrollPosition=!(n=!0)),!t.selectedSearchResult||this.props.selectedSearchResult&&t.selectedSearchResult.start===this.props.selectedSearchResult.start&&t.selectedSearchResult.textId===this.props.selectedSearchResult.textId||(console.log("resetting scroll position from search result"),this._didSetInitialScrollPosition=!1),this._filteredSelectedAnnotatedSegments=t.selectedAnnotatedSegments.reduce((function(t,e){return e instanceof d.a&&t.push(e),t}),[]),this.getControlsMeasurements(t)))&&(this.selectedTextIndex=o.selectedTextIndex,this.firstSelectedSegment=o.firstSelectedSegment,this.splitTextRect=o.splitTextRect,this.selectedElementId=o.selectedElementId,this.selectedElementIds=o.selectedElementIds),t.textListVisible!==this.textListVisible||t.editMenuVisible!==this.editMenuVisible)setTimeout((function(){e.textListVisible=t.textListVisible,e.editMenuVisible=t.editMenuVisible,e.updateList(!0)}),500);else if(n)this.updateList(!0);else if(this.pageBreaksChanged(this.props,t)){var r=null,o=this.selectedListRow(this.props);n=this.selectedListRow(t);if(o&&n){r=[];for(var i=n<o?n:o,a=this.props.splitText.texts.length;i<a;i++)r.push(i)}this.updateList(!0,r)}else if(this.lineBreaksChanges(this.props,t)){n=(n=this.selectedListRow(t))||this.selectedListRow(this.props),o=this.props.splitText.texts;var s=[];if(null!==n){for(var l=n,c=o.length;l<c;l++)s.push(l);this.updateList(!0,s)}}else this.props.fontSize!==t.fontSize?this.updateList(!0):this.props.activeAnnotation&&t.activeAnnotation&&this.annotationsInSameLocation(this.props.activeAnnotation,t.activeAnnotation)?this.updateList(!0,this.selectedListRow(t)):this.updateList(this.shouldResetListCache(this.props,t))}},{key:"annotationsInSameLocation",value:function(t,e){return t.start===e.start&&t.length===e.length}},{key:"UNSAFE_componentWillReceiveProps",value:function(t){this.processProps(t)}},{key:"componentDidMount",value:function(){var t=this;this.list,this.resizeHandler=b()((function(){t.calculatedImageHeight=null,t.updateList()}),500).bind(this),this.debouncedSearch=g()((function(e){t.changeSyncIdOnScroll(e[0].target)}),1e3),window.addEventListener("resize",this.resizeHandler),this.selectionHandler=g()((function(e){t.handleSelection(e)}),200).bind(this),document.addEventListener("selectionchange",this.selectionHandler),document.addEventListener("mousedown",this.mouseDown.bind(this),!0),document.addEventListener("mouseup",this.mouseUp.bind(this),!0),this.processProps(this.props),this.componentDidUpdate()}},{key:"componentDidUpdate",value:function(){var t,e,n,r,o=this;this.textAlignmentById=this.props.textAlignmentById,this.isPanelLinked=this.props.isPanelLinked,this.selectedWindow=this.props.selectedWindow,this.targetId=this.props.syncIdOnScroll2,this.list,this.fake_login_toggle=!0,this.selectedNodes&&0<this.selectedNodes.length&&(t=this.selectedNodes,e=this.props.selectedAnnotatedSegments,setTimeout((function(){var n=document.createRange(),r=t[0],i=t[t.length-1],a=e[e.length-1];a instanceof d.a&&(a=document.getElementById(q(a)))&&(i=a),r instanceof Element&&i instanceof Element&&(r=document.getElementById(r.id),i=document.getElementById(i.id),r&&i&&(n.setStart(r,0),n.setEnd(i,i.childNodes.length),(a=document.getSelection())&&(o._modifyingSelection=!0,a.removeAllRanges(),a.addRange(n),o.selectedNodes=null)))}),0)),!this._didSetInitialScrollPosition&&this.list&&(n=this.list,(this.props.activeAnnotation||this.props.selectedSearchResult)&&(r=this.getSelectedTextIndex(),setTimeout((function(){n.scrollToRow(r),setTimeout((function(){n.scrollToPosition(n.props.scrollTop-300)}),0)}),100)),this._didSetInitialScrollPosition=!0)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mousedown",this),document.removeEventListener("mouseup",this),window.removeEventListener("resize",this.resizeHandler),document.removeEventListener("selectionchange",this.selectionHandler)}},{key:"calculateImageHeight",value:function(){var t,e,n=null;return this.imageHeight&&this.imageWidth&&(t=this.imageWidth/this.imageHeight,e=Ne.a.pechaImage,0<(e=document.getElementsByClassName(e)).length&&(n=e[0].offsetWidth/t)),n}},{key:"getSelectedTextIndex",value:function(){var t,e=0,n=null;return this.props.activeAnnotation?n=ze(this.props.splitText.annotatedText.getPositionOfAnnotation(this.props.activeAnnotation),1)[0]:this.props.selectedSearchResult&&((t=this.props.splitText.annotatedText.segmentAtOriginalPosition(this.props.selectedSearchResult.start))instanceof d.a?n=t.start:"number"==typeof t&&(n=t)),n?this.props.splitText.getTextIndexOfPosition(n):e}},{key:"getBaseAnnotation",value:function(t){var e=ze(this.props.splitText.annotatedText.getPositionOfAnnotation(t),1)[0];return this.props.splitText.annotatedText.getBaseAnnotation(e=null===e?0:e,t.content.length)}},{key:"render",value:function(){var t=this,e=this.props,n=this.rowRenderer,r=this.cache,o=e.selectedWitness?e.selectedWitness.id:0;return s.createElement("div",{className:Ne.a.splitText,ref:function(e){return t.splitText=e},key:o},s.createElement("button",{id:"updateList",style:{display:"none"},onClick:function(){return t.updateList(!0)}}),s.createElement(w.a,null,(function(o){var i=o.height;o=o.width;return s.createElement(O.a,{ref:function(e){return t.list=e},height:i,rowCount:e.splitText.texts.length,rowHeight:r.rowHeight,rowRenderer:n,width:o,overscanRowCount:1,deferredMeasurementCache:r,onScroll:t.scrollEvent,scrollToAlignment:"center"})})))}},{key:"getImageUrl",value:function(t){if(!this.props.selectedWitness||!this.props.selectedWitness.properties)return"";var e=(r=this.props.selectedWitness.properties)[Ge],n=r.bdrcimg_number,r=r.bdrcimg_suffix;return"//iiif.bdrc.io/"+e+(Number(n)+t)+"."+r+"/full/full/0/default.jpg"}},{key:"getStringPositions",value:function(t,e,n){var r=this.props.splitText.annotatedText.getUniqueId();if((Je=Je.hasOwnProperty(r)?Je:Me({},r,{}))[r].hasOwnProperty(e)||(Je[r]=Me({},e,{})),Je[r][e].hasOwnProperty(n))return Je[r][e][n];for(var o=new E.a,i=t.getText(),a=null==(t=t.segments[0])?void 0:t.start,s=[],l=i.indexOf(e);-1!==l;)s.push(l),l=i.indexOf(e,l+1);var c={};if(0<s.length)for(var u=o.splitGraphemes(i),p=0,f=null,d=0;d<u.length;d++){var h=u[d],y=p+(h.length-1);null!==f?f+(e.length-1)<=y&&(c[f+a]=[f+a,y+a],f=null):-1!==s.indexOf(p)?e.length===h.length?c[p+a]=[p+a,y+a]:e.length>h.length&&(f=p):f=null,p+=h.length}return Je[r][e][n]=c}},{key:"rowRenderer",value:function(t){var e=t.key,n=t.index,r=t.parent,o=(t=t.style,this.props),i=this.cache,a=o.showImages?Ne.a.pechaImage:null,l=(o.selectedWitness&&o.selectedWitness.properties&&o.selectedWitness.properties.hasOwnProperty(Ge)&&this.getImageUrl(n),{}),c=this.props.searchValue;c&&0<c.length&&o.splitText&&(l=this.getStringPositions(o.splitText.texts[n],c,n)),o.showImages&&a&&this.calculatedImageHeight&&this.calculatedImageHeight,t=He(He({},t),{},{height:t.height+10});return s.createElement(S.a,{columnIndex:0,key:e,parent:r,rowIndex:n,cache:i},s.createElement("div",{key:e,style:t,className:Ne.a.splitTextRow,ref:this.splitTextRef,id:"index_".concat(n)},s.createElement("div",{className:Ne.a.splitTextRowContent},s.createElement(F,{ref:this.childRef,segmentedText:o.splitText.texts[n],annotations:o.annotations,activeAnnotations:o.activeAnnotations,activeAnnotation:o.activeAnnotation,row:n,selectedSegmentId:o.selectedSegmentId,annotationPositions:o.annotationPositions,selectedAnnotatedSegments:this._filteredSelectedAnnotatedSegments,getBaseAnnotation:this.getBaseAnnotation.bind(this),activeWitness:this.props.selectedWitness,searchValue:c,selectedSearchResult:this.props.selectedSearchResult,searchStringPositions:l,fontSize:o.fontSize,changeSyncIdOnClick:this.props.changeSyncIdOnClick,changeSyncIdOnScroll:this.props.changeSyncIdOnScroll,isPanelLinked:this.props.isPanelLinked,isAnnotating:this.props.isAnnotating,textAlignmentById:this.props.textAlignmentById,selectedSourceRange:this.props.selectedSourceRange,selectedTargetRange:this.props.selectedTargetRange,changeSelectedRange:this.props.changeSelectedRange})),this.props.isAnnotating&&this.selectedTextIndex===n&&this.props.activeAnnotation&&s.createElement(We,{annotationPositions:o.annotationPositions,annotatedText:o.splitText.annotatedText,activeAnnotation:o.activeAnnotation,inline:!0,firstSelectedSegment:this.firstSelectedSegment,splitTextRect:this.splitTextRect,selectedElementId:this.selectedElementId,pechaImageClass:a,splitText:o.splitText,selectedElementIds:this.selectedElementIds,list:this.list,fake_login_toggle:this.fake_login_toggle})))}}])&&Qe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),r}(s.PureComponent),Ke=n(316);function Xe(t){return function(t){if(Array.isArray(t))return Ze(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return Ze(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ze(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ze(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}n(134);Oe=n(994);var tn=n.n(Oe),en=(lt=n(197),n.n(lt)),nn=(Oe=n(995),n.n(Oe)),rn=(lt=n(996),n.n(lt)),on=n(911),an=(Oe=n(1039),n(314));function sn(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var ln=Object(s.memo)(Object(y.c)(Object(Oe.a)((function(t){return{root:{minWidth:60,padding:0,textAlign:"center",fontWeight:"bold"},selectEmpty:{paddingLeft:"6px",backgroundColor:"transparent"},select:{color:"black","&:not([multiple]) option":{backgroundColor:"#eee"}}}}))((function(t){var e,n="",r=t.witnesses.findIndex((function(e){return e.id===t.activeWitness.id})),o=t.classes,i=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(t);!(a=(r=n.next()).done)&&(i.push(r.value),!e||i.length!==e);a=!0);}catch(t){s=!0,o=t}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(t,e)||function(t,e){if(t){if("string"==typeof t)return sn(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?sn(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(Object(an.a)("selectedWitness",0),2),a=i[0],c=i[1],u=[rn.a.selectOptions];return t.witnesses&&(e=t.witnesses.map((function(t){return t})),u=[rn.a.tab],e.sort((function(t,e){return t.isWorking?-1:e.isWorking?1:t.isBase?-1:e.isBase?1:0})),e=e.sort((function(t,e){return t.id-e.id}))),Object(s.useEffect)((function(){0<t.witnesses.length&&t.onSelectedWitness(e[a])}),[a]),l.a.createElement(on.a,{onChange:function(t){return c(t.target.value)},className:rn.a.selectVersion,value:r,label:"Version",classes:{root:o.selectEmpty,select:o.select},style:{border:0}},e.map((function(e,r){return e.id===t.activeWitness.id&&u.push(rn.a.selected),n=e.source.name,e.isWorking&&(n="en"===t.intl.locale?"User"===(null==(e=t.user)?void 0:e.name)?"Working":"My Edition":"མཉམ་འབྲེལ་པར་མ།"),l.a.createElement("option",{key:"versionSelect-".concat(r),value:r,className:u,styles:{textAlign:"center"}},n)})))})))),cn=n(932),un=(lt=n(1005),n.n(lt)),pn=n(1036),fn=n(916),dn=n(253),hn=n(1040);function yn(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(t);!(a=(r=n.next()).done)&&(i.push(r.value),!e||i.length!==e);a=!0);}catch(t){s=!0,o=t}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(t,e)||function(t,e){if(t){if("string"==typeof t)return mn(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?mn(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function mn(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}n(11);var gn=Object(r.connect)((function(t){var e=Ae.y(t),n=Ae.w(t,e),r=Ae.B(t),o=!1,i=Ae.ab(t);return{texts:i=0<e.length?null===n?(o=!0,[]):i.filter((function(t){return n.hasOwnProperty(t.id)})):i,selectedText:Object(Ae.E)(t),searchTerm:e,searchResults:n,selectedSearchResult:r,searching:o}}),(function(t){return{onSelectedText:function(e){t(Te.Hc(e))}}}))((function(t){var e=Object(s.useRef)(t.texts),n=(i=yn(Object(s.useState)(e.current),2))[0],r=i[1],o=t.onSelectedText,i=t.selectedText,a=(t=yn(Object(s.useState)(!1),2))[0],c=t[1],u=(t=(i||n[0]).name,Object(s.useRef)(new cn.c({fixedHeight:!0,defaultHeight:30,defaultWidth:400}))),p=[un.a.textlist];return l.a.createElement(pn.a,{onClickAway:function(){return c(!1)}},l.a.createElement("div",{style:{position:"relative"}},l.a.createElement(fn.a,{onClick:function(){c((function(t){return!t})),!1===a&&p.push(un.a.open)},className:un.a.listToggelBtn,component:"div",sx:{overflow:"hidden",textOverflow:"ellipsis",width:"5rem"}},l.a.createElement(dn.a,{noWrap:!0},t)),a&&l.a.createElement("div",{className:m()(p),style:{position:"absolute"}},l.a.createElement(hn.a,{onChange:function(t){var o=t.target.value;r(e.current),""!==o&&null!==o&&(t=n.filter((function(t){return t.name.includes(o)})),r(t))},id:"standard-basic",label:"filter",variant:"standard",style:{width:"100%"}}),l.a.createElement(cn.a,null,(function(t){var e=t.width;t=t.height;return l.a.createElement(cn.d,{width:e,height:t,rowHeight:u.current.rowHeight,deferredMeasurementCache:u.current,rowCount:n.length,rowRenderer:function(t){var e=t.key,r=t.index,i=t.style,a=(t=t.parent,n[r]);return l.a.createElement(cn.b,{key:"optionvalues-".concat(e),cache:u.current,parent:t,columnIndex:0,rowIndex:r},l.a.createElement("div",{style:i,onClick:function(){c(!1),o(a)}},l.a.createElement("span",{style:{paddingLeft:"10px"}},a.name)))}})})))))})),bn=n(906),vn=n(1046),wn=n(904),On=n(1047),Sn=n(921),xn=(y=n(1006),n.n(y)),En=n(913),An=n(1043),Tn=n(1042),jn=n(907),kn=(Oe=n(1007),n.n(Oe));function In(){return(In=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n,r=arguments[e];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t}).apply(this,arguments)}function Pn(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(t);!(a=(r=n.next()).done)&&(i.push(r.value),!e||i.length!==e);a=!0);}catch(t){s=!0,o=t}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(t,e)||function(t,e){if(t){if("string"==typeof t)return Cn(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Cn(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Cn(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Rn(t){function e(t,e){"clickaway"!==e&&a(!1)}var n=Pn(Object(s.useState)(!1),2),r=n[0],o=n[1],i=(n=Pn(Object(s.useState)(!1),2))[0],a=n[1];return l.a.createElement(l.a.Fragment,null,l.a.createElement(pn.a,{onClickAway:function(){return o(!1)}},l.a.createElement(Sn.a,{size:"small",variant:"text",style:{padding:0,color:"black"},onClick:function(){return o((function(t){return!t}))}},l.a.createElement(En.a,{title:"Share"},l.a.createElement(xn.a,null)),l.a.createElement(_n,In({},t,{showShare:r,setOpen:a})))),l.a.createElement(An.a,{open:i,autoHideDuration:6e3,onClose:e},l.a.createElement(Tn.a,{onClose:e,severity:"success",sx:{width:"100%"}},"The Url Copied to Clipboard !")))}function _n(t){var e=(r=Pn(Object(s.useState)(!1),2))[0],n=r[1],r=t.selectedText,o=t.selectedText2,i=t.selectedWitness,a=t.selectedWitness2,c=o&&a?window.location.origin+"/texts/".concat(r.id,"/witnesses/").concat(null==i?void 0:i.id,"/texts2/").concat(o.id,"/witnesses2/").concat(a.id):window.location.origin+"/texts/".concat(r.id,"/witnesses/").concat(null==i?void 0:i.id);return l.a.createElement(jn.a,{in:t.showShare},l.a.createElement("div",{style:{position:"absolute",top:30,background:"white",width:240,right:10,boxShadow:"1px 1px 2px black",zIndex:9999,padding:10,borderRadius:10}},l.a.createElement("div",{style:{textAlign:"center",marginBottom:10}},t.selectedText.name),l.a.createElement("div",{style:{textAlign:"center",display:"flex",gap:10}},l.a.createElement("input",{type:"text",defaultValue:c,disabled:e}),l.a.createElement("div",{onClick:function(){navigator.clipboard.writeText(c).then((function(){n(!0),setTimeout((function(){n(!1)}),3e3)})).catch((function(t){return console.log(t.message)})).finally((function(){return t.setOpen(!0)}))},style:{color:e&&"green"}},l.a.createElement(kn.a,null)))))}lt=n(1045),y=n(9),Oe=n(438);var Bn=n(918),Wn=Object(y.a)(lt.a)((function(t){return{"&.Mui-selected, &.Mui-selected:hover":{color:"white",backgroundColor:t.selectedcolor}}})),Nn=Object(Oe.a)({palette:{text:{primary:"#00398e"}}});function Dn(t){return l.a.createElement(Bn.a,{theme:Nn},l.a.createElement(Wn,{value:"Annotate",selected:t.isAnnotating,style:{padding:0,marginRight:10},selectedcolor:"#053982",onClick:function(){return t.changeIsAnnotating(!t.isAnnotating)}},l.a.createElement(En.a,{title:"Annotate"},l.a.createElement(pe.a,null))))}var Ln=n(1008),qn=n.n(Ln);function Hn(t){t=t.isSecondWindowOpen;var e=Object(s.useCallback)((function(){var t=document.getElementById("updateList"),e=document.getElementById("updateList2");t&&t.click(),e&&e.click()}),[t]);return Object(s.useEffect)((function(){var t=setTimeout((function(){e()}),500);return function(){return clearTimeout(t)}}),[t]),l.a.createElement(Sn.a,{variant:"text",size:"small",style:{padding:0,color:"black"},onClick:e},l.a.createElement(qn.a,null))}Ln=n(945);var Mn=n.n(Ln);function zn(t){return t=t.handleWindowSearch,l.a.createElement(Sn.a,{size:"small",variant:"text",onClick:t,style:{padding:0,color:"black"}},l.a.createElement(Mn.a,null))}Ln=n(1009);var Vn=n.n(Ln),Qn=Object(y.a)(lt.a)((function(t){return{"&.Mui-selected, &.Mui-selected:hover":{color:"white",backgroundColor:t.selectedcolor}}})),Un=Object(Oe.a)({palette:{text:{primary:"#00398e"}}});function Fn(t){var e=t.isSecondWindowOpen,n=t.onChangeWindowOpen;return l.a.createElement(Bn.a,{theme:Un},l.a.createElement(Qn,{value:"secondWindow",selected:e,onClick:function(){n(!e,139)},style:{padding:0},selectedcolor:"#053982"},l.a.createElement(En.a,{title:"split panel"},l.a.createElement(Vn.a,null))))}Ln=n(312);var $n=n.n(Ln),Gn=n(929),Jn=(y=n(946),n.n(y)),Yn=n(903),Kn=n(922),Xn=n(920);function Zn(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function tr(t){var e=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(t);!(a=(r=n.next()).done)&&(i.push(r.value),!e||i.length!==e);a=!0);}catch(t){s=!0,o=t}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(t,e)||function(t,e){if(t){if("string"==typeof t)return Zn(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Zn(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(Object(s.useState)(!1),2),n=e[0],r=e[1];return l.a.createElement(pn.a,{onClickAway:function(){return r(!1)}},l.a.createElement(Sn.a,{onClick:function(){r((function(t){return!t}))},size:"small",variant:"text",style:{padding:0,color:"black"}},l.a.createElement($n.a,null),l.a.createElement(Yn.a,{in:n},l.a.createElement(Kn.a,{dense:!0,style:{position:"absolute",right:0,zIndex:2,top:30,backgroundColor:"#eee"}},l.a.createElement(Gn.a,{max:20,min:14,initialvalue:t.textFontSize,changeSize:t.onChangedFontSize}),l.a.createElement(Xn.a,{onClick:function(){return t.onExport()}},"Export Document",t.exportingWitness&&l.a.createElement(Jn.a,null)),l.a.createElement(Xn.a,{onClick:function(){return t.onChangePanelLink(!t.isPanelLinked)}},t.isPanelLinked&&l.a.createElement(Jn.a,null),"link panels")))))}var er=n(915),nr=n(923),rr=n(1044),or=n(909),ir=n(910),ar=(lt=n(947),n.n(lt));function sr(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function lr(){var t=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(t);!(a=(r=n.next()).done)&&(i.push(r.value),!e||i.length!==e);a=!0);}catch(t){s=!0,o=t}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(t,e)||function(t,e){if(t){if("string"==typeof t)return sr(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?sr(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(Object(s.useState)(),2),e=t[0],n=t[1];return l.a.createElement(l.a.Fragment,{key:"right"},l.a.createElement(Sn.a,{onClick:function(){return n(!0)}},l.a.createElement(ar.a,null)),l.a.createElement(er.a,{anchor:"right",open:e,onClose:function(){return n(!1)}},l.a.createElement(cr,null)))}var cr=function(){return l.a.createElement(fn.a,null,l.a.createElement(dn.a,{variant:"h6",gutterBottom:!0,component:"div",p:2},"Table of Content 1"),l.a.createElement(nr.a,null,l.a.createElement(rr.a,{disablePadding:!0},l.a.createElement(or.a,null,l.a.createElement(ir.a,{primary:"chapter1"}))),l.a.createElement(rr.a,{disablePadding:!0},l.a.createElement(or.a,{component:"a",href:"#simple-list"},l.a.createElement(ir.a,{primary:"chapter2"})))))};function ur(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(t);!(a=(r=n.next()).done)&&(i.push(r.value),!e||i.length!==e);a=!0);}catch(t){s=!0,o=t}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(t,e)||function(t,e){if(t){if("string"==typeof t)return pr(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?pr(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function pr(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function fr(t,e){var n,r=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)),r}function dr(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?fr(Object(n),!0).forEach((function(e){hr(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):fr(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function hr(t,e,n){e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n}var yr=Object(r.connect)((function(t){var e,n,r=Ae.E(t),o=Ae.F(t),i=[],a=!1,s=(r&&(i=Ae.Y(t,r.id),(s=Ae.H(t,r.id))?(e=Ae.eb(t,s),a=Ae.p(t,s)):e=Ae.ib(t,r.id)),o&&(n=(s=Ae.I(t,o.id))?Ae.fb(t,s):Ae.jb(t,o.id)),Ae.T(t));return{witnesses:i,selectedText:r,selectedText2:o,selectedWitness:e,selectedWitness2:n,textListIsVisible:Object(Ae.V)(t),accountOverlayVisible:Object(Ae.e)(t),textFontSize:s,isSecondWindowOpen:Ae.rb(t),exportingWitness:a,isPanelLinked:Ae.pb(t),user:Ae.cb(t),isAnnotating:Ae.nb(t),searchValue:t.ui.searchValue}}),null,(function(t,e,n){var r=e.dispatch,o=t.selectedText;return dr(dr(dr({},n),t),{},(hr(n={navigationButtonClicked:function(){e.dispatch(Te.Vb(!t.textListIsVisible))},onSelectedWitness:function(t){r(Te.Jc(null==o?void 0:o.id,null==t?void 0:t.id))},onChangedFontSize:function(t){r(Te.Tb(t))},onChangeWindowOpen:function(t,e){r(Te.Oc(t,e))},onExport:function(){r(Te.ac(t.selectedWitness.id,"docx"))}},"navigationButtonClicked",(function(){r(Te.Vb(!t.textListIsVisible))})),hr(n,"onChangePanelLink",(function(t){r(Te.Ib(t))})),hr(n,"changeIsAnnotating",(function(t){r(Te.Gb(t)),!1===t&&(t=Te.Qb(null),r(t),r(Te.Qb(null)))})),hr(n,"searchChanged",(function(t){r(Te.Rb(t))})),n))}))((function(t){var e=(i=ur(Object(s.useState)(""),2))[0],n=i[1],r=(i=ur(Object(s.useState)(!1),2))[0],o=i[1],i=Object(s.useRef)(),a=Object(s.useRef)(),c=l.a.useRef(g()((function(e){t.searchChanged(e)}),500)).current,u=Object(s.useCallback)((function(n){n.preventDefault(),t.searchChanged(e)}),[e]);return Object(s.useEffect)((function(){!0===r&&a.current.focus()}),[r]),Object(s.useEffect)((function(){c(e)}),[e]),l.a.createElement(bn.a,{ref:i,direction:"column",spacing:1,px:2,py:1,style:{background:"#f7f7f7"}},l.a.createElement(bn.a,{direction:"row",spacing:1,justifyContent:"space-between"},l.a.createElement(fn.a,{sx:{display:"flex",gap:2}},l.a.createElement(gn,null),l.a.createElement(ln,{witnesses:t.witnesses,activeWitness:t.selectedWitness,onSelectedWitness:t.onSelectedWitness,user:t.user})),l.a.createElement(vn.a,{size:"small","aria-label":"small button group",sx:{position:"relative",display:"flex",alignItems:"center",justifyContent:"center",width:"fit-content",border:function(t){return"1px solid ".concat(t.palette.divider)},borderRadius:1,bgcolor:"background.paper",color:"text.secondary","& svg":{m:1.5},"& hr":{mx:.5}},className:nn.a.button_group_menu},l.a.createElement(Hn,{isSecondWindowOpen:t.isSecondWindowOpen}),l.a.createElement(wn.a,{orientation:"vertical",variant:"middle",flexItem:!0}),l.a.createElement(Dn,t),l.a.createElement(Fn,{isSecondWindowOpen:t.isSecondWindowOpen,onChangeWindowOpen:t.onChangeWindowOpen}),l.a.createElement(wn.a,{orientation:"vertical",variant:"middle",flexItem:!0}),l.a.createElement(zn,{handleWindowSearch:function(){o((function(t){return!t}))}}),l.a.createElement(Rn,t),l.a.createElement(tr,t),l.a.createElement(lr,t))),l.a.createElement(On.a,{in:r},l.a.createElement("form",{onSubmit:u},l.a.createElement(bn.a,{direction:"row",spacing:2},l.a.createElement(hn.a,{hiddenLabel:!0,id:"filled-hidden-label-small",inputProps:{style:{height:25,padding:"0 14px"}},style:{height:25,flex:1},fullWidth:!0,inputRef:a,value:e,onChange:function(t){return n(t.target.value)},onBlur:function(){return o(!1)}}),l.a.createElement(Sn.a,{variant:"outlined",size:"small",onClick:u,style:{height:25}},"Search")))))}));function mr(t){return(mr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function gr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function br(t,e){return(br=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function vr(t){return(vr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var wr,Or,Sr,xr,Er=0,Ar=(Oe=function(t){var e=r;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&br(e,t);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=vr(t);n=e?(n=vr(this).constructor,Reflect.construct(r,arguments,n)):r.apply(this,arguments),r=this;if(n&&("object"===mr(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==r)return r;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(r);function r(){var t;if(this instanceof r)return(t=n.call(this)).key=Er++,t.ref=l.a.createRef(),t.selectedWindow=null,t;throw new TypeError("Cannot call a class as a function")}return e=r,(t=[{key:"mouseEnter",value:function(){2===this.selectedWindow&&this.props.changeSelectedWindow(1)}},{key:"componentDidMount",value:function(){this.ref.current.addEventListener("mouseenter",this.mouseEnter.bind(this))}},{key:"componentDidUpdate",value:function(){this.selectedWindow=this.props.selectedWindow}},{key:"render",value:function(){this.props.text&&this.props.text;var t,e,n=null;n=[this.props.annotatedText&&this.props.text&&!this.props.loading?(t=this.props.paginated?(t=this.props.pageBreaks,0===(e=Xe(t))[0]&&e.shift(),function(t){return e}):Object(Ke.a)(1e3,/^།[\s]+(?!།[\s]+)/,2,5),n=new $.a(this.props.annotatedText,t),l.a.createElement(Ye,{splitText:n,annotations:this.props.annotations,activeAnnotations:this.props.activeAnnotations,activeAnnotation:this.props.activeAnnotation,limitWidth:!1,didSelectSegmentIds:this.props.didSelectSegmentIds,selectedSegmentId:this.props.selectedSegmentId,annotationPositions:this.props.annotationPositions,selectedAnnotatedSegments:this.props.selectedAnnotatedSegments,textListVisible:this.props.textListVisible,showImages:this.props.pageImagesVisible,imagesBaseUrl:this.props.imagesBaseUrl,selectedWitness:this.props.selectedWitness,key:this.key,selectedSearchResult:this.props.selectedSearchResult,searchValue:this.props.searchValue,fontSize:this.props.fontSize,isSecondWindowOpen:this.props.isSecondWindowOpen,changeSyncIdOnScroll:this.props.changeSyncIdOnScroll,changeSyncIdOnClick:this.props.changeSyncIdOnClick,imageData:this.props.imageData,isPanelLinked:this.props.isPanelLinked,selectedImage:this.props.selectedImage,changeSelectedImage:this.props.changeSelectedImage,isAnnotating:this.props.isAnnotating,closeAnnotation:this.props.closeAnnotation,textAlignmentById:this.props.textAlignmentById,isPanelVisible:this.props.isPanelVisible,syncIdOnScroll:this.props.syncIdOnScroll,syncIdOnScroll2:this.props.syncIdOnScroll2,selectedWindow:this.props.selectedWindow,selectedSourceRange:this.props.selectedSourceRange,selectedTargetRange:this.props.selectedTargetRange,changeSelectedRange:this.props.changeSelectedRange})):l.a.createElement("div",{key:this.key})];return l.a.createElement(fn.a,{style:{height:"100%"},className:m()(tn.a.textDetail,en.a.flex,en.a.flexColumn),key:this.key,ref:this.ref},l.a.createElement(yr,null),l.a.createElement(Vt.a,{loaded:!this.props.loading,zIndex:5}),l.a.createElement("div",{className:m()(tn.a.textContainer,en.a.flex)},this.props.loading?l.a.createElement("div",null):n))}}])&&gr(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),r}(l.a.Component),n(157),n(69));function Tr(t,e){var n,r=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)),r}function jr(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Tr(Object(n),!0).forEach((function(e){var r,o;r=t,o=n[e=e],e in r?Object.defineProperty(r,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[e]=o})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Tr(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function kr(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(t);!(a=(r=n.next()).done)&&(i.push(r.value),!e||i.length!==e);a=!0);}catch(t){s=!0,o=t}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(t,e)||Ir(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ir(t,e){if(t){if("string"==typeof t)return Pr(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Pr(t,e):void 0}}function Pr(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Cr(t){return[t.start,t.length].join("-")}function Rr(t,e){if(t===wr&&e===Or&&t.version===xr)return Sr;for(var n={},r={},o=0;o<e.length;o++)!function(o){var i=e[o],a=(o=kr(t.getPositionOfAnnotation(i),2))[0],s=o[1];if(null!=a)if(0===s){if(i.isInsertion){if(o=Cr(i),o=r[o])return o.map((function(t){return n[t].push(i)}));a=h.c+a}i.isDeletion&&0<i.length&&(a=h.b+a),i.type===c.a.pageBreak&&(a=h.e+a),i.type===c.a.lineBreak&&(a=h.d+a),void 0===n[a]&&(n[a]=[]),-1===n[a].indexOf(i)&&n[a].push(i)}else{for(var l=[],u=a;u<a+s;u++)void 0===n[u]&&(n[u]=[]),-1===n[u].indexOf(i)&&n[u].push(i),l.push(u);i.isInsertion&&(o=Cr(i),r[o]=l)}}(o);return Or=e,Sr=n,xr=(wr=t).version,n}function _r(t,e){var n=[];if(o()(t,(function(t){return n.push(t.start)})),n=n.sort((function(t,e){return t-e})),e){var r=[];if(o()(e,(function(t){return r.push(t.start)})),r=r.sort((function(t,e){return t-e})),0===n.length)return r;if(n.length/r.length<.9)for(var i=n[n.length-1],a=0,s=r.length;a<s;a++){var l=r[a];i<l&&n.push(l)}}return n}var Br=null;Ln=Object(r.connect)((function(t){var e=Object(Ae.cb)(t),n=t.data.loadingWitnesses||t.data.loadingAnnotations,r=Object(Ae.V)(t),o=Ae.pb(t),i=Ae.S(t);if(n)return{text:null,witnesses:null,baseWitness:null,annotations:null,loading:n,paginated:null,pageImagesVisible:!1,annotatedText:null,selectedAnnotatedSegments:null,annotationPositions:null,activeAnnotations:null,activeAnnotation:null,user:e,textListVisible:r,fontSize:Pt.a,isSecondWindowOpen:Object(Ae.rb)(t),isPanelLinked:o,textAlignmentById:i};var a,s,l,u=Object(Ae.E)(t),p={},f=(u&&(a=Object(Ae.ib)(t,u.id),s=Object(Ae.n)(t,u.id)),Object(Ae.B)(t)),h={},y=[],m=null,g=Object(Ae.h)(t),b=[],v={},w=[],O="",S=Object(Ae.y)(t),x=!1,E=Object(Ae.T)(t);if(a&&u&&t.data.witnessAnnotationsById.hasOwnProperty(a.id)){p=Object(Ae.Y)(t,u.id),m=((l=(A=Object(Ae.H)(t,u.id))?Object(Ae.eb)(t,A):l)||(A=(l=a).id),l.id!==a.id&&(x=!0,Object(Ae.tb)(t)),Ar.d(t,l.id)),v=(A=kr(Ar.c(t,l,a),2))[0],y=A[1];if(m&&(h=Rr(m,Object.values(y))),g&&m&&(g=Br&&Br.id===l.id?g:m.getAnnotation(g.start,g.length))&&(b=m.segmentsForAnnotation(g)),l&&s&&m){var A=m.getAnnotationsOfType(c.a.pageBreak)||{},T=null;l.id!==s.id&&(T=Object(Ae.m)(t,a.id,c.a.pageBreak,s.id));for(var j=0,k=(w=_r(A,T)).length;j<k;j++){var I=w[j];(I=m.segmentAtOriginalPosition(I))instanceof d.a?w[j]=I.start:I instanceof Number&&(w[j]=I)}x&&(O="/static/images/texts/"+u.name+"/"+l.source.name+"/")}}Br=l;A=Ae.M(t),T=Ae.N(t);var P=Ae.L(t),C=Ae.J(t);return{text:u,witnesses:p,workingWitness:a,baseWitness:s,annotations:y,loading:n,paginated:x,pageImagesVisible:!1,annotatedText:m,selectedAnnotatedSegments:b,annotationPositions:h,activeAnnotations:jr({},v),activeAnnotation:g,pageBreaks:w,imagesBaseUrl:O,user:e,textListVisible:r,selectedWitness:l,selectedSearchResult:f,searchValue:S,fontSize:E,isSecondWindowOpen:Object(Ae.rb)(t),imageData:Object(Ae.q)(t),isPanelLinked:o,selectedImage:Object(Ae.z)(t),isImagePortrait:Object(Ae.ob)(t),isPanelVisible:Object(Ae.qb)(t),isAnnotating:Ae.nb(t),textAlignmentById:i,syncIdOnScroll:A,syncIdOnScroll2:T,syncIdOnClick:P,selectedWindow:C,selectedSourceRange:Object(Ae.C)(t),selectedTargetRange:Object(Ae.D)(t)}}),null,(function(t,e,n){function r(t,e,n){var r=[],o=[],i=[];(t=b[t])&&(r=t.filter((function(t){return t.type===c.a.variant})),o=t.filter((function(t){return t.type===c.a.pageBreak})),i=t.filter((function(t){return t.type===c.a.lineBreak}))),t=a()(r.concat(o,i),g.annotations,(function(t,e){return t.toString()==e.toString()})),o=null,o=0<t.length?t[0]:r&&0<r.length?(i=function(t){for(var e=null,n=0;n<t.length;n++){var r=t[n];(!e||r.length>e.length)&&(e=r)}return e}(r),r=(t=kr(g.getPositionOfAnnotation(i),2))[0],t=t[1],i&&i.isInsertion&&(t=0),g.getBaseAnnotation(r,t)):g.getBaseAnnotation(e,n);m(Object(Te.Qb)(o))}function o(t){return-1!==t.indexOf("i_")}function s(t){return-1!==t.indexOf("ds_")}function l(t){return-1!==t.indexOf("p_")}function d(t){return-1!==t.indexOf("l_")}function y(t){return!o(t)&&s(t)?t.substr(3):t.substr(2)}var m=e.dispatch,g=t.annotatedText,b=t.annotationPositions;return jr(jr(jr({},t),n),{},{didSelectSegmentIds:function(e){if(0!==e.length){var n,r=[],l=[],d=function(t,e){var n,r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=Ir(t))||e&&t&&"number"==typeof t.length)return r&&(t=r),n=0,{s:e=function(){},n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:e};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,a=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return i=t.done,t},e:function(t){a=!0,o=t},f:function(){try{i||null==r.return||r.return()}finally{if(a)throw o}}}}(e);try{for(d.s();!(n=d.n()).done;){var v,w,O,S=n.value;s(S)||o(S)||(v=y(S),w=g.segmentedText.segmentAtPosition(v),l.push(w),(O=b[w.start])&&(r=r.concat(O)))}}catch(e){d.e(e)}finally{d.f()}r=i()(r,(function(t,e){return t.toString()==e.toString()}));var x,E,A=a()(r,g.annotations,(function(t,e){return t.toString()==e.toString()})),T=function(t,e,n,r){if(0===t.length)return null;for(var o=t[0],i=(t=t[t.length-1],o.start),a=t.end,s=null,l=null,c=0;c<n.length;c++){var u=n[c],p=null,f=(d=kr(r.getPositionOfAnnotation(u),2))[0],d=d[1];-1!==e.indexOf(u)?(f&&f<i&&(i=f,s=u),(p=f+d-1)&&a<p&&(l=a=p)):a<(p=f+d-1)&&(a=p)}return{start:i,length:a-i+1,annotation:s&&l&&s===l?s:null}}(l,A,r,t.annotatedText);T?(x=g.getBaseAnnotation(T.start,T.length),null,E=T.annotation||(0<A.length?(A=g.segmentedText.segmentsInRange(T.start,T.length).reduce((function(t,e){return t+e.text}),""),t.selectedWitness||console.log("no stateProps.selectedWitness: %o",t.selectedWitness),new c.c(h.f,function(t){var e=new u.b(h.f,u.a);return t=new f.a(t.id,t.name),new p.a(h.f,t,e,"",!1)}(t.text),x.start,x.length,A,c.a.variant,t.selectedWitness,t.user)):x),m(Object(Te.Qb)(E))):console.warn("No range for selected segment ids: %o",e)}},selectedSegmentId:function(e){var n,i=y(e),a=i;o(e)?a=h.c+i:s(e)?a=h.b+i:l(e)?a=h.e+i:d(e)&&(a=h.d+i),b[a],""===e?t.activeAnnotation&&(n=Te.Qb(null),m(n)):o(e)||s(e)||l(e)||d(e)?r(a,i,0):(n=Number(y(e)),(a=g.segmentedText.segmentAtPosition(n))&&r(a.start,a.start,a.length))},changeSyncIdOnScroll:function(t){return m(Te.Mb(t))},changeSyncIdOnClick:function(t){return m(Te.Lb(t))},changeSelectedImage:function(t){m(Te.Cc(t))},changeSelectedWindow:function(t){m(Te.Kb(t))},changeSelectedRange:function(t){m(Te.Jb(t))},closeAnnotation:function(){var t=Te.Qb(null);m(t)}})}))(Oe);e.default=Ln},925:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(167);function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}n(58);var i=function(){function t(e,n){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.annotatedText=e,this.splitter=n,this._texts=null,this._textsId=null,this._textsFinalPositions=[]}var e,n;return e=t,(n=[{key:"texts",get:function(){if(!this.annotatedText)return[];if(!this._texts||this._textsId!==this.annotatedText.getUniqueId()){this._textsFinalPositions=[];var t=this.annotatedText.segmentedText,e=t.getText(),n=this.splitter(e).filter((function(t){return 0!==t}));if(0===n.length)return this._textsFinalPositions.push(e.length),[t];n[n.length-1]+1<e.length&&n.push(e.length-1);for(var o=t.segments,i=0,a=[],s=0;s<n.length;s++){var l=n[s],c=(l=t.indexOfSegmentAtPosition(l-1),void 0);c=s==n.length-1?o.slice(i):o.slice(i,l+1),c=new r.a(c);a.push(c),i=l+1,0<=l&&(c=o[l],this._textsFinalPositions.push(c.end))}this._texts=a.filter((function(t){return 0<t.segments.length})),this._textsId=this.annotatedText.getUniqueId()}return this._texts||[]}},{key:"getTextsFinalPositions",value:function(){return this.texts,this._textsFinalPositions}},{key:"getTextIndexOfPosition",value:function(t){for(var e=this.getTextsFinalPositions(),n=0,r=null,o=0;o<e.length;o++){var i=e[o];if(n<=t&&t<=i){r=o;break}n=i}return null===r&&(console.warn("no index for position %d",t),r=e.length-1),r}}])&&o(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}()},926:function(t,e,n){t.exports={"green-tint":"#88af8e","blue-tint":"#024279","active-button":"#00746b",mainTint:"#024279",activeButton:"#00746b",inlineWidth:"280px",annotationControls:"AnnotationControls---annotationControls",annotationContent:"AnnotationControls---annotationContent",subTitle:"AnnotationControls---subTitle",title:"AnnotationControls---title",sectionHeading:"AnnotationControls---sectionHeading",text:"AnnotationControls---text",padding:"AnnotationControls---padding",arrowTop:"AnnotationControls---arrowTop",arrowLeft:"AnnotationControls---arrowLeft",arrowRight:"AnnotationControls---arrowRight",inline:"AnnotationControls---inline",arrow:"AnnotationControls---arrow",arrowDs:"AnnotationControls---arrowDs",nothingSelected:"AnnotationControls---nothingSelected",anonymousMessage:"AnnotationControls---anonymousMessage",noNotes:"AnnotationControls---noNotes",breakButtons:"AnnotationControls---breakButtons"}},927:function(t,e,n){t.exports={"green-tint":"#88af8e","blue-tint":"#024279","active-button":"#00746b",mainTint:"#024279",activeButton:"#00746b",save:"Button---save",cancel:"Button---cancel",buttonContainer:"Button---buttonContainer"}},929:function(t,e,n){"use strict";var r=n(0),o=n.n(r),i=(r=n(931),n.n(r));e.a=function(t){var e=t.max,n=t.min,r=t.initialvalue,a=void 0===(t=t.changeSize)?function(t){return console.log(t)}:t;return o.a.createElement("div",{className:i.a.inputRanges},o.a.createElement("span",{style:{fontSize:13,top:"-5px"}},"ཀ"),o.a.createElement("input",{type:"range",style:{width:"70%"},className:i.a.inputRange,min:n,max:e,step:1,smooth:"yes",value:r,onChange:function(t){return a(parseInt(t.target.value))}}),o.a.createElement("span",{style:{fontSize:18,top:"-10px"}},"ཀ"))}},931:function(t,e,n){t.exports={inputRanges:"Slider---inputRanges",inputRange:"Slider---inputRange"}},941:function(t,e,n){t.exports={"green-tint":"#88af8e","blue-tint":"#024279","active-button":"#00746b",mainTint:"#024279",activeButton:"#00746b",annotationDetail:"AnnotationDetail---annotationDetail",active:"AnnotationDetail---active",annotationHeader:"AnnotationDetail---annotationHeader",activeIcon:"AnnotationDetail---activeIcon",editing:"AnnotationDetail---editing",actionButtons:"AnnotationDetail---actionButtons",edit:"AnnotationDetail---edit",editImage:"AnnotationDetail---editImage",save:"AnnotationDetail---save",cancel:"AnnotationDetail---cancel"}},972:function(t,e,n){t.exports={"green-tint":"#88af8e","blue-tint":"#024279","active-button":"#00746b",mainTint:"#024279",activeButton:"#00746b",paddingSide:"20px",maxWidth:"600px",text:"Text---text",syncIdClass:"Text---syncIdClass",textFirstRow:"Text---textFirstRow",textLine:"Text---textLine",textline:"Text---textline",limitWidth:"Text---limitWidth",textContainer:"Text---textContainer",annotation:"Text---annotation",selectedAnnotation:"Text---selectedAnnotation",removedByAnnotation:"Text---removedByAnnotation",insertion:"Text---insertion",highlight:"Text---highlight",activeHighlight:"Text---activeHighlight",lineBreak:"Text---lineBreak",pageBreak:"Text---pageBreak",selectedRange:"Text---selectedRange"}},978:function(t,e,n){t.exports={heading:"AnnotationControlsHeading---heading",title:"AnnotationControlsHeading---title",button:"AnnotationControlsHeading---button"}},979:function(t,e,n){t.exports={"green-tint":"#88af8e","blue-tint":"#024279","active-button":"#00746b",mainTint:"#024279",activeButton:"#00746b",button:"AddButton---button"}},980:function(t,e,n){t.exports={"green-tint":"#88af8e","blue-tint":"#024279","active-button":"#00746b",mainTint:"#024279",activeButton:"#00746b",editorContainer:"NoteEditor---editorContainer",textEditor:"NoteEditor---textEditor"}},981:function(t,e,n){t.exports={question:"QuestionView---question",threadLink:"QuestionView---threadLink"}},982:function(t,e,n){t.exports={name:"AnswerView---name",answer:"AnswerView---answer"}},983:function(t,e,n){t.exports={"green-tint":"#88af8e","blue-tint":"#024279","active-button":"#00746b",mainTint:"#024279",activeButton:"#00746b",editorContainer:"QuestionEditor---editorContainer",textEditor:"QuestionEditor---textEditor"}},984:function(t,e,n){t.exports={loading:"QuestionsLoading---loading"}},985:function(t,e,n){t.exports={"green-tint":"#88af8e","blue-tint":"#024279","active-button":"#00746b",mainTint:"#024279",activeButton:"#00746b",note:"Note---note",header:"Note---header",info:"Note---info",content:"Note---content",delete:"Note---delete"}},986:function(t,e,n){t.exports={"green-tint":"#88af8e","blue-tint":"#024279","active-button":"#00746b",mainTint:"#024279",activeButton:"#00746b",header:"AnnotationControlsHeader---header",Anotation_closeBtn:"AnnotationControlsHeader---Anotation_closeBtn",edit:"AnnotationControlsHeader---edit"}},993:function(t,e,n){t.exports={"green-tint":"#88af8e","blue-tint":"#024279","active-button":"#00746b",mainTint:"#024279",activeButton:"#00746b",inlineWidth:"280px",annotationControls:"SplitText---annotationControls",annotationContent:"SplitText---annotationContent",subTitle:"SplitText---subTitle",title:"SplitText---title",sectionHeading:"SplitText---sectionHeading",text:"SplitText---text",padding:"SplitText---padding",arrowTop:"SplitText---arrowTop",arrowLeft:"SplitText---arrowLeft",arrowRight:"SplitText---arrowRight",inline:"SplitText---inline",arrow:"SplitText---arrow",arrowDs:"SplitText---arrowDs",nothingSelected:"SplitText---nothingSelected",anonymousMessage:"SplitText---anonymousMessage",noNotes:"SplitText---noNotes",breakButtons:"SplitText---breakButtons",splitText:"SplitText---splitText",splitTextRowContent:"SplitText---splitTextRowContent",splitTextRow:"SplitText---splitTextRow",pechaImage:"SplitText---pechaImage",controlsPlaceholder:"SplitText---controlsPlaceholder",hide:"SplitText---hide",pageNumber:"SplitText---pageNumber",hightlighter:"SplitText---hightlighter",pulse:"SplitText---pulse"}},994:function(t,e,n){t.exports={"green-tint":"#88af8e","blue-tint":"#024279","active-button":"#00746b",mainTint:"#024279",activeButton:"#00746b",textDetail:"TextDetail---textDetail",textContainer:"TextDetail---textContainer"}},995:function(t,e,n){t.exports={"green-tint":"#88af8e","blue-tint":"#024279","active-button":"#00746b",mainTint:"#024279",activeButton:"#00746b",button_group_menu:"textDetailHeading---button_group_menu"}},996:function(t,e,n){t.exports={"green-tint":"#88af8e","blue-tint":"#024279","active-button":"#00746b",mainTint:"#024279",activeButton:"#00746b",selectVersion:"SelectVersion---selectVersion",selected:"SelectVersion---selected","styled-select":"SelectVersion---styled-select"}}}]);