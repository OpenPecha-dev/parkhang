(window.webpackJsonpparkhang=window.webpackJsonpparkhang||[]).push([[3],{1030:function(t,e,n){t.exports={heading:"AnnotationControlsHeading---heading",title:"AnnotationControlsHeading---title",button:"AnnotationControlsHeading---button"}},1031:function(t,e,n){t.exports={"green-tint":"#88af8e","blue-tint":"#024279","active-button":"#00746b",mainTint:"#024279",activeButton:"#00746b",button:"AddButton---button"}},1032:function(t,e,n){t.exports={"green-tint":"#88af8e","blue-tint":"#024279","active-button":"#00746b",mainTint:"#024279",activeButton:"#00746b",editorContainer:"NoteEditor---editorContainer",textEditor:"NoteEditor---textEditor"}},1033:function(t,e,n){t.exports={question:"QuestionView---question",threadLink:"QuestionView---threadLink"}},1034:function(t,e,n){t.exports={name:"AnswerView---name",answer:"AnswerView---answer"}},1035:function(t,e,n){t.exports={"green-tint":"#88af8e","blue-tint":"#024279","active-button":"#00746b",mainTint:"#024279",activeButton:"#00746b",editorContainer:"QuestionEditor---editorContainer",textEditor:"QuestionEditor---textEditor"}},1036:function(t,e,n){t.exports={loading:"QuestionsLoading---loading"}},1037:function(t,e,n){t.exports={"green-tint":"#88af8e","blue-tint":"#024279","active-button":"#00746b",mainTint:"#024279",activeButton:"#00746b",note:"Note---note",header:"Note---header",info:"Note---info",content:"Note---content",delete:"Note---delete"}},1039:function(t,e,n){t.exports={"green-tint":"#88af8e","blue-tint":"#024279","active-button":"#00746b",mainTint:"#024279",activeButton:"#00746b",header:"AnnotationControlsHeader---header",Anotation_closeBtn:"AnnotationControlsHeader---Anotation_closeBtn",edit:"AnnotationControlsHeader---edit"}},1042:function(t,e,n){t.exports={"green-tint":"#88af8e","blue-tint":"#024279","active-button":"#00746b",mainTint:"#024279",activeButton:"#00746b",textDetail:"TextDetail---textDetail",textContainer:"TextDetail---textContainer",tableContent:"TextDetail---tableContent"}},1043:function(t,e,n){t.exports={"green-tint":"#88af8e","blue-tint":"#024279","active-button":"#00746b",mainTint:"#024279",activeButton:"#00746b",button_group_menu:"textDetailHeading---button_group_menu"}},1044:function(t,e,n){t.exports={"green-tint":"#88af8e","blue-tint":"#024279","active-button":"#00746b",mainTint:"#024279",activeButton:"#00746b",selectVersion:"SelectVersion---selectVersion",selectEmpty:"SelectVersion---selectEmpty",selectOptions:"SelectVersion---selectOptions","styled-select":"SelectVersion---styled-select"}},1045:function(t,e,n){t.exports={textlist:"TextList---textlist",open:"TextList---open"}},1047:function(t,e,n){t.exports={highlight:"SearchStyle---highlight",searchListItem:"SearchStyle---searchListItem"}},1048:function(t,e,n){t.exports={TableContent:"TableOfContent---TableContent"}},1049:function(t,e,n){t.exports={"green-tint":"#88af8e","blue-tint":"#024279","active-button":"#00746b",mainTint:"#024279",activeButton:"#00746b",paddingSide:"20px",maxWidth:"600px",text:"Text---text",syncIdClass:"Text---syncIdClass",textFirstRow:"Text---textFirstRow",textLine:"Text---textLine",textline:"Text---textline",limitWidth:"Text---limitWidth",textContainer:"Text---textContainer",annotation:"Text---annotation",selectedAnnotation:"Text---selectedAnnotation",removedByAnnotation:"Text---removedByAnnotation",insertion:"Text---insertion",highlight:"Text---highlight",activeHighlight:"Text---activeHighlight",lineBreak:"Text---lineBreak",pageBreak:"Text---pageBreak",selectedRangelight:"Text---selectedRangelight",selectedRangeDark:"Text---selectedRangeDark",selectedImage:"Text---selectedImage"}},1050:function(t,e,n){t.exports={"green-tint":"#88af8e","blue-tint":"#024279","active-button":"#00746b",mainTint:"#024279",activeButton:"#00746b",inlineWidth:"280px",annotationControls:"SplitText---annotationControls",annotationContent:"SplitText---annotationContent",subTitle:"SplitText---subTitle",title:"SplitText---title",sectionHeading:"SplitText---sectionHeading",text:"SplitText---text",padding:"SplitText---padding",arrowTop:"SplitText---arrowTop",arrowLeft:"SplitText---arrowLeft",arrowRight:"SplitText---arrowRight",inline:"SplitText---inline",arrow:"SplitText---arrow",arrowDs:"SplitText---arrowDs",nothingSelected:"SplitText---nothingSelected",anonymousMessage:"SplitText---anonymousMessage",noNotes:"SplitText---noNotes",breakButtons:"SplitText---breakButtons",splitText:"SplitText---splitText",splitTextRowContent:"SplitText---splitTextRowContent",splitTextRow:"SplitText---splitTextRow",pechaImage:"SplitText---pechaImage",controlsPlaceholder:"SplitText---controlsPlaceholder",hide:"SplitText---hide",pageNumber:"SplitText---pageNumber"}},1057:function(t,e,n){"use strict";n.r(e);var o=n(1020),r=n.n(o),i=(o=n(972),n.n(o)),a=(o=n(980),n.n(o)),s=n(0),l=n.n(s),c=(o=n(34),n(27)),u=n(150),p=n(104),f=n(151),d=n(51),h=n(68),m=n(54),y=n.n(m),g=(m=(n(181),n(275)),n.n(m)),b=(m=n(989),n.n(m)),v=n(79),w=n(177),x=(m=n(990),n.n(m));function S(){return(S=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n,o=arguments[e];for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])}return t}).apply(this,arguments)}function O(t){return l.a.createElement("svg",S({viewBox:"0 0 24 24"},t),E,T)}var E=l.a.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),T=l.a.createElement("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"}),I=(m=n(279),n.n(m));function A(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}function j(t){(e=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var o,r,i=[],a=!0,s=!1;try{for(n=n.call(t);!(a=(o=n.next()).done)&&(i.push(o.value),!e||i.length!==e);a=!0);}catch(t){s=!0,r=t}finally{try{a||null==n.return||n.return()}finally{if(s)throw r}}return i}}(t,e)||function(t,e){if(t){if("string"==typeof t)return A(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?A(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(Object(s.useState)(null),2))[0],e[1];var e=l.a.createElement("p",null,"<",l.a.createElement(w.a,{id:"annotation.delete"}),">"),n=(""!==(n=t.annotationData.content).trim()&&(250<n.length&&(n=n.substr(0,250)+"…"),e=l.a.createElement("p",null,n)),[x.a.annotationDetail]);t.isActive&&n.push(x.a.active),n=y.a.apply(void 0,n);return l.a.createElement("div",{className:n,onClick:t.selectAnnotationHandler},l.a.createElement("div",{className:x.a.annotationHeader},t.isActive&&l.a.createElement("div",{className:x.a.activeIcon},l.a.createElement(O,{style:{fill:I.a.activeButton},width:15,height:15})),l.a.createElement("h3",null,t.annotationData.name),t.isLoggedIn&&t.isActive&&l.a.createElement("button",{style:{display:"none"},className:x.a.edit,onClick:t.editAnnotationHandler,id:"editBtn"})),!t.isWorkingSection&&e)}function k(t){var e=t.annotationData.content,n=[x.a.annotationDetail],o=null;t.isActive&&n.push(x.a.active),n=y.a.apply(void 0,n);return l.a.createElement("div",{className:n},l.a.createElement("h3",null,t.annotationData.name),l.a.createElement("div",{className:x.a.editing},l.a.createElement("textarea",{defaultValue:e,autoFocus:!0,onInput:function(t){o.style.height="5px",o.style.height=o.scrollHeight+"px"},ref:function(t){return o=t}}),l.a.createElement("div",{className:x.a.actionButtons},l.a.createElement("div",{className:x.a.save,onClick:function(){o&&t.saveAnnotationHandler(o.value)}},l.a.createElement(w.a,{id:"annotation.save"})),l.a.createElement("div",{className:x.a.cancel,onClick:t.cancelAnnotationHandler},l.a.createElement(w.a,{id:"annotation.cancel"})))))}function P(t){return l.a.createElement("div",{className:_.a.button,title:t.title,onClick:t.onClick},"+")}n(359);m=n(967);var C=n.n(m),R=(m=(n(78),n(49)),n(1030)),B=n.n(R),_=(R=n(1031),n.n(R));function W(t){return(W="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function N(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function L(t,e){return(L=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function q(t){return(q=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}R=function(t){var e=o;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&L(e,t);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,o=q(t);n=e?(n=q(this).constructor,Reflect.construct(o,arguments,n)):o.apply(this,arguments),o=this;if(n&&("object"===W(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==o)return o;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(o);function o(){var t=this,e=o;if(t instanceof e)return n.apply(this,arguments);throw new TypeError("Cannot call a class as a function")}return e=o,(t=[{key:"render",value:function(){var t,e=null;return this.props.buttonOnClick&&(t=this.props.buttonTitleId?this.props.intl.formatMessage({id:this.props.buttonTitleId}):"",e=l.a.createElement(P,{title:t,onClick:this.props.buttonOnClick})),l.a.createElement("h3",{className:B.a.heading},l.a.createElement("span",{className:B.a.title},l.a.createElement(w.a,{id:this.props.titleId})),e&&l.a.createElement("div",{className:B.a.button},e))}}])&&N(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),o}(l.a.Component),Object(m.c)(R),R=n(1032);var D=n.n(R),H=(R=n(969),n.n(R));function z(t){return(z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function M(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function V(t,e){return(V=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function F(t){return(F=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var U=function(t){var e=o;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&V(e,t);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,o=F(t);n=e?(n=F(this).constructor,Reflect.construct(o,arguments,n)):o.apply(this,arguments),o=this;if(n&&("object"===z(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==o)return o;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(o);function o(t){var e;if(this instanceof o)return(e=n.call(this,t)).state={content:t.note.content},e;throw new TypeError("Cannot call a class as a function")}return e=o,(t=[{key:"save",value:function(){var t=this.textarea?this.textarea.value:"";this.props.saveNote(this.props.note,t)}},{key:"cancel",value:function(){this.props.cancel()}},{key:"handleChange",value:function(t){var e=t.target instanceof HTMLTextAreaElement?t.target.value:"";this.setState((function(t,n){return{content:e}}))}},{key:"render",value:function(){var t=this;return l.a.createElement("div",{className:D.a.editorContainer},l.a.createElement("textarea",{className:D.a.textEditor,ref:function(e){return t.textarea=e},value:this.state.content,onChange:this.handleChange.bind(this)}),l.a.createElement("div",{className:H.a.buttonContainer},l.a.createElement("div",{className:H.a.save,onClick:this.save.bind(this)},l.a.createElement(w.a,{id:"annotation.save"})),l.a.createElement("div",{className:H.a.cancel,onClick:this.cancel.bind(this)},l.a.createElement(w.a,{id:"annotation.cancel"}))))}}])&&M(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),o}(l.a.Component),Q=(R=n(1033),n.n(R)),Y=(R=(n(278),n(1034)),n.n(R)),G=(n(216),n(161));function $(t){return($="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function J(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Z(t,e){return(Z=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function X(t){return(X=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var K=function(t){var e=o;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Z(e,t);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,o=X(t);n=e?(n=X(this).constructor,Reflect.construct(o,arguments,n)):o.apply(this,arguments),o=this;if(n&&("object"===$(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==o)return o;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(o);function o(){var t=this,e=o;if(t instanceof e)return n.apply(this,arguments);throw new TypeError("Cannot call a class as a function")}return e=o,(t=[{key:"render",value:function(){return l.a.createElement("div",{className:Y.a.answer},l.a.createElement("p",{className:C.a.text,dangerouslySetInnerHTML:{__html:this.props.answer.content}}),l.a.createElement("p",{className:C.a.subTitle},l.a.createElement(w.a,{id:"question.answeredBy"})," ",this.props.answer.name,","," ",l.a.createElement(G.FormattedDate,{value:this.props.answer.created})))}}])&&J(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),o}(l.a.Component),tt=n(71),et=n(961);function nt(t){return(nt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ot(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function rt(t,e){return(rt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function it(t){return(it=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var at=function(t){var e=o;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&rt(e,t);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,o=it(t);n=e?(n=it(this).constructor,Reflect.construct(o,arguments,n)):o.apply(this,arguments),o=this;if(n&&("object"===nt(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==o)return o;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(o);function o(){var t=this,e=o;if(t instanceof e)return n.apply(this,arguments);throw new TypeError("Cannot call a class as a function")}return e=o,(t=[{key:"render",value:function(){var t=tt.g+this.props.question.topicId,e=[],n=this.props.question.answers;console.log(n);for(var o=0;o<n.length;o++){var r=n[o];e.push(l.a.createElement(K,{answer:r,key:"answer_"+r.created}))}var i=0<this.props.question.name.length?this.props.question.name:this.props.question.username;return l.a.createElement(et.a,{className:y()(Q.a.question,C.a.padding),sx:{boxShadow:2}},l.a.createElement("span",{className:y()(Q.a.threadLink,C.a.text)},l.a.createElement("a",{href:t,target:"_blank"},l.a.createElement(w.a,{id:"question.viewThread"}))),l.a.createElement("p",{className:C.a.text,dangerouslySetInnerHTML:{__html:this.props.question.content}}),l.a.createElement("p",{className:C.a.subTitle},i,","," ",l.a.createElement(G.FormattedDate,{value:this.props.question.created})),e)}}])&&ot(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),o}(l.a.Component),st=(R=n(1035),n.n(R));function lt(t){return(lt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ct(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function ut(t,e){return(ut=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function pt(t){return(pt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var ft=function(t){var e=o;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ut(e,t);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,o=pt(t);n=e?(n=pt(this).constructor,Reflect.construct(o,arguments,n)):o.apply(this,arguments),o=this;if(n&&("object"===lt(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==o)return o;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(o);function o(t){var e;if(this instanceof o)return(e=n.call(this,t)).state={content:t.question.content},e;throw new TypeError("Cannot call a class as a function")}return e=o,(t=[{key:"save",value:function(){var t=this.textarea?this.textarea.value:"";this.props.saveQuestion(this.props.question,this.props.defaultTitle,t)}},{key:"cancel",value:function(){this.props.cancel()}},{key:"handleChange",value:function(t){var e=t.target instanceof HTMLTextAreaElement?t.target.value:"";this.setState((function(t,n){return{content:e}}))}},{key:"render",value:function(){var t=this;return l.a.createElement("div",{className:st.a.editorContainer},l.a.createElement("div",null,this.props.questionQuote),l.a.createElement("textarea",{className:st.a.textEditor,ref:function(e){return t.textarea=e},value:this.state.content,onChange:this.handleChange.bind(this)}),l.a.createElement("div",{className:H.a.buttonContainer},l.a.createElement("div",{className:H.a.save,onClick:this.save.bind(this)},l.a.createElement(w.a,{id:"annotation.save"})),l.a.createElement("div",{className:H.a.cancel,onClick:this.cancel.bind(this)},l.a.createElement(w.a,{id:"annotation.cancel"}))))}}])&&ct(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),o}(l.a.Component),dt=(R=n(1036),n.n(R));function ht(t){return(ht="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function mt(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function yt(t,e){return(yt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function gt(t){return(gt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var bt=function(t){var e=o;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&yt(e,t);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,o=gt(t);n=e?(n=gt(this).constructor,Reflect.construct(o,arguments,n)):o.apply(this,arguments),o=this;if(n&&("object"===ht(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==o)return o;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(o);function o(){var t=this,e=o;if(t instanceof e)return n.apply(this,arguments);throw new TypeError("Cannot call a class as a function")}return e=o,(t=[{key:"render",value:function(){return l.a.createElement("div",{className:y()(dt.a.loading,C.a.text)},l.a.createElement(g.a,{loaded:!1,scale:.25,position:"relative",top:"50%",left:"50%",lines:9,width:8,length:8,radius:14}),"Loading questions...")}}])&&mt(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),o}(l.a.Component),vt=(R=n(1037),n.n(R)),wt=n(957),xt=(R=n(1038),n.n(R));function St(t){return(St="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ot(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Et(t,e){return(Et=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Tt(t){return(Tt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var It=function(t){var e=o;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Et(e,t);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,o=Tt(t);n=e?(n=Tt(this).constructor,Reflect.construct(o,arguments,n)):o.apply(this,arguments),o=this;if(n&&("object"===St(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==o)return o;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(o);function o(){var t=this,e=o;if(t instanceof e)return n.apply(this,arguments);throw new TypeError("Cannot call a class as a function")}return e=o,(t=[{key:"delete",value:function(){this.props.delete&&this.props.delete(this.props.note)}},{key:"edit",value:function(){this.props.edit&&this.props.edit(this.props.note)}},{key:"render",value:function(){return l.a.createElement(et.a,{className:vt.a.note,sx:{boxShadow:2}},l.a.createElement("p",null,"Note:"),l.a.createElement("div",{className:vt.a.header},l.a.createElement("h4",{className:vt.a.info},this.props.note.creatorUser.name),this.props.delete&&l.a.createElement("div",{className:vt.a.delete,onClick:this.delete.bind(this)},l.a.createElement(wt.a,{"aria-label":"delete",size:"small"},l.a.createElement(xt.a,{fontSize:"inherit"})))),l.a.createElement("div",{className:vt.a.content,onClick:this.edit.bind(this)},this.props.note.content))}}])&&Ot(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),o}(l.a.Component),At=n(334);function jt(){return(jt=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n,o=arguments[e];for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])}return t}).apply(this,arguments)}function kt(t){return l.a.createElement("svg",jt({viewBox:"0 0 30 40",fill:"currentColor"},t),Pt,Ct,Rt)}var Pt=l.a.createElement("path",{d:"M3 0h24v15H3z"}),Ct=l.a.createElement("path",{stroke:"currentColor",strokeWidth:3,d:"M0 20h8M11 20h8M22 20h8"}),Rt=l.a.createElement("path",{d:"M3 25h24v15H3z"}),Bt=n(328),_t=(R=n(1039),n.n(R));function Wt(){return(Wt=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n,o=arguments[e];for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])}return t}).apply(this,arguments)}function Nt(t){return l.a.createElement("svg",Wt({viewBox:"0 0 24 24"},t),Lt,qt)}var Lt=l.a.createElement("path",{d:"M3 18h12v-2H3v2zM3 6v2h18V6H3zm0 7h18v-2H3v2z"}),qt=l.a.createElement("path",{fill:"none",d:"M0 0h24v24H0V0z"});function Dt(){return(Dt=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n,o=arguments[e];for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])}return t}).apply(this,arguments)}function Ht(t){return l.a.createElement("svg",Dt({viewBox:"0 0 24 24",fill:"currentColor"},t),zt,Mt)}var zt=l.a.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),Mt=l.a.createElement("path",{d:"M21 6h-2v9H6v2c0 .55.45 1 1 1h11l4 4V7c0-.55-.45-1-1-1zm-4 6V3c0-.55-.45-1-1-1H3c-.55 0-1 .45-1 1v14l4-4h10c.55 0 1-.45 1-1z"});function Vt(){return(Vt=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n,o=arguments[e];for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])}return t}).apply(this,arguments)}function Ft(t){return l.a.createElement("svg",Vt({viewBox:"0 0 512 512"},t),Ut)}var Ut=l.a.createElement("path",{d:"M497.9 142.1l-46.1 46.1c-4.7 4.7-12.3 4.7-17 0l-111-111c-4.7-4.7-4.7-12.3 0-17l46.1-46.1c18.7-18.7 49.1-18.7 67.9 0l60.1 60.1c18.8 18.7 18.8 49.1 0 67.9zM284.2 99.8L21.6 362.4.4 483.9c-2.9 16.4 11.4 30.6 27.8 27.8l121.5-21.3 262.6-262.6c4.7-4.7 4.7-12.3 0-17l-111-111c-4.8-4.7-12.4-4.7-17.1 0zM124.1 339.9c-5.5-5.5-5.5-14.3 0-19.8l154-154c5.5-5.5 14.3-5.5 19.8 0s5.5 14.3 0 19.8l-154 154c-5.5 5.5-14.3 5.5-19.8 0zM88 424h48v36.3l-64.5 11.3-31.1-31.1L51.7 376H88v48z"});function Qt(t){return(Qt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Yt(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Gt(t,e){return(Gt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function $t(t){return($t=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Jt=function(t){var e=o;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Gt(e,t);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,o=$t(t);n=e?(n=$t(this).constructor,Reflect.construct(o,arguments,n)):o.apply(this,arguments),o=this;if(n&&("object"===Qt(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==o)return o;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(o);function o(){if(this instanceof o)return n.call(this);throw new TypeError("Cannot call a class as a function")}return e=o,(t=[{key:"render",value:function(){var t=null!=this.props.addPageBreak,e=null!=this.props.addLineBreak;return l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:_t.a.header},l.a.createElement(At.a,{noBezel:!0,icon:l.a.createElement(Nt,{width:15,height:15,style:{fill:"#fff"}}),backgroundColor:"transparent",onClick:this.props.addNote,disabled:!this.props.addNote,align:"center",tooltipTitle:"Note",shortcut:"n"}),l.a.createElement(At.a,{noBezel:!0,icon:l.a.createElement(Ht,{width:15,height:15,style:{fill:"#fff"}}),onClick:this.props.addQuestion,disabled:!this.props.addQuestion,align:"left",backgroundColor:"transparent",tooltipTitle:"Question",shortcut:"q"}),l.a.createElement(At.a,{noBezel:!0,color:"#fff",fontSize:"".concat(15,"px"),icon:"¶",onClick:this.props.addLineBreak,disabled:!e,align:"left",backgroundColor:"transparent",tooltipTitle:"LineBreak",shortcut:"l"}),l.a.createElement(At.a,{noBezel:!0,icon:l.a.createElement(kt,{width:15,height:15,style:{fill:"#fff"}}),onClick:this.props.addPageBreak,disabled:!t,align:"left",backgroundColor:"transparent",tooltipTitle:"PageBreak",shortcut:"p"}),l.a.createElement(At.a,{onClick:this.props.editAnnotationHandler,backgroundColor:"transparent",noBezel:!0,icon:l.a.createElement(Ft,{width:15,height:15,style:{fill:"#fff"}}),tooltipTitle:"Edit",shortcut:"e"})))}}])&&Yt(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),o}(l.a.Component);function Zt(t){return(Zt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Xt(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Kt(t,e){return(Kt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function te(t){return(te=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}R=function(t){var e=o;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Kt(e,t);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,o=te(t);n=e?(n=te(this).constructor,Reflect.construct(o,arguments,n)):o.apply(this,arguments),o=this;if(n&&("object"===Zt(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==o)return o;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(o);function o(t){if(this instanceof o)return(t=n.call(this,t)).controls=null,t.arrow=null,t.arrowDs=null,t;throw new TypeError("Cannot call a class as a function")}return e=o,(t=[{key:"componentDidMount",value:function(){this.updatePosition()}},{key:"componentDidUpdate",value:function(){setTimeout(this.updatePosition.bind(this),0)}},{key:"updatePosition",value:function(){var t=this.getMeasurements();if(this.props.inline&&this.controls&&this.arrow&&t){var e=this.controls,n=e.offsetHeight,o=e.offsetWidth,r=this.arrow,i=t.bottomGap,a=i<0||n<i,s=t.top,l=t.viewPortWidth||0,c=t.left,u=c+t.width;if(r.style.display="none",this.props.selectedElementIds)for(var p=0,f=0,d=0;d<this.props.selectedElementIds.length;d++){var h,m,y=this.props.selectedElementIds[d];(y=document.getElementById(y))&&(m=(h=y.offsetLeft)+y.offsetWidth,h<p?(y.offsetTop,y.offsetHeight,c=h,u=f=m):f<m&&(f=m),h<c&&(c=h),u<m&&(u=m),p=h)}var g=u-c,b=3,v=!1,w=0;(v=!a&&i<n||v)?(r.className=C.a.arrowLeft,b=c-o-r.offsetWidth<0?4:2):(c-(a=o/2-g/2)<0&&(w=Math.abs(c-a)),l<u+a&&(w=l-(u+a))),3===b?(a=l=0,this.arrow&&(this.arrow.className=C.a.arrowTop,a=o/2-this.arrow.offsetWidth/2-w,this.arrow.style.left=(a=a<0?0:a)+"px",l=this.arrow.offsetHeight,this.arrow.style.top=0-l+"px"),e.style.top=s+t.height+l+"px",e.style.left=c+g/2-o/2+w+"px"):v?(r.className=C.a.arrowRight,a=r.offsetHeight,l=t.top+t.height/2-a/2,t.top+t.height+i-l<n&&(l=t.top+t.height+i-n),2===b?(r.style.left=o-2+"px",e.style.left=c-o-r.offsetWidth+"px"):(r.className=C.a.arrowLeft,r.style.left=-r.offsetWidth+"px",e.style.left=c+g+r.offsetWidth+"px"),r.style.top=t.top-l+t.height/2-a/2+"px",e.style.top=l+"px"):e.style.top=s+"px"}}},{key:"getMeasurements",value:function(){if(!this.props.selectedElementIds)return null;var t=this.props.selectedElementIds[this.props.selectedElementIds.length-1],e=(t=document.getElementById(t),this.props.selectedElementIds[0]),n=(e=document.getElementById(e),this.props.splitTextRect),o=0;if(this.props.list&&this.props.list.Grid.state.scrollTop,this.props.pechaImageClass&&(o=document.getElementsByClassName(this.props.pechaImageClass)[0].offsetHeight),!t)return console.warn("no valid element found in getMeasurements, elementId: %s",this.props.selectedElementId),{top:0,textTop:0,rowTop:0,left:0,width:1,height:1,topGap:0,bottomGap:0,viewPortWidth:1};o=t.offsetTop+o;var r=t.offsetTop,i=t.offsetLeft,a=t.offsetWidth,s=t.offsetHeight,l=o,c=null,u=0,p=0;return t&&n&&(t=t.getBoundingClientRect(),p=n.height+n.top-t.bottom,c=n.width),e&&n&&(t=e.getBoundingClientRect(),u=n.height-t.top),{top:o,textTop:r,rowTop:l,left:i,width:a,height:s,topGap:u,bottomGap:p,viewPortWidth:c}}},{key:"render",value:function(){var t,e,n=this,o=this.props,r=[],i=[],a=null,l=null,u=o.user.isLoggedIn||!1,p=!1,f=(o.activeAnnotation&&(o.activeAnnotation.isType(c.a.pageBreak)||o.activeAnnotation.isType(c.a.lineBreak))&&(p=!0),o.annotationsData?(o.annotationsData.map((function(t){var e,a=!1,l=!1;t.isTemporary?l=a=!0:o.temporaryAnnotation||t.annotation.uniqueId!=o.activeAnnotation.uniqueId||(l=!0),a?(e=s.createElement(k,{annotationData:t,key:t.annotation.uniqueId,isActive:l,saveAnnotationHandler:function(e){o.saveAnnotation(t.annotation,e)},cancelAnnotationHandler:function(){o.cancelEditAnnotation(t.annotation)},isLoggedIn:u,selectAnnotationHandler:function(){},editAnnotationHandler:function(){}}),i.push(e)):(e=s.createElement(j,{isWorkingSection:!1,fontSize:o.fontSize,annotationData:t,key:t.annotation.uniqueId,isActive:l,selectAnnotationHandler:function(){u&&!a&&o.didSelectAnnotation(t.annotation)},editAnnotationHandler:function(){u&&!a&&(n.annotation=t.annotation,o.editAnnotation(t.annotation))},isLoggedIn:u}),r.push(e))}),this),1==!o.user.isLoggedIn&&(a=s.createElement("div",{className:C.a.anonymousMessage,style:{position:"relative",width:"fit-content",border:"1px solid gray",paddingInline:10}},s.createElement(w.a,{id:"annotations.loginMessage",values:{loginLink:s.createElement(s.Fragment,null,s.createElement(w.a,{id:"annotations.loginLink"}))}})))):l=s.createElement("div",{className:C.a.nothingSelected},"Nothing Selected"),null),d=!this.props.selectedWitness.isWorking,h=null,m=!this.props.selectedWitness.isWorking,g=(u&&!this.props.selectedWitness.isWorking&&(t=[],e=[],this.props.availableAnnotations&&(t=this.props.availableAnnotations.filter((function(t){return t.type===c.a.pageBreak&&t.creatorWitness.id===n.props.selectedWitness.id})),e=this.props.availableAnnotations.filter((function(t){return t.type===c.a.lineBreak&&t.creatorWitness.id===n.props.selectedWitness.id}))),0<t.length&&(f=s.createElement("div",{className:C.a.breakButtons},s.createElement(At.a,{title:"Page Break",accessoryType:"DELETE",icon:s.createElement(kt,{width:20,height:20}),onClick:function(){n.props.deleteAnnotation(t[0])},isActive:!0,backgroundColor:I.a.activeButton})),d=!1),0<e.length&&(h=s.createElement("div",{className:C.a.breakButtons},s.createElement(At.a,{title:"Line Break",accessoryType:"DELETE",icon:"¶",onClick:function(){n.props.deleteAnnotation(e[0])},isActive:!0,backgroundColor:I.a.activeButton})),m=!1),(m=!!d&&m)||(d=!1)),null),b={},v=(o.temporaryNotes&&0<o.temporaryNotes.length&&(g=o.temporaryNotes.map((function(t){var e="NOTE_"+t.uniqueId;return t.basedOn&&(b[t.basedOn.uniqueId]=t.uniqueId),s.createElement(U,{note:t,key:e,saveNote:o.saveAnnotation,cancel:function(){return o.cancelEditAnnotation(t)}})}))),null),x=(o.notes&&0<o.notes.length&&(v=o.notes.filter((function(t){return!b.hasOwnProperty(t.uniqueId)})).map((function(t){var e="NOTE_"+t.uniqueId;return s.createElement(It,{note:t,key:e,delete:n.props.deleteAnnotation,edit:n.props.editNote})}))),null),S={},O=(o.temporaryQuestions&&0<o.temporaryQuestions.length&&o.questionQuote&&(x=o.temporaryQuestions.map((function(t){S[t.uniqueId]=t.uniqueId;var e="QUESTION_"+t.uniqueId;return s.createElement(ft,{question:t,questionQuote:o.questionQuote,defaultTitle:o.selectedWitness.text.name,key:e,saveQuestion:o.saveQuestion,cancel:function(){return o.cancelEditAnnotation(t)}})}))),[]),E=!1;if(o.questions&&0<o.questions.length){for(var T=[],A=0;A<o.questions.length;A++){var P=o.questions[A];!S.hasOwnProperty(P.uniqueId)&&o.questionsData.hasOwnProperty(P.uniqueId)&&(o.questionsData[P.uniqueId].loading&&(E=!0),T=T.concat(o.questionsData[P.uniqueId].questions))}O=T.map((function(t){return t.annotationUniqueId,s.createElement(at,{question:t,key:"question_"+t.annotationUniqueId})}))}var R=null,B=(0<O.length&&(R=s.createElement("h3",{className:C.a.sectionHeading},"Questions")),null),_=(E&&(B=s.createElement(bt,null)),0===o.questions.length&&0===o.temporaryQuestions.length),W=[C.a.annotationControls],N=(o.inline&&W.push(C.a.inline),!0);return(a||p)&&(N=!1),s.createElement("div",{className:y.a.apply(void 0,W),ref:function(t){return n.controls=t}},N&&s.createElement(Jt,{addPageBreak:d?o.addPageBreak:null,addLineBreak:m?o.addLineBreak:null,addNote:u&&!g?function(){return o.addNote()}:null,addQuestion:_?o.addQuestion:null,closeAnnotation:o.closeAnnotation,editAnnotationHandler:function(){var t=document.getElementById("editBtn");null!=t&&t.click()},userLoggedIn:u}),s.createElement("div",{className:C.a.annotationContent},a,l,!p&&i,!p&&r,f,h,g,v,R,x,B,O),s.createElement("div",{className:C.a.arrow,ref:function(t){return n.arrow=t}}))}}])&&Xt(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),o}(s.Component),R=s.memo(R);var ee=n(231),ne=n(8),oe=n(3),re=n(966),ie=n(991),ae=n.n(ie);function se(t,e){var n,o=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,n)),o}function le(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?se(Object(n),!0).forEach((function(e){var o,r;o=t,r=n[e=e],e in o?Object.defineProperty(o,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):o[e]=r})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):se(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function ce(t){return function(t){if(Array.isArray(t))return fe(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||pe(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ue(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var o,r,i=[],a=!0,s=!1;try{for(n=n.call(t);!(a=(o=n.next()).done)&&(i.push(o.value),!e||i.length!==e);a=!0);}catch(t){s=!0,r=t}finally{try{a||null==n.return||n.return()}finally{if(s)throw r}}return i}}(t,e)||pe(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function pe(t,e){if(t){if("string"==typeof t)return fe(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?fe(t,e):void 0}}function fe(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}function de(t,e,n,o){var r=[],i=e.filter((function(t){return t.isWorking||t.isBase})).map((function(t){return t.name}));if(t){for(var a={},s=0;s<t.length;s++)!function(e){var n=t[e];e=n.content+n.start;n.isTemporary?(a[he]={name:n.getSourceName(),content:n.content,id:n.uniqueId,isTemporary:!0,annotation:n},i=i.filter((function(t){return t!==n.getSourceName()})),e=he):i=a[e]?(a[e].name+=" "+Object(ee.a)(n.getSourceName()),i.filter((function(t){return t!==n.getSourceName()}))):(a[e]={name:Object(ee.a)(n.getSourceName()),content:n.content,id:n.uniqueId,userCreated:n.userCreated,annotation:n},i.filter((function(t){return t!==n.getSourceName()}))),!n.userCreated&&n.creatorWitness.isWorking?a[e].isWorking=!0:a[e].isWorking=!1}(s);i.unshift(n);var l=i;"བྱང་ཆུབ་སེམས་དཔའི་སྤྱོད་པ་ལ་འཇུག་པ་བཞུགས་སོ།"!==(null==o?void 0:o.name)&&(l=i.filter((function(t){return"Dominant"!==t}))),r=Object.keys(a).reduce((function(t,e){return(e=a[e]).isWorking&&(e.name=l.reduce((function(t,e){return t+" "+Object(ee.a)(e,";")}),"")),t.push(e),t}),[])}return r}var he=-3,me=Object(o.connect)((function(t,e){var n=ne.jb(t),o=ne.I(t),r=e.activeAnnotation,a=e.inline,s=ne.K(t);if(s||o&&(s=ne.pb(t,o.id)),!r||!s)return{annotationsData:null,activeAnnotation:null,baseAnnotation:null,availableAnnotations:null,user:n,temporaryAnnotation:null,inline:null,firstSelectedSegment:null,splitTextRect:null,selectedWitness:null};var u=function(t,e,n,o,r){return 0<(t=ne.U(t,n.id,o,r,e)).length?t[0]:null}(t,c.a.variant,s,r.start,r.length),p=function(t,e,n,o){var r=[];n&&e.naturalId===n.naturalId||r.push(e),n&&r.push(n);var a=(s=ue(t.getPositionOfAnnotation(e),2))[0],s=s[1];if(a){s=a+s;var l,u=[];e.isInsertion?((l=o["i"+a])&&(u=u.concat(l)),(l=o[String(a)])&&(u=u.concat(l))):((l=o[String(a)])&&(u=l),(a=o[String(s)])&&(u=u.concat(a)));for(var p=0;p<u.length;p++){var f=u[p];f.start===e.start&&f.length===e.length?n&&f.naturalId===n.naturalId||r.push(f):t.activeWitness.isWorking||f.type!==c.a.pageBreak&&f.type!==c.a.lineBreak||r.push(f)}r=i()(r,(function(t,e){return t.id===e.id}))}return r}(e.annotatedText,r,u,e.annotationPositions),f=de(f=p.filter((function(t){return t.type===c.a.variant})),m=ne.Q(t),E=ne.ib(t,"annotation.workingEdition","Working"),o),d=(o=null,r.id==h.a?o=r:(T=(d=ue(e.annotatedText.getPositionOfAnnotation(r),2))[0],d=d[1],f=null===T||null===d?null:(T=de([o=e.annotatedText.getBaseAnnotation(T,d)],m,E),[].concat(ce(T),ce(f)))),f&&f.sort((function(t,e){return t.isTemporary?-1:e.isTemporary?1:t.userCreated?-1:!e.userCreated&&t.annotation.id&&e.annotation.id?t.annotation.id-e.annotation.id:1})),p.filter((function(t){return t.type===c.a.note}))),m=ne.U(t,s.id,r.start,r.length,c.a.note),y=p.filter((function(t){return t.type===c.a.question})),g={};if(0<y.length)for(var b=0;b<y.length;b++){var v=y[b],w=(g[v.uniqueId]={},ne.zb(t,v));w=(g[v.uniqueId].loading=w,ne.w(t,v.uniqueId));g[v.uniqueId].questions=w}var x,S,O,E,T=null,I=(0<(E=ne.U(t,s.id,r.start,r.length,c.a.question)).length&&(I=E[0],S=(I=ue(e.annotatedText.getPositionOfAnnotation(I),2))[0],I=I[1],S&&(I=(S=ue(e.annotatedText.segmentedText.extractTextAroundPosition(S,I=I||S+1,["།"," "]),3))[0],x=S[1],S=S[2],O=document.location.href,T=l.a.createElement("blockquote",null,I,l.a.createElement("a",{href:O},x),S))),Object(ne.Z)(t));return{annotationsData:f,activeAnnotation:r,baseAnnotation:o,availableAnnotations:p,user:n,temporaryAnnotation:u,inline:a,firstSelectedSegment:e.firstSelectedSegment,splitTextRect:e.splitTextRect,selectedWitness:s,notes:d,temporaryNotes:m,questions:y,temporaryQuestions:E,questionsData:g,questionQuote:T,fontSize:I}}),null,(function(t,e,n){var o=e.dispatch;if(0<t.questions.length)for(var r=0;r<t.questions.length;r++){var i=t.questions[r],a=!0;(a=(!t.questionsData.hasOwnProperty(i.uniqueId)||!(0<t.questionsData[i.uniqueId].questions.length||t.questionsData[i.uniqueId].loading))&&a)&&o(new oe.nc(i))}function s(e){var r=1<arguments.length&&void 0!==arguments[1]&&arguments[1];return function(){var i=n.activeAnnotation,a=(i=new c.c(null,i.witness,i.end+1,0,null,e,t.selectedWitness,t.user),ne.d(t.selectedWitness)),s=[];s.push(oe.gc(i)),s.push(oe.Ib(i.uniqueId,a)),r?s.push(oe.Yb(i)):s.push(oe.Yb(null)),o(Object(v.batchActions)(s))}}function l(e,n){var r,i,a;e.isTemporary?(r=t.selectedWitness,r=ne.d(r),(n=new c.c(e.id,e.witness,e.start,e.length,n,e.type,e.creatorWitness,t.user,e.uniqueId,e.basedOn)).isSaved=e.isSaved,i=[],a=null,a=n.isSaved?oe.Zc:oe.gc,i.push(a(n)),i.push(oe.Hc(e)),i.push(oe.Ib(n.uniqueId,r)),n.type===c.a.variant&&i.push(oe.Yb(n)),o(Object(v.batchActions)(i))):console.warn("Tried to save a non-temporary annotation: %o",e)}return le(le(le({},t),n),{},{closeAnnotation:function(){var e;t.activeAnnotation&&(e=oe.Yb(null),o(e))},didSelectAnnotation:function(e){var n=e.id==h.a?t.baseAnnotation:b()(t.availableAnnotations,(function(t){return t.uniqueId==e.uniqueId}))||null,r=[],i=t.selectedWitness,a=ne.d(i);e.uniqueId!=t.activeAnnotation.uniqueId&&(i.isWorking?(e.id!=h.a&&r.push(oe.Ib(n.uniqueId,a)),t.activeAnnotation.id!=h.a&&r.push(oe.Fc(t.activeAnnotation.uniqueId,a))):t.activeAnnotation.creatorWitness.id===i.id?(r.push(oe.Gc(t.activeAnnotation.uniqueId,a)),n.id!==h.a&&r.push(oe.Ib(n.uniqueId,a))):(n.creatorWitness.id===i.id?r.push(oe.Jb(n.uniqueId,a)):n.id!==h.a&&r.push(oe.Ib(n.uniqueId,a)),t.activeAnnotation.id!==h.a&&r.push(oe.Fc(t.activeAnnotation.uniqueId,a))),r.push(oe.Yb(n)),o(Object(v.batchActions)(r)))},editAnnotation:function(e){var n=e.isWorkingAnnotation||e.userCreated||e.id===h.a?null:e;n=new c.b(n,e.witness,e.start,e.length,e.content,e.type,t.selectedWitness,t.user);e.userCreated&&(n.uniqueId=e.uniqueId,n.isSaved=e.isSaved),o(oe.Hb(n,!0))},saveAnnotation:l,cancelEditAnnotation:function(t){var e;t.isTemporary?(e=oe.Hc(t),o(e)):console.warn("Tried to call cancelEditAnnotation on a non-temporary annotation: %o",t)},deleteAnnotation:function(e){var n=t.selectedWitness,r=ne.d(n),i=[];i=e.userCreated?[oe.ic(e,n),oe.Fc(e.uniqueId,r)]:[oe.Gc(e.uniqueId,r)],t.activeAnnotation.uniqueId===e.uniqueId&&i.push(oe.Yb(null)),o(Object(v.batchActions)(i))},addNote:function(){var e=n.activeAnnotation;e=new c.b(null,e.witness,e.start,e.length,"",c.a.note,t.selectedWitness,t.user);o(oe.Hb(e,!0))},editNote:function(e){e=new c.b(e,e.witness,e.start,e.length,e.content,c.a.note,t.selectedWitness,t.user),o(oe.Hb(e,!0))},addPageBreak:s(c.a.pageBreak),addLineBreak:s(c.a.lineBreak),addQuestion:function(){var e=n.activeAnnotation;e=new c.b(null,e.witness,e.start,e.length,"",c.a.question,t.selectedWitness,t.user);o(oe.Hb(e,!0))},saveQuestion:function(e,r,i){var a=((a=ue(n.annotatedText.getPositionOfAnnotation(e),2))[0],a[1],ae.a.renderToStaticMarkup(t.questionQuote)+i);l(e,i),i=oe.hc(e,r,a);o(i)}})}))(R),ye=n(333);function ge(t){return function(t){if(Array.isArray(t))return be(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return be(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?be(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function be(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}n(178);ie=n(1042);var ve=n.n(ie),we=(R=n(217),n.n(R)),xe=(ie=n(277),n.n(ie)),Se=(R=n(326),n.n(R)),Oe=(ie=n(1043),n.n(ie)),Ee=(R=n(91),n.n(R)),Te=(ie=n(1044),n.n(ie)),Ie=n(949),Ae=Object(s.memo)(Object(m.c)((function(t){var e=[],n="",o="",r=[];return t.witnesses&&t.activeWitness&&(o=t.witnesses.findIndex((function(e){return e.id===t.activeWitness.id})),(e=t.witnesses.map((function(t){return t}))).sort((function(t,e){return t.isWorking?-1:e.isWorking?1:t.isBase?-1:e.isBase?1:0})),e=e.sort((function(t,e){return t.id-e.id}))),0===e.length?null:l.a.createElement(Ie.a,{onChange:function(n){Ee()(e)||t.onSelectedWitness(e[n.target.value])},className:Te.a.selectVersion,value:o,label:"Version",classes:{root:Te.a.selectEmpty,select:Te.a.selectOptions}},e.map((function(e,o){return e.id===t.activeWitness.id&&r.push(Te.a.selected),n=e.source.name,e.isWorking&&(n="en"===t.intl.locale?"User"===(null==(e=t.user)?void 0:e.name)?"Working":"My Edition":"མཉམ་འབྲེལ་པར་མ།"),l.a.createElement("option",{key:"versionSelect-".concat(o),value:o,className:Te.a.selectOptions},n)})))}))),je=n(968),ke=(R=n(1045),n.n(R)),Pe=n(950),Ce=n(956),Re=n(959),Be=n(942),_e=n(952);function We(t){return function(t){if(Array.isArray(t))return qe(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||Le(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ne(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var o,r,i=[],a=!0,s=!1;try{for(n=n.call(t);!(a=(o=n.next()).done)&&(i.push(o.value),!e||i.length!==e);a=!0);}catch(t){s=!0,r=t}finally{try{a||null==n.return||n.return()}finally{if(s)throw r}}return i}}(t,e)||Le(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Le(t,e){if(t){if("string"==typeof t)return qe(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?qe(t,e):void 0}}function qe(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}ie=l.a.memo((function(t){var e=Object(s.useRef)(t.texts),n=(c=Ne(Object(s.useState)(e.current),2))[0],o=c[1],r=(c=Ne(Object(s.useState)(null),2))[0],i=c[1],a=t.onSelectedText,c=t.selectedText,u=(t=Ne(Object(s.useState)(!1),2))[0],p=t[1],f=(t=null==c?void 0:c.name,Object(s.useRef)(new je.c({fixedHeight:!0,defaultHeight:40}))),d=[ke.a.textlist];return Object(s.useEffect)((function(){var t;""===r&&o(We(e.current)),null!==r&&""!==r&&(t=e.current.filter((function(t){return t.name.includes(r)})),o(We(t)))}),[r]),l.a.createElement(Pe.a,{onClickAway:function(){return p(!1)}},l.a.createElement("div",{style:{position:"relative",marginLeft:10}},l.a.createElement(Ce.a,{onClick:function(){p((function(t){return!t})),!1===u&&d.push(ke.a.open)},component:"div",variant:"outlined",sx:{overflow:"hidden",textOverflow:"ellipsis",width:"10rem",height:"100%",color:"text.primary"}},l.a.createElement(Re.a,{noWrap:!0},t)),l.a.createElement(Be.a,{in:u},l.a.createElement(et.a,{className:y()(d),sx:{position:"absolute",bgcolor:"heading.main",zIndex:1}},l.a.createElement(_e.a,{onChange:function(t){t=t.target.value,i(t)},id:"standard-basic",label:"filter",variant:"standard",style:{width:"100%"}}),l.a.createElement(je.a,null,(function(t){var e=t.width;t=t.height;return l.a.createElement(je.d,{width:e,height:t,rowHeight:40,deferredMeasurementCache:f.current,rowCount:n.length,rowRenderer:function(t){var e=t.key,o=t.index,r=t.style,i=(t=t.parent,n[o]);return l.a.createElement(je.b,{key:"optionvalues-".concat(e),cache:f.current,parent:t,columnIndex:0,rowIndex:o},l.a.createElement("div",{style:r,onClick:function(){p(!1),a(i)}},l.a.createElement(et.a,{sx:{overflow:"hidden",textOverflow:"ellipsis",width:"13rem",paddingLeft:2,fontSize:{lg:12,md:11,sm:10,xs:10},color:"text.primary"},component:"div"},l.a.createElement(Re.a,{noWrap:!0},Object(ee.a)(i.name)))))}})}))))))})),n(16),m=Object(o.connect)((function(t){return{texts:ne.gb(t),selectedText:ne.I(t)}}),(function(t){return{onSelectedText:function(e){t(oe.Oc(e))}}}))(ie);var De=l.a.memo(m),He=(R=n(987),n.n(R)),ze=n(945),Me=n(1059),Ve=n(943),Fe=n(965),Ue=(ie=n(986),n.n(ie));function Qe(t){t=t.isSecondWindowOpen;var e=Object(s.useCallback)((function(){var t=document.getElementById("updateList");t&&t.click()}),[t]);return Object(s.useEffect)((function(){var t=setTimeout((function(){e()}),500);return function(){return clearTimeout(t)}}),[t]),l.a.createElement(wt.a,{variant:"text",size:"small",onClick:e},l.a.createElement(Ue.a,null))}m=n(971);var Ye=n.n(m);function Ge(t){return t=t.handleWindowSearch,l.a.createElement(wt.a,{size:"small",variant:"text",onClick:t},l.a.createElement(Ye.a,null))}n(1046),R=n(4),ie=n(458),n(955),m=n(1061),n(891),Object(R.a)(m.a)((function(t){return{"&.Mui-selected, &.Mui-selected:hover":{color:"white",backgroundColor:t.selectedcolor}}})),Object(ie.a)({palette:{text:{primary:"#00398e"}}});var $e=n(974),Je=n(970),Ze=n(330),Xe=n(963),Ke=n(958);function tn(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var o,r,i=[],a=!0,s=!1;try{for(n=n.call(t);!(a=(o=n.next()).done)&&(i.push(o.value),!e||i.length!==e);a=!0);}catch(t){s=!0,r=t}finally{try{a||null==n.return||n.return()}finally{if(s)throw r}}return i}}(t,e)||function(t,e){if(t){if("string"==typeof t)return en(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?en(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function en(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}function nn(t){var e=tn(Object(s.useState)(!1),2),n=e[0],o=e[1],r=(e=tn(Object(Ze.a)("WindowOneFont","Tibetan"),2))[0],i=e[1];return Object(s.useEffect)((function(){document.body.style.setProperty("--tibetan-fonts",r)}),[]),l.a.createElement(Pe.a,{onClickAway:function(){return o(!1)}},l.a.createElement(et.a,{position:"relative"},l.a.createElement(wt.a,{onClick:function(){o((function(t){return!t}))},size:"small",variant:"text"},l.a.createElement($e.a,{height:20,width:20,fill:"currentColor"})),l.a.createElement(Be.a,{in:n},l.a.createElement(Xe.a,{dense:!0,sx:{position:"absolute",right:0,zIndex:2,top:40,bgcolor:"heading.main"}},l.a.createElement(Je.a,{max:20,min:7,initialvalue:t.textFontSize,changeSize:t.onChangedFontSize}),l.a.createElement(Ve.a,null),l.a.createElement(on,{selectFont:function(t){i(t),document.body.style.setProperty("--tibetan-fonts","".concat(t));var e=document.getElementById("updateList"),n=1,r=setInterval((function(){e.click(),3<++n&&clearInterval(r)}),800);o(!1)},selectedfont:r}),l.a.createElement(Ke.a,{onClick:function(){return t.onExport()}},l.a.createElement(Re.a,{variant:"subtitle2"},"Export Document"))))))}var on=function(t){var e=t.selectFont,n=(t=t.selectedfont,tt.c||[]);return l.a.createElement(et.a,{textAlign:"center"},l.a.createElement("span",null,"Font:")," ",l.a.createElement("select",{onChange:function(t){return e(t.target.value)},value:t},n.map((function(t,e){return l.a.createElement("option",{key:e+"-fontselect",value:t},t)}))))},rn=(m=n(985),n.n(m)),an=(ie=n(984),n.n(ie));function sn(t){var e=t.changeShowTableContent,n=t.showTableContent;return l.a.createElement(l.a.Fragment,null,l.a.createElement(wt.a,{onClick:function(){e(!n)}},n?l.a.createElement(an.a,null):l.a.createElement(rn.a,null)))}m=n(327);var ln=n.n(m),cn=(ie=n(331),n.n(ie));function un(t){return(un="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function pn(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function fn(t,e){return(fn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function dn(t){return(dn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var hn=function(t){var e=o;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&fn(e,t);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,o=dn(t);n=e?(n=dn(this).constructor,Reflect.construct(o,arguments,n)):o.apply(this,arguments),o=this;if(n&&("object"===un(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==o)return o;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(o);function o(t){if(this instanceof o)return n.call(this,t);throw new TypeError("Cannot call a class as a function")}return e=o,(t=[{key:"render",value:function(){var t=this,e=this.props.string,n=e,o=this.props.stringClass||"";if(this.props.searchTerm){var r=this.props.searchTerm,i=(new ln.a).splitGraphemes(e),a=e.indexOf(r),l=a+r.length,c=0,u="";if(-1<a)for(var p=0;p<i.length;p++){var f=i[p];a<=c&&c<l&&(u+=f),c+=f.length}0<u.length&&(n=cn()(e,u,(function(e,n){return s.createElement("span",{className:t.props.highlightClass,key:"highlight-".concat(n)},e)})))}return s.createElement("span",{className:o},n)}}])&&pn(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),o}(s.Component),mn=(m=n(1047),n.n(m));function yn(t){function e(t){var e=t.key,i=t.index,s=t.parent,c=(t=t.style,r[i]);return l.a.createElement(je.b,{key:"listkeys2-".concat(e),cache:a.current,parent:s,columnIndex:0,rowIndex:i},l.a.createElement("div",{style:t},0<r.length&&l.a.createElement("div",{className:mn.a.searchListItem,onClick:function(){return n(c[0])}},l.a.createElement(hn,{string:c[1],highlightClass:mn.a.highlight,searchTerm:o}))))}var n=t.handleListItemClick,o=t.searchValue,r=t.results,i=(t.selectedText,Object(s.useRef)()),a=Object(s.useRef)(new je.c({fixedWidth:!0,defaultHeight:100}));return r?l.a.createElement(l.a.Fragment,null,l.a.createElement(je.a,null,(function(t){var n=t.height;t=t.width;return l.a.createElement(je.d,{ref:i,height:n,rowCount:null==r?void 0:r.length,rowHeight:a.current.rowHeight,deferredMeasurementCache:a.current,rowRenderer:e,width:t,overscanRowCount:1})}))):null}function gn(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var o,r,i=[],a=!0,s=!1;try{for(n=n.call(t);!(a=(o=n.next()).done)&&(i.push(o.value),!e||i.length!==e);a=!0);}catch(t){s=!0,r=t}finally{try{a||null==n.return||n.return()}finally{if(s)throw r}}return i}}(t,e)||function(t,e){if(t){if("string"==typeof t)return bn(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?bn(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function bn(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}function vn(t,e){var n,o=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,n)),o}function wn(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?vn(Object(n),!0).forEach((function(e){xn(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):vn(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function xn(t,e,n){e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n}ie=l.a.memo((function(t){var e=(c=gn(Object(s.useState)(""),2))[0],n=c[1],o=(c=gn(Object(s.useState)(!1),2))[0],r=c[1],i=(c=gn(Object(s.useState)(!1),2))[0],a=c[1],c=Object(s.useRef)(),u=Object(s.useRef)(),p=l.a.useRef(Se()((function(e){t.searchChanged(e)}),1e3)).current,f=Object(s.useCallback)((function(t){t.preventDefault(),p(e),a(!0)}),[e]),d=Object(s.useCallback)((function(){!1===o&&p(null),r(!o)}),[o]),h=(Object(s.useEffect)((function(){!0===o&&u.current.focus(),!1===o&&p(null)}),[o]),Object(s.useCallback)((function(){a(!1),p(null),n("")}),[])),m=Object(s.useMemo)((function(){return xe()(t.searchResults)&&t.searchResults.hasOwnProperty(t.selectedText.id)}),[t.searchResults,t.selectedText]),y=m?t.searchResults[t.selectedText.id].results:[];return l.a.createElement(ze.a,{ref:c,direction:"column",spacing:1,sx:{paddingInline:{md:1,xs:0},paddingBlock:{md:1,xs:0},bgcolor:"heading.main",color:"text.primary"}},l.a.createElement(ze.a,{direction:"row",spacing:1,justifyContent:"space-between"},l.a.createElement(et.a,{sx:{display:"flex",gap:{md:2,sx:0},flexDirection:{md:"row",xs:"column"}}},l.a.createElement(De,null),l.a.createElement(Ae,{witnesses:t.witnesses,activeWitness:t.selectedWitness,onSelectedWitness:t.onSelectedWitness,user:t.user})),l.a.createElement(Me.a,{size:"small",sx:{position:"relative",display:"flex",height:"fit-content",alignItems:"center",justifyContent:"center",width:"fit-content",border:function(t){return"1px solid ".concat(t.palette.divider)},borderRadius:1,bgcolor:"background.paper",color:"text.secondary","& svg":{m:1},"& hr":{mx:.5}},className:Oe.a.button_group_menu},l.a.createElement(Qe,{isSecondWindowOpen:t.isSecondWindowOpen}),l.a.createElement(Ve.a,{orientation:"vertical",variant:"middle",flexItem:!0}),l.a.createElement(Ge,{handleWindowSearch:d}),l.a.createElement(nn,{textFontSize:t.textFontSize,onChangedFontSize:t.onChangedFontSize,onExport:t.onExport,isPanelLinked:t.isPanelLinked}),l.a.createElement(sn,{changeShowTableContent:t.changeShowTableContent,showTableContent:t.showTableContent}))),l.a.createElement(Fe.a,{in:o},l.a.createElement("form",{onSubmit:f},l.a.createElement(ze.a,{direction:"row",spacing:2,position:"relative"},l.a.createElement(_e.a,{hiddenLabel:!0,id:"filled-hidden-label-small",inputProps:{style:{height:25,padding:"0 14px"}},style:{height:25,flex:1},fullWidth:!0,inputRef:u,value:e,onChange:function(t){return n(t.target.value)}}),l.a.createElement(Ce.a,{variant:"outlined",size:"small",onClick:f,style:{height:25}},"Search"),t.searchResults&&i&&l.a.createElement(et.a,{sx:((c="boxShadow")in(f={position:"absolute",top:35,right:0,zIndex:1,bgcolor:"heading.main",height:350,width:350,boxShadow:d=3,overflowX:"hidden"})?Object.defineProperty(f,c,{value:d,enumerable:!0,configurable:!0,writable:!0}):f[c]=d,f)},0===y.length&&l.a.createElement("p",null,"no such word present"),m&&0<y.length&&l.a.createElement(yn,{handleListItemClick:function(e){t.changeSelectSyncId(e)},searchValue:t.searchValue,results:y,selectedText:t.selectedText}),l.a.createElement(wt.a,{"aria-label":"closeButton",onClick:h,size:"small",sx:{right:15,top:0,position:"absolute"}},l.a.createElement(He.a,{fontSize:"inherit"})))))))}));var Sn=Object(o.connect)((function(t){var e,n,o=ne.I(t),r=ne.J(t),i=[],a=!1,s=(o&&(i=ne.eb(t,o.id),(s=ne.L(t,o.id))?(e=ne.lb(t,s),a=ne.p(t,s)):e=ne.pb(t,o.id)),r&&(n=(s=ne.M(t,r.id))?ne.mb(t,s):ne.qb(t,r.id)),ne.Z(t)),l=ne.B(t);return{witnesses:i,selectedText:o,selectedText2:r,selectedWitness:e,selectedWitness2:n,textListIsVisible:Object(ne.bb)(t),accountOverlayVisible:Object(ne.e)(t),textFontSize:s,isSecondWindowOpen:ne.yb(t),exportingWitness:a,user:ne.jb(t),isAnnotating:ne.ub(t),searchValue:l,showTableContent:ne.O(t),searchResults:ne.z(t,l)}}),null,(function(t,e,n){var o=e.dispatch,r=t.selectedText;return wn(wn(wn({},n),t),{},(xn(n={navigationButtonClicked:function(){e.dispatch(oe.ec(!t.textListIsVisible))},onSelectedWitness:function(t){o(oe.Qc(null==r?void 0:r.id,null==t?void 0:t.id))},onChangedFontSize:function(t){o(oe.cc(t))},onChangeWindowOpen:function(t,e){o(oe.Xc(t,e))},onExport:function(){o(oe.jc(t.selectedWitness.id,"docx"))}},"navigationButtonClicked",(function(){o(oe.ec(!t.textListIsVisible))})),xn(n,"changeIsAnnotating",(function(t){o(oe.Mb(t)),!1===t&&(t=oe.Yb(null),o(t),o(oe.Yb(null)))})),xn(n,"searchChanged",(function(t){o(oe.Zb(t))})),xn(n,"changeShowTableContent",(function(t){o(oe.Vc(t))})),xn(n,"changeSelectSyncId",(function(t){o(oe.Tb(t))})),n))}))(ie),On=n(947),En=(m=n(1048),n.n(m)),Tn=n(881),In=(ie=n(62),n(1060));function An(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var jn=Object(R.a)("div")((function(t){return An({position:"relative",borderRadius:(t=t.theme).shape.borderRadius,backgroundColor:Object(Tn.a)(t.palette.common.white,.15),"&:hover":{backgroundColor:Object(Tn.a)(t.palette.common.white,.25)},marginLeft:0,width:"100%"},t.breakpoints.up("sm"),{marginLeft:t.spacing(1),width:"auto"})})),kn=Object(R.a)("div")((function(t){return{padding:t.theme.spacing(0,2),height:"100%",position:"absolute",pointerEvents:"none",display:"flex",alignItems:"center",justifyContent:"center"}})),Pn=Object(R.a)(ie.c)((function(t){return{color:"inherit","& .MuiInputBase-input":An({padding:(t=t.theme).spacing(1,1,1,0),paddingLeft:"calc(1em + ".concat(t.spacing(4),")"),transition:t.transitions.create("width"),width:"100%"},t.breakpoints.up("sm"),{width:"0",cursor:"pointer","&:focus":{width:"20ch"}})}}));var Cn=l.a.memo((function(){var t=[{Id:1,Title:"chapter 1",segment_id:0},{Id:2,Title:"chapter 2",segment_id:400}];return t.length,l.a.createElement(et.a,{className:En.a.TableContent,sx:{bgcolor:"heading.main",color:"text.primary",width:"100%",height:"100%",paddingInline:2}},l.a.createElement(In.a,{sx:{justifyContent:"space-between",paddingLeft:"0 !important",margin:0}},l.a.createElement(Re.a,{textTransform:"uppercase",component:"h6"},"Table Of Content"),l.a.createElement(jn,null,l.a.createElement(kn,null,l.a.createElement(Ye.a,null)),l.a.createElement(Pn,{placeholder:"Search…",inputProps:{"aria-label":"search"}}))),l.a.createElement(et.a,null,t.map((function(t,e){return l.a.createElement(et.a,{key:"TableContent-"+e,sx:{cursor:"pointer",width:"fit-content","&:hover":{fontWeight:"bold"}}},t.Title)}))))})),Rn=(m=n(988),n.n(m)),Bn=(n(70),n(329)),_n=n(276),Wn=(R=(n(465),n(1049)),n.n(R));n(189),ie=n(1055);function Nn(t){return(Nn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ln(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var o,r,i=[],a=!0,s=!1;try{for(n=n.call(t);!(a=(o=n.next()).done)&&(i.push(o.value),!e||i.length!==e);a=!0);}catch(t){s=!0,r=t}finally{try{a||null==n.return||n.return()}finally{if(s)throw r}}return i}}(t,e)||function(t,e){if(t){if("string"==typeof t)return qn(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?qn(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function qn(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}function Dn(t,e){var n,o=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,n)),o}function Hn(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Dn(Object(n),!0).forEach((function(e){var o,r;o=t,r=n[e=e],e in o?Object.defineProperty(o,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):o[e]=r})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Dn(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function zn(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Mn(t,e){return(Mn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Vn(t){return(Vn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Fn(t){return"s_"+t.start}function Un(t){return"ds_"+t.start}function Qn(t){return"i_"+t.start}function Yn(t){return"p_"+(t.end+1)}function Gn(t){return"l_"+(t.end+1)}var $n=String.fromCharCode(182),Jn=ae.a.renderToStaticMarkup(l.a.createElement(kt,null)),Zn=(m=function(t){var e=o;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Mn(e,t);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,o=Vn(t);n=e?(n=Vn(this).constructor,Reflect.construct(o,arguments,n)):o.apply(this,arguments),o=this;if(n&&("object"===Nn(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==o)return o;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(o);function o(t){var e;if(this instanceof o)return(e=n.call(this,t)).textAlignmentById=[],e.state={segmentedText:t.segmentedText},e.textAlignmentById=e.props.textAlignmentById,e._renderedSegments=null,e._renderedHtml=null,e.rangeSelect=[],e.theme=t.theme,e;throw new TypeError("Cannot call a class as a function")}return e=o,(t=[{key:"UNSAFE_componentWillReceiveProps",value:function(t){this.setState((function(e,n){return Hn(Hn({},e),{},{segmentedText:t.segmentedText})}))}},{key:"annotationsForSegment",value:function(t){var e=[],n=this.props.annotationPositions[String(t.start)],o=this.props.annotationPositions[h.c+t.start]||[],r=this.props.annotationPositions[h.b+t.start]||[],i=this.props.annotationPositions[h.e+(t.end+1)]||[];t=this.props.annotationPositions[h.d+(t.end+1)]||[];return(e=n||e).concat(o,r,i,t)}},{key:"segmentsContainSegment",value:function(t,e){for(var n=0;n<t.length;n++){var o=t[n];if(o.start===e.start&&o.text===e.text)return!0}return!1}},{key:"selectedElement",value:function(t){var e=[],n=[],o=document.getSelection(),r=parseInt(t.id.replace("s_",""));if(this.props.changeSyncIdOnClick(r),null!=t&&t.id.includes("s_")&&this.props.isPanelLinked&&this.props.condition){this.props.changeScrollToId({id:null,from:null});var i=parseInt(t.id.replace("s_","")),a=b()(this.textAlignmentById,(function(t){return i>=t.start&&i<t.end}));if(a){for(var s=a.start;s<a.end;s++)e.push(s);for(var l=a.TStart;l<a.TEnd;l++)n.push(l);this.props.changeSelectedRange({source:e,target:n})}}o&&"Range"===o.type||(this.props.selectedSegmentId(t.id),t.id||this.props.changeSelectedRange({source:[],target:[]}))}},{key:"generateHtml",value:function(t,e){var n=e.segmentedText.segments,o=Wn.a.textLine,r='<p class="'+o+'">';if(0===n.length)return{__html:r};for(var i=Wn.a.insertion,a=n[n.length-1].end+1,s=(t.annotationPositions[h.c+a]&&(e=new d.a(a,""),n.push(e)),t.annotationPositions[h.e+a]&&(e=new d.a(a,""),n.push(e)),t.annotationPositions[h.d+a]&&(e=new d.a(a,""),n.push(e)),t.activeAnnotations||{}),l=Wn.a.highlight,u=Wn.a.activeHighlight,p=null,f={},m=0;m<n.length;m++){var g=n[m],b="",v=[],w=this.annotationsForSegment(g),x=null,S=!1,O=!1,E=!1,T=!1,I=null;if(w){for(var A,j=[],k=[],P=[],C=[],R=0,B=w.length;R<B;R++){var _,W=w[R];W.isInsertion?W.uniqueId in s?j.push(W):(_=W.start,f.hasOwnProperty(_)||(k.push(W),f[_]=W)):W.isDeletion?W.uniqueId in s&&C.push(W):W.type!==c.a.pageBreak||t.activeWitness.isWorking?W.type!==c.a.lineBreak||t.activeWitness.isWorking?P.push(W):T=W:I=W}0===j.length&&0<k.length&&(N=k[0],A=Qn(g),L=i,t.activeAnnotation&&t.activeAnnotation.isInsertion&&t.activeAnnotation.start===N.start&&(L+=" "+Wn.a.selectedAnnotation),r+="<span id="+A+" key="+A+' class="'+L+'">'+N.content+"</span>"),0<C.length&&(A=C[0],x=t.getBaseAnnotation(A).content,t.activeAnnotation&&t.activeAnnotation.isDeletion&&t.activeAnnotation.start===A.start&&t.activeAnnotation.length===A.length&&0===g.length&&(S=!0)),I&&t.activeAnnotation&&t.activeAnnotation.uniqueId===I.uniqueId&&(O=!0),T&&t.activeAnnotation&&t.activeAnnotation.uniqueId===T.uniqueId&&(E=!0),(0<P.length||0<j.length)&&v.push(Wn.a.annotation)}if(g.start===a)break;var N,L=null,q=(0===g.length?(L=Un(g),v.push(Wn.a.removedByAnnotation),x&&(g=new d.a(g.start,x))):L=Fn(g),(this.segmentsContainSegment(t.selectedAnnotatedSegments,g)||S)&&v.push(Wn.a.selectedAnnotation),t.selectedSourceRange.includes(g.start)&&(N="light"===t.theme.palette.mode?Wn.a.selectedRangelight:Wn.a.selectedRangeDark,v.push(N)),t.imageScrollId.id.start<g.start&&t.imageScrollId.id.end>g.start&&v.push(Wn.a.selectedImage),0<v.length&&(b='class="'+y.a.apply(void 0,v)+'"'),g.text);if(t.searchStringPositions){var D=g.start,H=D,z=(q="",l);t.selectedSearchResult&&t.selectedSearchResult.start<=H&&t.selectedSearchResult.start+t.selectedSearchResult.length>H&&(z=u);for(var M=0;M<g.text.length;M++){var V,F,U,Q=g.text.charAt(M);H=D+M;p?((V=Ln(p,2))[0],0===M&&(q+='<span class="'+z+'">'),H===V[1]?(q+=Q+"</span>",p=null):M===g.text.length-1?q+=Q+"</span>":q+=Q):H in t.searchStringPositions?(F=(V=Ln(t.searchStringPositions[H],2))[0],U=V[1],q+='<span class="'+z+'">'+Q,M!==g.text.length-1&&H!==U||(q+="</span>"),H<U&&(p=[F,U])):q+=Q}}r+="<span id="+L+" key="+L+" "+b+">"+q+"</span>",I&&(x=[Wn.a.pageBreak],O&&x.push(Wn.a.selectedAnnotation),S=' class="'+x.join(" ")+'" ',r+="<span id="+Yn(g)+" key="+Yn(g)+S+">"+Jn+"</span>"),T&&(v=[Wn.a.lineBreak],E&&v.push(Wn.a.selectedAnnotation),b=' class="'+v.join(" ")+'" ',r=r+"<span id="+Gn(g)+" key="+Gn(g)+b+">"+$n+'</span></p><p class="'+o+'">')}return this._renderedSegments=n,{__html:r+="</p>"}}},{key:"shouldComponentUpdate",value:function(t,e){return e=this.generateHtml(t,e),this.props.imageScrollId!==t.imageScrollId||this.props.fontSize!==t.fontSize||(!this._renderedHtml||e.__html!==this._renderedHtml.__html)&&(this._renderedHtml=e,!0)}},{key:"componentDidUpdate",value:function(){this.textAlignmentById=this.props.textAlignmentById}},{key:"render",value:function(){var t=this,e=[Wn.a.text],n=(0===this.props.row&&e.push(Wn.a.textFirstRow),this._renderedHtml||this.generateHtml(this.props,this.state));return this._renderedHtml||(this._renderedHtml=n),l.a.createElement("div",{className:Wn.a.textContainer},l.a.createElement("div",{className:y.a.apply(void 0,e),id:"text1",dangerouslySetInnerHTML:n,style:{fontSize:this.props.fontSize,fontFamily:"var(--tibetan-fonts)"},onClick:function(e){t.selectedElement(e.target)}}))}}])&&zn(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),o}(l.a.Component),Object(ie.a)(m)),Xn=(R=n(1050),n.n(R));function Kn(t){return(Kn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function to(t,e){var n,o=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,n)),o}function eo(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?to(Object(n),!0).forEach((function(e){no(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):to(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function no(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function oo(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var o,r,i=[],a=!0,s=!1;try{for(n=n.call(t);!(a=(o=n.next()).done)&&(i.push(o.value),!e||i.length!==e);a=!0);}catch(t){s=!0,r=t}finally{try{a||null==n.return||n.return()}finally{if(s)throw r}}return i}}(t,e)||function(t,e){if(t){if("string"==typeof t)return ro(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ro(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ro(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}function io(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function ao(t,e){return(ao=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function so(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function lo(t){return(lo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}parseInt(C.a.inlineWidth);var co="bdrcimg_pre",uo={},po=function(t){var e=o;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ao(e,t);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,o=lo(t);n=e?(n=lo(this).constructor,Reflect.construct(o,arguments,n)):o.apply(this,arguments),o=this;if(n&&("object"===Kn(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return so(o)}}(o);function o(t){var e;if(this instanceof o)return(e=n.call(this,t)).textAlignmentById=[],e.childRef=s.createRef("0"),e.list=null,e.splitText=null,e.cache=new _n.b({fixedWidth:!0}),e.imageAlignmentById=e.props.imageAlignmentById,e.changeImageScrollId=e.props.changeImageScrollId,e.splitTextRef=s.createRef(null),e.rowRenderer=e.rowRenderer.bind(so(e)),e.textListVisible=t.textListVisible,e.editMenuVisible=t.editMenuVisible,e.isPanelLinked=t.isPanelLinked,e.activeSelection=null,e.selectedNodes=null,e._mouseDown=!1,e._activeWitness=null,e._didSetInitialScrollPosition=!1,e._modifyingSelection=!1,e.imageHeight=null,e.imageWidth=null,e.calculatedImageHeight=null,e.processProps(t),e.changeScrollToId=t.changeScrollToId,e.changeSyncIdOnClick=t.changeSyncIdOnClick,e.closeAnnotation=t.closeAnnotation,e.scrollJump=t.scrollJump,e.textAlignmentById=[],e.scrollEvent=e.scrollEvent.bind(so(e)),e.selectedWindow=t.selectedWindow,e.condition=!1,e.changeImageScrollId=t.changeImageScrollId,e;throw new TypeError("Cannot call a class as a function")}return e=o,(t=[{key:"scrollEvent",value:function(t){if(2===this.selectedWindow)return null;var e,n;1===this.selectedWindow&&this.isPanelLinked&&(e=[],n=[],this.textAlignmentById.map((function(t){var n=document.getElementById("s_"+t.start);n&&102<n.getBoundingClientRect().top&&e.push({id:t.id,start:t.start,target:t.TStart})})),this.imageAlignmentById.map((function(t){var e=document.getElementById("s_"+(null==t?void 0:t.start));e&&102<e.getBoundingClientRect().top&&n.push({id:t.id,start:t.start,end:t.end})})),Ee()(e)&&Ee()(n)||1===this.selectedWindow&&this.debouncedScroll(e,n))}},{key:"updateList",value:function(){var t=!(0<arguments.length&&void 0!==arguments[0])||arguments[0],e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;if(!this.calculatedImageHeight&&this.imageHeight&&this.imageWidth&&(this.calculatedImageHeight=this.calculateImageHeight()),this.list){var n=this.list;if(t)if(null!==e)if(Array.isArray(e)){if(Array.isArray(e))for(var o=0;o<e.length;o++){var r=e[o];this.cache.clear(r)}}else this.cache.clear(e);else this.cache.clearAll(),n.measureAllRows(),n.recomputeRowHeights(0);n.forceUpdateGrid()}}},{key:"mouseDown",value:function(){this._mouseDown=!0}},{key:"mouseUp",value:function(){var t;this._mouseDown=!1,this.activeSelection&&(t=(t=this.processSelection(this.activeSelection))||[],this.props.didSelectSegmentIds(t),this.activeSelection=null)}},{key:"handleSelection",value:function(t){this._modifyingSelection?(t.stopPropagation(),this._modifyingSelection=!1):(this.activeSelection=document.getSelection(),this._mouseDown||this.mouseUp())}},{key:"processSelection",value:function(t){if(0===t.rangeCount||t.isCollapsed||"Caret"===t.type)return this.selectedNodes=null;var e=(t=t.getRangeAt(0)).startContainer;if(!(e=this.getNodeSegmentSpan(e))||!e.parentNode)return null;var n=this.getRangeNodes(t,e.parentNode),o=(0<n.length&&(o=n[0],t.startOffset===o.textContent.length&&n.shift()),t.endContainer);return(o=this.getNodeSegmentSpan(o))&&o.parentNode?(o&&e.parentNode!==o.parentNode?n=n.concat(this.getRangeNodes(t,o.parentNode)):0===t.endOffset&&n.pop(),e=[],(this.selectedNodes=n).reduce((function(t,e){return e instanceof Element&&t.push(e.id),t}),e),e):null}},{key:"getNodeSegmentSpan",value:function(t){for(var e=t,n=null,o=/^(i|s|ds)_/;!n&&e.parentNode;)e instanceof Element&&o.test(e.id)&&(n=e),e=e.parentNode;return n}},{key:"getRangeNodes",value:function(t,e){for(var n=[],o=0,r=e.childNodes.length;o<r;o++){var i=e.childNodes[o];t.intersectsNode(i)&&n.push(i)}return n}},{key:"getControlsMeasurements",value:function(t){if(!this.splitText)return null;var e=this.splitText,n=null,o=null,r=null,i=null,a=null,s=[],l=0;if(t.activeAnnotation){var u=t.activeAnnotation;if(null===(l=oo(t.splitText.annotatedText.getPositionOfAnnotation(u),1)[0]))return console.warn("No startPos in getControlsMeasurements"),null;u.type===c.a.pageBreak&&--l,u.type===c.a.lineBreak&&--l;var p=l+u.length;0<u.length&&--p,n=t.splitText.getTextIndexOfPosition(p),i=e.getBoundingClientRect()}var f=[];if(t.selectedAnnotatedSegments&&0<t.selectedAnnotatedSegments.length){f=t.selectedAnnotatedSegments;for(var h=0;h<f.length;h++){var m=f[h];if(null===o&&m instanceof d.a){o=m;break}}o&&(a=0===o.length&&t.activeAnnotation&&t.activeAnnotation.isInsertion?(r=Qn(o),Qn):(r=Fn(o),Fn))}else t.activeAnnotation&&(t.activeAnnotation.isDeletion?(r=Un(u=new d.a(l,"")),a=Un,f=[o=u]):t.activeAnnotation.isInsertion?(p=oo(t.splitText.annotatedText.getPositionOfAnnotation(t.activeAnnotation),1)[0])&&(r=Qn(e=new d.a(p,"")),a=Qn,f=[o=e]):t.activeAnnotation.type===c.a.pageBreak?(f=[o=new d.a(l+1,"")],s=[r=Yn(new d.a(l,""))]):t.activeAnnotation.type===c.a.lineBreak&&(f=[o=new d.a(l+1,"")],s=[r=Gn(new d.a(l,""))]));if(a)for(var y=0;y<f.length;y++){var g=f[y];g instanceof d.a&&(g=a(g),s.push(g))}return null!=n&&o&&r&&i?{selectedTextIndex:n,firstSelectedSegment:o,selectedElementId:r,splitTextRect:i,selectedElementIds:s}:null}},{key:"shouldResetListCache",value:function(t,e){var n=!1;return!(t.showImages===e.showImages&&!this.pageBreaksChanged(t,e))||n}},{key:"pageBreaksChanged",value:function(t,e){return t=t.splitText.getTextsFinalPositions(),e=e.splitText.getTextsFinalPositions(),t.length!==e.length||JSON.stringify(t)!==JSON.stringify(e)}},{key:"lineBreaksChanges",value:function(t,e){var n=t.activeAnnotation,o=e.activeAnnotation,r=!1;return n&&n.isType(c.a.lineBreak)&&e.activeAnnotations&&!e.activeAnnotations.hasOwnProperty(n.uniqueId)&&(r=!0),!(!(o&&o.isType(c.a.lineBreak)&&t.activeAnnotations)||t.activeAnnotations.hasOwnProperty(o.uniqueId))||r}},{key:"selectedListRow",value:function(t){var e=null;return t.activeAnnotation?t.splitText.getTextIndexOfPosition(t.activeAnnotation.start):e}},{key:"processProps",value:function(t){var e=this,n=!1;if((r=((!this.props.selectedWitness||t.selectedWitness&&t.selectedWitness.id!==this.props.selectedWitness.id)&&(this._didSetInitialScrollPosition=!(n=!0)),!t.selectedSearchResult||this.props.selectedSearchResult&&t.selectedSearchResult.start===this.props.selectedSearchResult.start&&t.selectedSearchResult.textId===this.props.selectedSearchResult.textId||(console.log("resetting scroll position from search result"),this._didSetInitialScrollPosition=!1),this._filteredSelectedAnnotatedSegments=t.selectedAnnotatedSegments.reduce((function(t,e){return e instanceof d.a&&t.push(e),t}),[]),this.getControlsMeasurements(t)))&&(this.selectedTextIndex=r.selectedTextIndex,this.firstSelectedSegment=r.firstSelectedSegment,this.splitTextRect=r.splitTextRect,this.selectedElementId=r.selectedElementId,this.selectedElementIds=r.selectedElementIds),t.textListVisible!==this.textListVisible||t.editMenuVisible!==this.editMenuVisible)setTimeout((function(){e.textListVisible=t.textListVisible,e.editMenuVisible=t.editMenuVisible,e.updateList(!0)}),500);else if(n)this.updateList(!0);else if(this.pageBreaksChanged(this.props,t)){var o=null,r=this.selectedListRow(this.props);n=this.selectedListRow(t);if(r&&n){o=[];for(var i=n<r?n:r,a=this.props.splitText.texts.length;i<a;i++)o.push(i)}this.updateList(!0,o)}else if(this.lineBreaksChanges(this.props,t)){n=(n=this.selectedListRow(t))||this.selectedListRow(this.props),r=this.props.splitText.texts;var s=[];if(null!==n){for(var l=n,c=r.length;l<c;l++)s.push(l);this.updateList(!0,s)}}else this.props.fontSize!==t.fontSize?this.updateList(!0):this.props.activeAnnotation&&t.activeAnnotation&&this.annotationsInSameLocation(this.props.activeAnnotation,t.activeAnnotation)?this.updateList(!0,this.selectedListRow(t)):this.updateList(this.shouldResetListCache(this.props,t))}},{key:"annotationsInSameLocation",value:function(t,e){return t.start===e.start&&t.length===e.length}},{key:"UNSAFE_componentWillReceiveProps",value:function(t){this.processProps(t)}},{key:"componentDidMount",value:function(){var t=this;this.resizeHandler=Rn()((function(){t.calculatedImageHeight=null,t.updateList()}),600).bind(this),this.debouncedScroll=Se()((function(e,n){e.length&&t.changeScrollToId({id:null==(e=e[0])?void 0:e.start,from:1}),n.length&&t.changeImageScrollId({id:{start:null==(e=n[0])?void 0:e.start,end:null==(e=n[0])?void 0:e.end},from:1})}),1e3),window.addEventListener("resize",this.resizeHandler),this.selectionHandler=Se()((function(e){t.handleSelection(e)}),200).bind(this),document.addEventListener("selectionchange",this.selectionHandler),document.addEventListener("mousedown",this.mouseDown.bind(this),!0),document.addEventListener("mouseup",this.mouseUp.bind(this),!0),this.processProps(this.props),this.timer=setTimeout((function(){t.resizeHandler()}),2e3),this.componentDidUpdate()}},{key:"componentDidUpdate",value:function(t){var e,n,o,r,i,a,s,l,c,u=this,p=this.props.textAlignment,f=(this.imageAlignmentById=this.props.imageAlignmentById,this.SearchSyncId=this.props.syncIdOnSearch||null,this.condition=(null==p||null==(l=p.source)?void 0:l.witness)===this.props.selectedWitness.id,this.props.scrollToId),h=this.list;((null==t?void 0:t.searchResults)!==(null==(l=this.props)?void 0:l.searchResults)||(null==t?void 0:t.syncIdOnSearch)!==(null==(l=this.props)?void 0:l.syncIdOnSearch))&&this.props.searchResults&&this.SearchSyncId&&(e=this.props.splitText.getTextIndexOfPosition(this.SearchSyncId),setTimeout((function(){h.scrollToRow(e),setTimeout((function(){h.scrollToPosition(h.props.scrollTop-300)}),0)}),100)),this.textAlignmentById=this.props.textAlignmentById,this.isPanelLinked=this.props.isPanelLinked,this.selectedWindow=this.props.selectedWindow,this.targetId=this.props.syncIdOnClick,this.selectedNodes&&0<this.selectedNodes.length&&(n=this.selectedNodes,o=this.props.selectedAnnotatedSegments,setTimeout((function(){var t=document.createRange(),e=n[0],r=n[n.length-1],i=o[o.length-1];i instanceof d.a&&(i=document.getElementById(Fn(i)))&&(r=i),e instanceof Element&&r instanceof Element&&(e=document.getElementById(e.id),r=document.getElementById(r.id),e&&r&&(t.setStart(e,0),t.setEnd(r,r.childNodes.length),(i=document.getSelection())&&(u._modifyingSelection=!0,i.removeAllRanges(),i.addRange(t),u.selectedNodes=null)))}),0)),!this._didSetInitialScrollPosition&&this.list&&(r=this.list,(this.props.activeAnnotation||this.props.selectedSearchResult)&&(i=this.getSelectedTextIndex(),setTimeout((function(){r.scrollToRow(i),setTimeout((function(){r.scrollToPosition(r.props.scrollTop-300)}),0)}),100)),this._didSetInitialScrollPosition=!0),2===this.selectedWindow&&2==f.from&&this.isPanelLinked&&this.condition&&null!==f.id&&(a=this.list,this.textAlignmentById=this.props.textAlignmentById||[],this.splitText.style.scrollBehavior="smooth",p&&this.isPanelLinked&&null!==(l=null==(t=this.textAlignmentById.find((function(t){return t.TStart===f.id})))?void 0:t.start)&&(s=this.props.splitText.getTextIndexOfPosition(l),setTimeout((function(){a.scrollToRow(s),setTimeout((function(){a.scrollToPosition(a.props.scrollTop-300)}),0)}),100))),this.targetId&&"ua"===f.from&&2===this.selectedWindow&&"ua"===f.id&&(p=null==(t=p.alignment.find((function(t){return u.targetId>=t.target_segment.start&&u.targetId<t.target_segment.end})))||null==(l=t.source_segment)?void 0:l.start,c=this.props.splitText.getTextIndexOfPosition(p),setTimeout((function(){h.scrollToRow(c),setTimeout((function(){h.scrollToPosition(h.props.scrollTop-300)}),0)}),100))}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mousedown",this),document.removeEventListener("mouseup",this),window.removeEventListener("resize",this.resizeHandler),document.removeEventListener("selectionchange",this.selectionHandler),clearTimeout(this.timer)}},{key:"calculateImageHeight",value:function(){var t,e,n=null;return this.imageHeight&&this.imageWidth&&(t=this.imageWidth/this.imageHeight,e=Xn.a.pechaImage,0<(e=document.getElementsByClassName(e)).length&&(n=e[0].offsetWidth/t)),n}},{key:"getSelectedTextIndex",value:function(){var t,e=0,n=null;return this.props.activeAnnotation?n=oo(this.props.splitText.annotatedText.getPositionOfAnnotation(this.props.activeAnnotation),1)[0]:this.props.selectedSearchResult&&((t=this.props.splitText.annotatedText.segmentAtOriginalPosition(this.props.selectedSearchResult.start))instanceof d.a?n=t.start:"number"==typeof t&&(n=t)),n?this.props.splitText.getTextIndexOfPosition(n):e}},{key:"getBaseAnnotation",value:function(t){var e=oo(this.props.splitText.annotatedText.getPositionOfAnnotation(t),1)[0];return this.props.splitText.annotatedText.getBaseAnnotation(e=null===e?0:e,t.content.length)}},{key:"render",value:function(){var t=this,e=this.props,n=this.rowRenderer,o=this.cache,r=e.selectedWitness?e.selectedWitness.id:0;return s.createElement("div",{className:Xn.a.splitText,ref:function(e){return t.splitText=e},key:r,style:{cursor:this.props.isAnnotating?"text":"pointer"}},s.createElement("button",{id:"updateList",style:{display:"none"},onClick:this.resizeHandler}),s.createElement(Bn.a,{disableWidth:!0},(function(r){return r=r.height,s.createElement(Bt.a,{width:1,ref:function(e){return t.list=e},height:r,rowCount:e.splitText.texts.length,rowHeight:o.rowHeight,rowRenderer:n,overscanRowCount:1,deferredMeasurementCache:o,onScroll:t.scrollEvent,scrollToAlignment:"start",containerStyle:{width:"100%",maxWidth:"100%"},style:{width:"100%"}})})))}},{key:"getImageUrl",value:function(t){if(!this.props.selectedWitness||!this.props.selectedWitness.properties)return"";var e=(o=this.props.selectedWitness.properties)[co],n=o.bdrcimg_number,o=o.bdrcimg_suffix;return"//iiif.bdrc.io/"+e+(Number(n)+t)+"."+o+"/full/full/0/default.jpg"}},{key:"getStringPositions",value:function(t,e,n){var o=this.props.splitText.annotatedText.getUniqueId();if((uo=uo.hasOwnProperty(o)?uo:no({},o,{}))[o].hasOwnProperty(e)||(uo[o]=no({},e,{})),uo[o][e].hasOwnProperty(n))return uo[o][e][n];for(var r=new ln.a,i=t.getText(),a=null==(t=t.segments[0])?void 0:t.start,s=[],l=i.indexOf(e);-1!==l;)s.push(l),l=i.indexOf(e,l+1);var c={};if(0<s.length)for(var u=r.splitGraphemes(i),p=0,f=null,d=0;d<u.length;d++){var h=u[d],m=p+(h.length-1);null!==f?f+(e.length-1)<=m&&(c[f+a]=[f+a,m+a],f=null):-1!==s.indexOf(p)?e.length===h.length?c[p+a]=[p+a,m+a]:e.length>h.length&&(f=p):f=null,p+=h.length}return uo[o][e][n]=c}},{key:"rowRenderer",value:function(t){var e=t.key,n=t.index,o=t.parent,r=(t=t.style,this.props),i=this.cache,a=r.showImages?Xn.a.pechaImage:null,l=(r.selectedWitness&&r.selectedWitness.properties&&r.selectedWitness.properties.hasOwnProperty(co)&&this.getImageUrl(n),{}),c=this.props.searchValue;c&&0<c.length&&r.splitText&&(l=this.getStringPositions(r.splitText.texts[n],c,n)),r.showImages&&a&&this.calculatedImageHeight&&this.calculatedImageHeight,t=eo(eo({},t),{},{height:t.height+10});return s.createElement(_n.a,{columnIndex:0,key:e,parent:o,rowIndex:n,cache:i},s.createElement("div",{key:e,style:t,className:Xn.a.splitTextRow,ref:this.splitTextRef,id:"index_".concat(n)},s.createElement("div",{className:Xn.a.splitTextRowContent},s.createElement(Zn,{ref:this.childRef,segmentedText:r.splitText.texts[n],annotations:r.annotations,activeAnnotations:r.activeAnnotations,activeAnnotation:r.activeAnnotation,row:n,selectedSegmentId:r.selectedSegmentId,annotationPositions:r.annotationPositions,selectedAnnotatedSegments:this._filteredSelectedAnnotatedSegments,getBaseAnnotation:this.getBaseAnnotation.bind(this),activeWitness:this.props.selectedWitness,searchValue:c,selectedSearchResult:this.props.selectedSearchResult,searchStringPositions:l,fontSize:r.fontSize,changeSyncIdOnClick:this.props.changeSyncIdOnClick,changeScrollToId:this.props.changeScrollToId,isPanelLinked:this.props.isPanelLinked,isAnnotating:this.props.isAnnotating,textAlignmentById:this.props.textAlignmentById,selectedSourceRange:this.props.selectedSourceRange,selectedTargetRange:this.props.selectedTargetRange,changeSelectedRange:this.props.changeSelectedRange,condition:this.condition,imageScrollId:this.props.imageScrollId})),this.props.isAnnotating&&this.selectedTextIndex===n&&this.props.activeAnnotation&&s.createElement(me,{annotationPositions:r.annotationPositions,annotatedText:r.splitText.annotatedText,activeAnnotation:r.activeAnnotation,inline:!0,firstSelectedSegment:this.firstSelectedSegment,splitTextRect:this.splitTextRect,selectedElementId:this.selectedElementId,pechaImageClass:a,splitText:r.splitText,selectedElementIds:this.selectedElementIds,list:this.list})))}}])&&io(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),o}(s.PureComponent);function fo(t){return(fo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ho(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function mo(t,e){return(mo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function yo(t){return(yo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var go,bo,vo,wo,xo=0,So=(ie=function(t){var e=o;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&mo(e,t);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,o=yo(t);n=e?(n=yo(this).constructor,Reflect.construct(o,arguments,n)):o.apply(this,arguments),o=this;if(n&&("object"===fo(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==o)return o;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(o);function o(){var t;if(this instanceof o)return(t=n.call(this)).key=xo++,t.ref=l.a.createRef(),t.selectedWindow=null,t;throw new TypeError("Cannot call a class as a function")}return e=o,(t=[{key:"mouseEnter",value:function(){2===this.selectedWindow&&this.props.changeSelectedWindow(1)}},{key:"componentDidMount",value:function(){this.ref.current.addEventListener("mouseenter",this.mouseEnter.bind(this))}},{key:"componentDidUpdate",value:function(){this.selectedWindow=this.props.selectedWindow}},{key:"render",value:function(){this.props.text&&this.props.text;var t,e,n=null;n=[this.props.annotatedText&&this.props.text&&!this.props.loading?(t=this.props.paginated?(t=this.props.pageBreaks,0===(e=ge(t))[0]&&e.shift(),function(t){return e}):Object(ye.a)(1e3,/^།[\s]+(?!།[\s]+)/,2,5),n=new re.a(this.props.annotatedText,t),l.a.createElement(po,{splitText:n,annotations:this.props.annotations,activeAnnotations:this.props.activeAnnotations,activeAnnotation:this.props.activeAnnotation,limitWidth:!1,didSelectSegmentIds:this.props.didSelectSegmentIds,selectedSegmentId:this.props.selectedSegmentId,annotationPositions:this.props.annotationPositions,selectedAnnotatedSegments:this.props.selectedAnnotatedSegments,syncIdOnClick:this.props.syncIdOnClick,textListVisible:this.props.textListVisible,showImages:this.props.pageImagesVisible,imagesBaseUrl:this.props.imagesBaseUrl,selectedWitness:this.props.selectedWitness,key:this.key,selectedSearchResult:this.props.selectedSearchResult,searchValue:this.props.searchValue,fontSize:this.props.fontSize,isSecondWindowOpen:this.props.isSecondWindowOpen,changeScrollToId:this.props.changeScrollToId,changeSyncIdOnClick:this.props.changeSyncIdOnClick,imageData:this.props.imageData,isPanelLinked:this.props.isPanelLinked,selectedImage:this.props.selectedImage,changeSelectedImage:this.props.changeSelectedImage,isAnnotating:this.props.isAnnotating,closeAnnotation:this.props.closeAnnotation,textAlignment:this.props.textAlignment,textAlignmentById:this.props.textAlignmentById,isPanelVisible:this.props.isPanelVisible,scrollToId:this.props.scrollToId,selectedWindow:this.props.selectedWindow,selectedSourceRange:this.props.selectedSourceRange,selectedTargetRange:this.props.selectedTargetRange,changeSelectedRange:this.props.changeSelectedRange,searchResults:this.props.searchResults,showTableContent:this.props.showTableContent,selectedText:this.props.text,syncIdOnSearch:this.props.syncIdOnSearch,imageAlignmentById:this.props.imageAlignmentById,changeImageScrollId:this.props.changeImageScrollId,imageScrollId:this.props.imageScrollId})):l.a.createElement("div",{key:this.key})];return l.a.createElement(et.a,{sx:{height:"100%",flex:1,bgcolor:"navbar.main",color:"text.primary"},className:y()(ve.a.textDetail,we.a.flex,we.a.flexColumn),key:this.key,ref:this.ref},l.a.createElement(Sn,null),l.a.createElement(Ve.a,null),l.a.createElement(g.a,{loaded:!this.props.loading,zIndex:5}),l.a.createElement(et.a,{style:{display:"flex",height:"100%",width:"100%",position:"relative"}},l.a.createElement(et.a,{style:{flex:1},className:y()(ve.a.textContainer,we.a.flex)},this.props.loading?l.a.createElement("div",null):n),l.a.createElement(On.a,{direction:"left",in:this.props.showTableContent,container:this.ref.current},l.a.createElement(et.a,{sx:{position:"absolute",height:"100%",minWidth:"50%",right:0}},l.a.createElement(Cn,null)))))}}])&&ho(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),o}(l.a.Component),n(176),n(82));function Oo(t,e){var n,o=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,n)),o}function Eo(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Oo(Object(n),!0).forEach((function(e){var o,r;o=t,r=n[e=e],e in o?Object.defineProperty(o,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):o[e]=r})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Oo(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function To(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var o,r,i=[],a=!0,s=!1;try{for(n=n.call(t);!(a=(o=n.next()).done)&&(i.push(o.value),!e||i.length!==e);a=!0);}catch(t){s=!0,r=t}finally{try{a||null==n.return||n.return()}finally{if(s)throw r}}return i}}(t,e)||Io(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Io(t,e){if(t){if("string"==typeof t)return Ao(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ao(t,e):void 0}}function Ao(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}function jo(t){return[t.start,t.length].join("-")}function ko(t,e){var n=[];if(r()(t,(function(t){return n.push(t.start)})),n=n.sort((function(t,e){return t-e})),e){var o=[];if(r()(e,(function(t){return o.push(t.start)})),o=o.sort((function(t,e){return t-e})),0===n.length)return o;if(n.length/o.length<.9)for(var i=n[n.length-1],a=0,s=o.length;a<s;a++){var l=o[a];i<l&&n.push(l)}}return n}var Po=null;m=Object(o.connect)((function(t){var e=Object(ne.jb)(t),n=t.data.loadingWitnesses||t.data.loadingAnnotations,o=Object(ne.bb)(t),r=ne.wb(t),i=ne.Y(t);if(n)return{text:null,witnesses:null,baseWitness:null,annotations:null,loading:n,paginated:null,pageImagesVisible:!0,annotatedText:null,selectedAnnotatedSegments:null,annotationPositions:null,activeAnnotations:null,activeAnnotation:null,user:e,textListVisible:o,fontSize:tt.a,isSecondWindowOpen:Object(ne.yb)(t),isPanelLinked:r,textAlignmentById:i,imageAlignmentById:Object(ne.q)(t)};var a,s,l,u=Object(ne.I)(t),p={},f=(u&&(a=Object(ne.pb)(t,u.id),s=Object(ne.n)(t,u.id)),Object(ne.F)(t)),m={},y=[],g=null,b=Object(ne.h)(t),v=[],w={},x=[],S="",O=Object(ne.B)(t),E=!1,T=Object(ne.Z)(t);if(a&&u&&t.data.witnessAnnotationsById.hasOwnProperty(a.id)){p=Object(ne.eb)(t,u.id),g=((l=(I=Object(ne.L)(t,u.id))?Object(ne.lb)(t,I):l)||(I=(l=a).id),l.id!==a.id&&(E=!0,Object(ne.Ab)(t)),So.d(t,l.id)),w=(I=To(So.c(t,l,a),2))[0],y=I[1];if(g&&(m=function(t,e){if(t===go&&e===bo&&t.version===wo)return vo;for(var n={},o={},r=0;r<e.length;r++)!function(r){var i=e[r],a=(r=To(t.getPositionOfAnnotation(i),2))[0],s=r[1];if(null!=a)if(0===s){if(i.isInsertion){if(r=jo(i),r=o[r])return r.map((function(t){return n[t].push(i)}));a=h.c+a}i.isDeletion&&0<i.length&&(a=h.b+a),i.type===c.a.pageBreak&&(a=h.e+a),i.type===c.a.lineBreak&&(a=h.d+a),void 0===n[a]&&(n[a]=[]),-1===n[a].indexOf(i)&&n[a].push(i)}else{for(var l=[],u=a;u<a+s;u++)void 0===n[u]&&(n[u]=[]),-1===n[u].indexOf(i)&&n[u].push(i),l.push(u);i.isInsertion&&(r=jo(i),o[r]=l)}}(r);return bo=e,vo=n,wo=(go=t).version,n}(g,Object.values(y))),b&&g&&(b=Po&&Po.id===l.id?b:g.getAnnotation(b.start,b.length))&&(v=g.segmentsForAnnotation(b)),l&&s&&g){var I=g.getAnnotationsOfType(c.a.pageBreak)||{},A=null;l.id!==s.id&&(A=Object(ne.m)(t,a.id,c.a.pageBreak,s.id));for(var j=0,k=(x=ko(I,A)).length;j<k;j++){var P=x[j];(P=g.segmentAtOriginalPosition(P))instanceof d.a?x[j]=P.start:P instanceof Number&&(x[j]=P)}E&&(S="/static/images/texts/"+u.name+"/"+l.source.name+"/")}}Po=l;I=ne.y(t),A=ne.X(t);var C=ne.R(t),R=ne.N(t);return{text:u,witnesses:p,workingWitness:a,baseWitness:s,annotations:y,loading:n,paginated:E,pageImagesVisible:!1,annotatedText:g,selectedAnnotatedSegments:v,annotationPositions:m,activeAnnotations:Eo({},w),activeAnnotation:b,pageBreaks:x,imagesBaseUrl:S,user:e,textListVisible:o,selectedWitness:l,selectedSearchResult:f,searchValue:O,fontSize:T,isSecondWindowOpen:Object(ne.yb)(t),imageData:Object(ne.r)(t),isPanelLinked:r,selectedImage:Object(ne.D)(t),isImagePortrait:Object(ne.vb)(t),isPanelVisible:Object(ne.xb)(t),isAnnotating:ne.ub(t),textAlignment:A,textAlignmentById:i,scrollToId:I,syncIdOnClick:C,selectedWindow:R,selectedSourceRange:Object(ne.G)(t),selectedTargetRange:Object(ne.H)(t),searchResults:Object(ne.z)(t,O),showTableContent:Object(ne.O)(t),syncIdOnSearch:ne.S(t),imageAlignmentById:Object(ne.q)(t),imageScrollId:Object(ne.s)(t)}}),null,(function(t,e,n){function o(t,e,n){var o=[],r=[],i=[];(t=b[t])&&(o=t.filter((function(t){return t.type===c.a.variant})),r=t.filter((function(t){return t.type===c.a.pageBreak})),i=t.filter((function(t){return t.type===c.a.lineBreak}))),t=a()(o.concat(r,i),g.annotations,(function(t,e){return t.toString()==e.toString()})),r=null,r=0<t.length?t[0]:o&&0<o.length?(i=function(t){for(var e=null,n=0;n<t.length;n++){var o=t[n];(!e||o.length>e.length)&&(e=o)}return e}(o),o=(t=To(g.getPositionOfAnnotation(i),2))[0],t=t[1],i&&i.isInsertion&&(t=0),g.getBaseAnnotation(o,t)):g.getBaseAnnotation(e,n);y(Object(oe.Yb)(r))}function r(t){return-1!==t.indexOf("i_")}function s(t){return-1!==t.indexOf("ds_")}function l(t){return-1!==t.indexOf("p_")}function d(t){return-1!==t.indexOf("l_")}function m(t){return!r(t)&&s(t)?t.substr(3):t.substr(2)}var y=e.dispatch,g=t.annotatedText,b=t.annotationPositions;return Eo(Eo(Eo({},t),n),{},{didSelectSegmentIds:function(e){if(0!==e.length){var n,o=[],l=[],d=function(t,e){var n,o="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!o){if(Array.isArray(t)||(o=Io(t))||e&&t&&"number"==typeof t.length)return o&&(t=o),n=0,{s:e=function(){},n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:e};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i=!0,a=!1;return{s:function(){o=o.call(t)},n:function(){var t=o.next();return i=t.done,t},e:function(t){a=!0,r=t},f:function(){try{i||null==o.return||o.return()}finally{if(a)throw r}}}}(e);try{for(d.s();!(n=d.n()).done;){var v,w,x,S=n.value;s(S)||r(S)||(v=m(S),w=g.segmentedText.segmentAtPosition(v),l.push(w),(x=b[w.start])&&(o=o.concat(x)))}}catch(e){d.e(e)}finally{d.f()}o=i()(o,(function(t,e){return t.toString()==e.toString()}));var O,E,T=a()(o,g.annotations,(function(t,e){return t.toString()==e.toString()})),I=function(t,e,n,o){if(0===t.length)return null;for(var r=t[0],i=(t=t[t.length-1],r.start),a=t.end,s=null,l=null,c=0;c<n.length;c++){var u=n[c],p=null,f=(d=To(o.getPositionOfAnnotation(u),2))[0],d=d[1];-1!==e.indexOf(u)?(f&&f<i&&(i=f,s=u),(p=f+d-1)&&a<p&&(l=a=p)):a<(p=f+d-1)&&(a=p)}return{start:i,length:a-i+1,annotation:s&&l&&s===l?s:null}}(l,T,o,t.annotatedText);I?(O=g.getBaseAnnotation(I.start,I.length),null,E=I.annotation||(0<T.length?(T=g.segmentedText.segmentsInRange(I.start,I.length).reduce((function(t,e){return t+e.text}),""),t.selectedWitness||console.log("no stateProps.selectedWitness: %o",t.selectedWitness),new c.c(h.f,function(t){var e=new u.b(h.f,u.a);return t=new f.a(t.id,t.name),new p.a(h.f,t,e,"",!1)}(t.text),O.start,O.length,T,c.a.variant,t.selectedWitness,t.user)):O),y(Object(oe.Yb)(E))):console.warn("No range for selected segment ids: %o",e)}},selectedSegmentId:function(e){var n,i=m(e),a=i;r(e)?a=h.c+i:s(e)?a=h.b+i:l(e)?a=h.e+i:d(e)&&(a=h.d+i),b[a],""===e?t.activeAnnotation&&(n=oe.Yb(null),y(n)):r(e)||s(e)||l(e)||d(e)?o(a,i,0):(n=Number(m(e)),(a=g.segmentedText.segmentAtPosition(n))&&o(a.start,a.start,a.length))},changeScrollToId:function(t){return y(oe.Pb(t))},changeSyncIdOnClick:function(t){return y(oe.Sb(t))},changeSelectedImage:function(t){y(oe.Jc(t))},changeSelectedWindow:function(t){y(oe.Rb(t))},changeSelectedRange:function(t){y(oe.Qb(t))},changeShowTableContent:function(t){y(oe.Vc(t))},closeAnnotation:function(){var t=oe.Yb(null);y(t)},changeImageScrollId:function(t){y(oe.Lb(t))}})}))(ie);e.default=l.a.memo(m)},966:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var o=n(189);function r(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}n(68);var i=function(){function t(e,n){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.annotatedText=e,this.splitter=n,this._texts=null,this._textsId=null,this._textsFinalPositions=[]}var e,n;return e=t,(n=[{key:"texts",get:function(){if(!this.annotatedText)return[];if(!this._texts||this._textsId!==this.annotatedText.getUniqueId()){this._textsFinalPositions=[];var t=this.annotatedText.segmentedText,e=t.getText(),n=this.splitter(e).filter((function(t){return 0!==t}));if(0===n.length)return this._textsFinalPositions.push(e.length),[t];n[n.length-1]+1<e.length&&n.push(e.length-1);for(var r=t.segments,i=0,a=[],s=0;s<n.length;s++){var l=n[s],c=(l=t.indexOfSegmentAtPosition(l-1),void 0);c=s==n.length-1?r.slice(i):r.slice(i,l+1),c=new o.a(c);a.push(c),i=l+1,0<=l&&(c=r[l],this._textsFinalPositions.push(c.end))}this._texts=a.filter((function(t){return 0<t.segments.length})),this._textsId=this.annotatedText.getUniqueId()}return this._texts||[]}},{key:"getTextsFinalPositions",value:function(){return this.texts,this._textsFinalPositions}},{key:"getTextIndexOfPosition",value:function(t){for(var e=this.getTextsFinalPositions(),n=0,o=null,r=0;r<e.length;r++){var i=e[r];if(n<=t&&t<=i){o=r;break}n=i}return null===o&&(console.warn("no index for position %d",t),o=e.length-1),o}}])&&r(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}()},967:function(t,e,n){t.exports={"green-tint":"#88af8e","blue-tint":"#024279","active-button":"#00746b",mainTint:"#024279",activeButton:"#00746b",inlineWidth:"280px",annotationControls:"AnnotationControls---annotationControls",annotationContent:"AnnotationControls---annotationContent",subTitle:"AnnotationControls---subTitle",title:"AnnotationControls---title",sectionHeading:"AnnotationControls---sectionHeading",text:"AnnotationControls---text",padding:"AnnotationControls---padding",arrowTop:"AnnotationControls---arrowTop",arrowLeft:"AnnotationControls---arrowLeft",arrowRight:"AnnotationControls---arrowRight",inline:"AnnotationControls---inline",arrow:"AnnotationControls---arrow",arrowDs:"AnnotationControls---arrowDs",nothingSelected:"AnnotationControls---nothingSelected",anonymousMessage:"AnnotationControls---anonymousMessage",noNotes:"AnnotationControls---noNotes",breakButtons:"AnnotationControls---breakButtons"}},969:function(t,e,n){t.exports={"green-tint":"#88af8e","blue-tint":"#024279","active-button":"#00746b",mainTint:"#024279",activeButton:"#00746b",save:"Button---save",cancel:"Button---cancel",buttonContainer:"Button---buttonContainer"}},970:function(t,e,n){"use strict";var o=n(326),r=n.n(o),i=n(0),a=n.n(i),s=(o=n(973),n.n(o));function l(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var o,r,i=[],a=!0,s=!1;try{for(n=n.call(t);!(a=(o=n.next()).done)&&(i.push(o.value),!e||i.length!==e);a=!0);}catch(t){s=!0,r=t}finally{try{a||null==n.return||n.return()}finally{if(s)throw r}}return i}}(t,e)||function(t,e){if(t){if("string"==typeof t)return c(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}e.a=function(t){var e=t.max,n=(t.min,t.initialvalue),o=void 0===(t=t.changeSize)?function(t){return console.log(t)}:t,c=(t=n/e*100,(t=l(Object(i.useState)(t),2))[0]),u=t[1];t=r()((function(t){o(Math.floor(parseInt(c/100*e)))}),500);return a.a.createElement("div",{className:s.a.inputRanges},a.a.createElement("span",{style:{fontSize:13,top:"-5px"},onClick:function(){return o(n-2)}},"ཀ"),a.a.createElement("input",{type:"range",style:{width:"70%"},className:s.a.inputRange,min:40,max:100,smooth:"yes",step:1,value:c,onChange:function(t){return u(t.target.value)},onMouseUp:t,onTouchEnd:t}),a.a.createElement("span",{style:{fontSize:18,top:"-10px"},onClick:function(){return o(n+2)}},"ཀ"))}},973:function(t,e,n){t.exports={inputRanges:"Slider---inputRanges",inputRange:"Slider---inputRange"}},974:function(t,e,n){"use strict";var o=n(0),r=n.n(o);function i(){return(i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n,o=arguments[e];for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])}return t}).apply(this,arguments)}var a=r.a.createElement("path",{d:"M507.73 109.1c-2.24-9.03-13.54-12.09-20.12-5.51l-74.36 74.36-67.88-11.31-11.31-67.88 74.36-74.36c6.62-6.62 3.43-17.9-5.66-20.16-47.38-11.74-99.55.91-136.58 37.93-39.64 39.64-50.55 97.1-34.05 147.2L18.74 402.76c-24.99 24.99-24.99 65.51 0 90.5 24.99 24.99 65.51 24.99 90.5 0l213.21-213.21c50.12 16.71 107.47 5.68 147.37-34.22 37.07-37.07 49.7-89.32 37.91-136.73zM64 472c-13.25 0-24-10.75-24-24 0-13.26 10.75-24 24-24s24 10.74 24 24c0 13.25-10.75 24-24 24z"});e.a=function(t){return r.a.createElement("svg",i({viewBox:"0 0 512 512"},t),a)}},990:function(t,e,n){t.exports={"green-tint":"#88af8e","blue-tint":"#024279","active-button":"#00746b",mainTint:"#024279",activeButton:"#00746b",annotationDetail:"AnnotationDetail---annotationDetail",active:"AnnotationDetail---active",annotationHeader:"AnnotationDetail---annotationHeader",activeIcon:"AnnotationDetail---activeIcon",editing:"AnnotationDetail---editing",actionButtons:"AnnotationDetail---actionButtons",edit:"AnnotationDetail---edit",editImage:"AnnotationDetail---editImage",save:"AnnotationDetail---save",cancel:"AnnotationDetail---cancel"}}}]);