(window.webpackJsonpparkhang=window.webpackJsonpparkhang||[]).push([[3],{1003:function(t,e,n){t.exports={"green-tint":"#88af8e","blue-tint":"#024279","active-button":"#00746b",mainTint:"#024279",activeButton:"#00746b",inlineWidth:"280px",annotationControls:"SplitText---annotationControls",annotationContent:"SplitText---annotationContent",subTitle:"SplitText---subTitle",title:"SplitText---title",sectionHeading:"SplitText---sectionHeading",text:"SplitText---text",padding:"SplitText---padding",arrowTop:"SplitText---arrowTop",arrowLeft:"SplitText---arrowLeft",arrowRight:"SplitText---arrowRight",inline:"SplitText---inline",arrow:"SplitText---arrow",arrowDs:"SplitText---arrowDs",nothingSelected:"SplitText---nothingSelected",anonymousMessage:"SplitText---anonymousMessage",noNotes:"SplitText---noNotes",breakButtons:"SplitText---breakButtons",splitText:"SplitText---splitText",splitTextRowContent:"SplitText---splitTextRowContent",splitTextRow:"SplitText---splitTextRow",pechaImage:"SplitText---pechaImage",controlsPlaceholder:"SplitText---controlsPlaceholder",hide:"SplitText---hide",pageNumber:"SplitText---pageNumber",hightlighter:"SplitText---hightlighter",pulse:"SplitText---pulse"}},1004:function(t,e,n){t.exports={"green-tint":"#88af8e","blue-tint":"#024279","active-button":"#00746b",mainTint:"#024279",activeButton:"#00746b",textDetail:"TextDetail---textDetail",textContainer:"TextDetail---textContainer",tableContent:"TextDetail---tableContent"}},1005:function(t,e,n){t.exports={"green-tint":"#88af8e","blue-tint":"#024279","active-button":"#00746b",mainTint:"#024279",activeButton:"#00746b",button_group_menu:"textDetailHeading---button_group_menu"}},1006:function(t,e,n){t.exports={"green-tint":"#88af8e","blue-tint":"#024279","active-button":"#00746b",mainTint:"#024279",activeButton:"#00746b",selectVersion:"SelectVersion---selectVersion",selected:"SelectVersion---selected","styled-select":"SelectVersion---styled-select"}},1015:function(t,e,n){t.exports={textlist:"TextList---textlist",open:"TextList---open",listToggelBtn:"TextList---listToggelBtn"}},1044:function(t,e,n){"use strict";n.r(e);var o=n(963),r=n.n(o),i=(o=n(940),n.n(o)),a=(o=n(948),n.n(o)),s=n(0),l=n.n(s),c=(o=n(33),n(23)),u=n(132),p=n(91),f=n(133),d=n(46),h=n(62),y=n(61),m=n.n(y),g=(y=(n(161),n(937)),n.n(y)),b=(y=n(949),n.n(y)),v=(y=n(83),n.n(y)),w=(n(52),n(310)),x=n(309),S=n(255),O=(y=(n(448),n(982)),n.n(y)),E=(y=(n(170),n(308)),n.n(y)),A=(y=n(950),n.n(y));function T(){return(T=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n,o=arguments[e];for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])}return t}).apply(this,arguments)}function k(t){return l.a.createElement("svg",T({viewBox:"0 0 30 40",fill:"currentColor"},t),I,j,P)}var I=l.a.createElement("path",{d:"M3 0h24v15H3z"}),j=l.a.createElement("path",{stroke:"currentColor",strokeWidth:3,d:"M0 20h8M11 20h8M22 20h8"}),P=l.a.createElement("path",{d:"M3 25h24v15H3z"});function C(t){return(C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function R(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var o,r,i=[],a=!0,s=!1;try{for(n=n.call(t);!(a=(o=n.next()).done)&&(i.push(o.value),!e||i.length!==e);a=!0);}catch(t){s=!0,r=t}finally{try{a||null==n.return||n.return()}finally{if(s)throw r}}return i}}(t,e)||function(t,e){if(t){if("string"==typeof t)return _(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}function B(t,e){var n,o=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,n)),o}function W(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?B(Object(n),!0).forEach((function(e){var o,r;o=t,r=n[e=e],e in o?Object.defineProperty(o,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):o[e]=r})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):B(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function N(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function D(t,e){return(D=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function L(t){return(L=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function q(t){return"s_"+t.start}function H(t){return"ds_"+t.start}function M(t){return"i_"+t.start}function V(t){return"p_"+(t.end+1)}function z(t){return"l_"+(t.end+1)}var U=String.fromCharCode(182),F=A.a.renderToStaticMarkup(l.a.createElement(k,null)),Q=function(t){var e=o;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&D(e,t);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,o=L(t);n=e?(n=L(this).constructor,Reflect.construct(o,arguments,n)):o.apply(this,arguments),o=this;if(n&&("object"===C(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==o)return o;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(o);function o(t){var e;if(this instanceof o)return(e=n.call(this,t)).textAlignmentById=[],e.textRef=l.a.createRef(),e.state={segmentedText:t.segmentedText},e.textAlignmentById=e.props.textAlignmentById,e._renderedSegments=null,e._renderedHtml=null,e.rangeSelect=[],e;throw new TypeError("Cannot call a class as a function")}return e=o,(t=[{key:"UNSAFE_componentWillReceiveProps",value:function(t){this.setState((function(e,n){return W(W({},e),{},{segmentedText:t.segmentedText})}))}},{key:"annotationsForSegment",value:function(t){var e=[],n=this.props.annotationPositions[String(t.start)],o=this.props.annotationPositions[h.c+t.start]||[],r=this.props.annotationPositions[h.b+t.start]||[],i=this.props.annotationPositions[h.e+(t.end+1)]||[];t=this.props.annotationPositions[h.d+(t.end+1)]||[];return(e=n||e).concat(o,r,i,t)}},{key:"segmentsContainSegment",value:function(t,e){for(var n=0;n<t.length;n++){var o=t[n];if(o.start===e.start&&o.text===e.text)return!0}return!1}},{key:"selectedElement",value:function(t){var e=[],n=[],o=document.getSelection();if(null!=t&&t.id.includes("s_")&&this.props.isPanelLinked&&this.props.condition){var r=parseInt(t.id.replace("s_","")),i=(this.props.changeSyncIdOnClick(r),this.props.changeScrollToId({id:null,from:null}),parseInt(t.id.replace("s_",""))),a=this.textAlignmentById.find((function(t){return i>=t.start&&i<t.end}));if(a){for(var s=a.start;s<a.end;s++)e.push(s);for(var l=a.TStart;l<a.TEnd;l++)n.push(l);this.props.changeSelectedRange({source:e,target:n})}}o&&"Range"===o.type||(this.props.selectedSegmentId(t.id),t.id||this.props.changeSelectedRange({source:[],target:[]}))}},{key:"generateHtml",value:function(t,e){var n=this,o=e.segmentedText.segments,r=O.a.textLine,i='<p class="'+r+'">';if(0===o.length)return{__html:i};for(var a=O.a.insertion,s=o[o.length-1].end+1,l=(t.annotationPositions[h.c+s]&&(e=new d.a(s,""),o.push(e)),t.annotationPositions[h.e+s]&&(e=new d.a(s,""),o.push(e)),t.annotationPositions[h.d+s]&&(e=new d.a(s,""),o.push(e)),t.activeAnnotations||{}),u=O.a.highlight,p=O.a.activeHighlight,f=null,y={},g=0;g<o.length&&"break"!==function(e){var h=o[e],g=(e="",[]),b=n.annotationsForSegment(h),v=null,w=!1,x=!1,S=!1,E=!1,A=null;if(b){for(var T=[],k=[],I=[],j=[],P=0,C=b.length;P<C;P++){var _,B=b[P];B.isInsertion?B.uniqueId in l?T.push(B):(_=B.start,y.hasOwnProperty(_)||(k.push(B),y[_]=B)):B.isDeletion?B.uniqueId in l&&j.push(B):B.type!==c.a.pageBreak||t.activeWitness.isWorking?B.type!==c.a.lineBreak||t.activeWitness.isWorking?I.push(B):E=B:A=B}0===T.length&&0<k.length&&(W=k[0],N=M(h),D=a,t.activeAnnotation&&t.activeAnnotation.isInsertion&&t.activeAnnotation.start===W.start&&(D+=" "+O.a.selectedAnnotation),i+="<span id="+N+" key="+N+' class="'+D+'">'+W.content+"</span>"),0<j.length&&(N=j[0],v=t.getBaseAnnotation(N).content,t.activeAnnotation&&t.activeAnnotation.isDeletion&&t.activeAnnotation.start===N.start&&t.activeAnnotation.length===N.length&&0===h.length&&(w=!0)),A&&t.activeAnnotation&&t.activeAnnotation.uniqueId===A.uniqueId&&(x=!0),E&&t.activeAnnotation&&t.activeAnnotation.uniqueId===E.uniqueId&&(S=!0),(0<I.length||0<T.length)&&g.push(O.a.annotation)}if(h.start===s)return"break";var W,N,D=null,L=(0===h.length?(D=H(h),g.push(O.a.removedByAnnotation),v&&(h=new d.a(h.start,v))):D=q(h),(n.segmentsContainSegment(t.selectedAnnotatedSegments,h)||w)&&g.push(O.a.selectedAnnotation),t.selectedSourceRange.includes(h.start)&&g.push(O.a.selectedRange),0<g.length&&(e='class="'+m.a.apply(void 0,g)+'"'),h.text);if(t.searchStringPositions){var Q=h.start,G=Q,$=(L="",u);t.selectedSearchResult&&t.selectedSearchResult.start<=G&&t.selectedSearchResult.start+t.selectedSearchResult.length>G&&($=p);for(var J=0;J<h.text.length;J++){var X,Z,K,Y=h.text.charAt(J);G=Q+J;f?((X=R(f,2))[0],0===J&&(L+='<span class="'+$+'">'),G===X[1]?(L+=Y+"</span>",f=null):J===h.text.length-1?L+=Y+"</span>":L+=Y):G in t.searchStringPositions?(Z=(X=R(t.searchStringPositions[G],2))[0],K=X[1],L+='<span class="'+$+'">'+Y,J!==h.text.length-1&&G!==K||(L+="</span>"),G<K&&(f=[Z,K])):L+=Y}}null!==n.props.textAlignmentById&&(W=n.props.textAlignmentById.find((function(t){return t.start===h.start})))&&(i+="<span id='alignment_"+h.start+"'><sup class="+O.a.syncIdClass+">".concat(W.id,"</sup>")+"</span>"),i+="<span id="+D+" key="+D+" "+e+">"+L+"</span>",A&&(N=[O.a.pageBreak],x&&N.push(O.a.selectedAnnotation),v=' class="'+N.join(" ")+'" ',i+="<span id="+V(h)+" key="+V(h)+v+">"+F+"</span>"),E&&(w=[O.a.lineBreak],S&&w.push(O.a.selectedAnnotation),g=' class="'+w.join(" ")+'" ',i=(i+="<span id="+z(h)+" key="+z(h)+g+">"+U+"</span>")+'</p><p class="'+r+'">')}(g);g++);return this._renderedSegments=o,{__html:i+="</p>"}}},{key:"shouldComponentUpdate",value:function(t,e){return e=this.generateHtml(t,e),this.props.fontSize!==t.fontSize||(!this._renderedHtml||e.__html!==this._renderedHtml.__html)&&(this._renderedHtml=e,!0)}},{key:"render",value:function(){var t=this,e=[O.a.text],n=(0===this.props.row&&e.push(O.a.textFirstRow),this._renderedHtml||this.generateHtml(this.props,this.state));return this._renderedHtml||(this._renderedHtml=n),l.a.createElement("div",{className:O.a.textContainer},l.a.createElement("div",{ref:this.textRef,className:m.a.apply(void 0,e),dangerouslySetInnerHTML:n,style:{fontSize:this.props.fontSize,cursor:this.props.isAnnotating?"text":"pointer"},onClick:function(e){t.selectedElement(e.target)}}))}}])&&N(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),o}(l.a.Component),G=n(935),$=n(197),J=(y=n(951),n.n(y));function X(){return(X=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n,o=arguments[e];for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])}return t}).apply(this,arguments)}function Z(t){return l.a.createElement("svg",X({viewBox:"0 0 24 24"},t),K,Y)}var K=l.a.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),Y=l.a.createElement("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"}),tt=(y=n(258),n.n(y)),et=n(985);function nt(t){var e=t.children,n=t.tooltipName,o=void 0===(o=t.format)?null:o,r=t.effect,i=t.className;return t.setTimer,l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{"data-tip":!0,"data-for":n,className:void 0===i?"":i,style:{width:"100%"}},e),l.a.createElement(et.a,{id:n,type:"dark",effect:void 0===r?"solid":r},o?l.a.createElement($.a,{id:o}):l.a.createElement("span",null,n)))}function ot(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}function rt(t){(e=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var o,r,i=[],a=!0,s=!1;try{for(n=n.call(t);!(a=(o=n.next()).done)&&(i.push(o.value),!e||i.length!==e);a=!0);}catch(t){s=!0,r=t}finally{try{a||null==n.return||n.return()}finally{if(s)throw r}}return i}}(t,e)||function(t,e){if(t){if("string"==typeof t)return ot(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ot(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(Object(s.useState)(null),2))[0],e[1];var e=l.a.createElement("p",null,"<",l.a.createElement($.a,{id:"annotation.delete"}),">"),n=(""!==(n=t.annotationData.content).trim()&&(250<n.length&&(n=n.substr(0,250)+"…"),e=l.a.createElement("p",null,n)),[J.a.annotationDetail]);t.isActive&&n.push(J.a.active),n=m.a.apply(void 0,n);return l.a.createElement("div",{className:n,onClick:t.selectAnnotationHandler},l.a.createElement("div",{className:J.a.annotationHeader},t.isActive&&l.a.createElement("div",{className:J.a.activeIcon},l.a.createElement(Z,{style:{fill:tt.a.activeButton},width:15,height:15})),l.a.createElement("h3",null,t.annotationData.name),t.isLoggedIn&&t.isActive&&l.a.createElement("button",{style:{display:"none"},className:J.a.edit,onClick:t.editAnnotationHandler,id:"editBtn"})),!t.isWorkingSection&&e)}function it(t){var e=t.annotationData.content,n=[J.a.annotationDetail],o=null;t.isActive&&n.push(J.a.active),n=m.a.apply(void 0,n);return l.a.createElement("div",{className:n},l.a.createElement("h3",null,t.annotationData.name),l.a.createElement("div",{className:J.a.editing},l.a.createElement("textarea",{defaultValue:e,autoFocus:!0,onInput:function(t){o.style.height="5px",o.style.height=o.scrollHeight+"px"},ref:function(t){return o=t}}),l.a.createElement("div",{className:J.a.actionButtons},l.a.createElement("div",{className:J.a.save,onClick:function(){o&&t.saveAnnotationHandler(o.value)}},l.a.createElement($.a,{id:"annotation.save"})),l.a.createElement("div",{className:J.a.cancel,onClick:t.cancelAnnotationHandler},l.a.createElement($.a,{id:"annotation.cancel"})))))}function at(t){return l.a.createElement("div",{className:ut.a.button,title:t.title,onClick:t.onClick},"+")}y=n(936);var st=n.n(y),lt=(y=(n(72),n(43)),n(988)),ct=n.n(lt),ut=(lt=n(989),n.n(lt));function pt(t){return(pt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ft(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function dt(t,e){return(dt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function ht(t){return(ht=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}lt=function(t){var e=o;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&dt(e,t);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,o=ht(t);n=e?(n=ht(this).constructor,Reflect.construct(o,arguments,n)):o.apply(this,arguments),o=this;if(n&&("object"===pt(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==o)return o;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(o);function o(){var t=this,e=o;if(t instanceof e)return n.apply(this,arguments);throw new TypeError("Cannot call a class as a function")}return e=o,(t=[{key:"render",value:function(){var t,e=null;return this.props.buttonOnClick&&(t=this.props.buttonTitleId?this.props.intl.formatMessage({id:this.props.buttonTitleId}):"",e=l.a.createElement(at,{title:t,onClick:this.props.buttonOnClick})),l.a.createElement("h3",{className:ct.a.heading},l.a.createElement("span",{className:ct.a.title},l.a.createElement($.a,{id:this.props.titleId})),e&&l.a.createElement("div",{className:ct.a.button},e))}}])&&ft(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),o}(l.a.Component),Object(y.c)(lt),lt=n(990);var yt=n.n(lt),mt=(lt=n(938),n.n(lt));function gt(t){return(gt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function bt(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function vt(t,e){return(vt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function wt(t){return(wt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var xt=function(t){var e=o;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&vt(e,t);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,o=wt(t);n=e?(n=wt(this).constructor,Reflect.construct(o,arguments,n)):o.apply(this,arguments),o=this;if(n&&("object"===gt(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==o)return o;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(o);function o(t){var e;if(this instanceof o)return(e=n.call(this,t)).state={content:t.note.content},e;throw new TypeError("Cannot call a class as a function")}return e=o,(t=[{key:"save",value:function(){var t=this.textarea?this.textarea.value:"";this.props.saveNote(this.props.note,t)}},{key:"cancel",value:function(){this.props.cancel()}},{key:"handleChange",value:function(t){var e=t.target instanceof HTMLTextAreaElement?t.target.value:"";this.setState((function(t,n){return{content:e}}))}},{key:"render",value:function(){var t=this;return l.a.createElement("div",{className:yt.a.editorContainer},l.a.createElement("textarea",{className:yt.a.textEditor,ref:function(e){return t.textarea=e},value:this.state.content,onChange:this.handleChange.bind(this)}),l.a.createElement("div",{className:mt.a.buttonContainer},l.a.createElement("div",{className:mt.a.save,onClick:this.save.bind(this)},l.a.createElement($.a,{id:"annotation.save"})),l.a.createElement("div",{className:mt.a.cancel,onClick:this.cancel.bind(this)},l.a.createElement($.a,{id:"annotation.cancel"}))))}}])&&bt(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),o}(l.a.Component),St=(lt=n(991),n.n(lt)),Ot=(lt=(n(257),n(992)),n.n(lt)),Et=(n(195),n(169));function At(t){return(At="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Tt(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function kt(t,e){return(kt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function It(t){return(It=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var jt=function(t){var e=o;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&kt(e,t);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,o=It(t);n=e?(n=It(this).constructor,Reflect.construct(o,arguments,n)):o.apply(this,arguments),o=this;if(n&&("object"===At(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==o)return o;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(o);function o(){var t=this,e=o;if(t instanceof e)return n.apply(this,arguments);throw new TypeError("Cannot call a class as a function")}return e=o,(t=[{key:"render",value:function(){return l.a.createElement("div",{className:Ot.a.answer},l.a.createElement("p",{className:st.a.text,dangerouslySetInnerHTML:{__html:this.props.answer.content}}),l.a.createElement("p",{className:st.a.subTitle},l.a.createElement($.a,{id:"question.answeredBy"})," ",this.props.answer.name,","," ",l.a.createElement(Et.FormattedDate,{value:this.props.answer.created})))}}])&&Tt(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),o}(l.a.Component),Pt=n(66);function Ct(t){return(Ct="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Rt(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function _t(t,e){return(_t=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Bt(t){return(Bt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Wt=function(t){var e=o;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_t(e,t);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,o=Bt(t);n=e?(n=Bt(this).constructor,Reflect.construct(o,arguments,n)):o.apply(this,arguments),o=this;if(n&&("object"===Ct(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==o)return o;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(o);function o(){var t=this,e=o;if(t instanceof e)return n.apply(this,arguments);throw new TypeError("Cannot call a class as a function")}return e=o,(t=[{key:"render",value:function(){var t=Pt.f+this.props.question.topicId,e=[],n=this.props.question.answers;console.log(n);for(var o=0;o<n.length;o++){var r=n[o];e.push(l.a.createElement(jt,{answer:r,key:"answer_"+r.created}))}var i=0<this.props.question.name.length?this.props.question.name:this.props.question.username;return l.a.createElement("div",{className:m()(St.a.question,st.a.padding)},l.a.createElement("span",{className:m()(St.a.threadLink,st.a.text)},l.a.createElement("a",{href:t,target:"_blank"},l.a.createElement($.a,{id:"question.viewThread"}))),l.a.createElement("p",{className:st.a.text,dangerouslySetInnerHTML:{__html:this.props.question.content}}),l.a.createElement("p",{className:st.a.subTitle},i,","," ",l.a.createElement(Et.FormattedDate,{value:this.props.question.created})),e)}}])&&Rt(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),o}(l.a.Component),Nt=(lt=n(993),n.n(lt));function Dt(t){return(Dt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Lt(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function qt(t,e){return(qt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Ht(t){return(Ht=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Mt=function(t){var e=o;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&qt(e,t);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,o=Ht(t);n=e?(n=Ht(this).constructor,Reflect.construct(o,arguments,n)):o.apply(this,arguments),o=this;if(n&&("object"===Dt(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==o)return o;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(o);function o(t){var e;if(this instanceof o)return(e=n.call(this,t)).state={content:t.question.content},e;throw new TypeError("Cannot call a class as a function")}return e=o,(t=[{key:"save",value:function(){var t=this.textarea?this.textarea.value:"";this.props.saveQuestion(this.props.question,this.props.defaultTitle,t)}},{key:"cancel",value:function(){this.props.cancel()}},{key:"handleChange",value:function(t){var e=t.target instanceof HTMLTextAreaElement?t.target.value:"";this.setState((function(t,n){return{content:e}}))}},{key:"render",value:function(){var t=this;return l.a.createElement("div",{className:Nt.a.editorContainer},l.a.createElement("div",null,this.props.questionQuote),l.a.createElement("textarea",{className:Nt.a.textEditor,ref:function(e){return t.textarea=e},value:this.state.content,onChange:this.handleChange.bind(this)}),l.a.createElement("div",{className:mt.a.buttonContainer},l.a.createElement("div",{className:mt.a.save,onClick:this.save.bind(this)},l.a.createElement($.a,{id:"annotation.save"})),l.a.createElement("div",{className:mt.a.cancel,onClick:this.cancel.bind(this)},l.a.createElement($.a,{id:"annotation.cancel"}))))}}])&&Lt(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),o}(l.a.Component),Vt=(lt=n(994),n.n(lt)),zt=(lt=n(311),n.n(lt));function Ut(t){return(Ut="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ft(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Qt(t,e){return(Qt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Gt(t){return(Gt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var $t=function(t){var e=o;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Qt(e,t);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,o=Gt(t);n=e?(n=Gt(this).constructor,Reflect.construct(o,arguments,n)):o.apply(this,arguments),o=this;if(n&&("object"===Ut(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==o)return o;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(o);function o(){var t=this,e=o;if(t instanceof e)return n.apply(this,arguments);throw new TypeError("Cannot call a class as a function")}return e=o,(t=[{key:"render",value:function(){return l.a.createElement("div",{className:m()(Vt.a.loading,st.a.text)},l.a.createElement(zt.a,{loaded:!1,scale:.25,position:"relative",top:"50%",left:"50%",lines:9,width:8,length:8,radius:14}),"Loading questions...")}}])&&Ft(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),o}(l.a.Component),Jt=(lt=n(995),n.n(lt));function Xt(t){return(Xt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Zt(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Kt(t,e){return(Kt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Yt(t){return(Yt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var te=function(t){var e=o;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Kt(e,t);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,o=Yt(t);n=e?(n=Yt(this).constructor,Reflect.construct(o,arguments,n)):o.apply(this,arguments),o=this;if(n&&("object"===Xt(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==o)return o;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(o);function o(){var t=this,e=o;if(t instanceof e)return n.apply(this,arguments);throw new TypeError("Cannot call a class as a function")}return e=o,(t=[{key:"delete",value:function(){this.props.delete&&this.props.delete(this.props.note)}},{key:"edit",value:function(){this.props.edit&&this.props.edit(this.props.note)}},{key:"render",value:function(){return l.a.createElement("div",{className:Jt.a.note},l.a.createElement("div",{className:Jt.a.header},l.a.createElement("h4",{className:Jt.a.info},this.props.note.creatorUser.name),this.props.delete&&l.a.createElement("div",{className:Jt.a.delete,onClick:this.delete.bind(this)},"×")),l.a.createElement("div",{className:Jt.a.content,onClick:this.edit.bind(this)},this.props.note.content))}}])&&Zt(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),o}(l.a.Component),ee=n(318),ne=(lt=n(996),n.n(lt));function oe(){return(oe=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n,o=arguments[e];for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])}return t}).apply(this,arguments)}function re(t){return l.a.createElement("svg",oe({viewBox:"0 0 24 24"},t),ie,ae)}var ie=l.a.createElement("path",{d:"M3 18h12v-2H3v2zM3 6v2h18V6H3zm0 7h18v-2H3v2z"}),ae=l.a.createElement("path",{fill:"none",d:"M0 0h24v24H0V0z"});function se(){return(se=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n,o=arguments[e];for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])}return t}).apply(this,arguments)}function le(t){return l.a.createElement("svg",se({viewBox:"0 0 24 24",fill:"currentColor"},t),ce,ue)}var ce=l.a.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),ue=l.a.createElement("path",{d:"M21 6h-2v9H6v2c0 .55.45 1 1 1h11l4 4V7c0-.55-.45-1-1-1zm-4 6V3c0-.55-.45-1-1-1H3c-.55 0-1 .45-1 1v14l4-4h10c.55 0 1-.45 1-1z"}),pe=(lt=(n(1024),n(316)),n.n(lt));function fe(t){return(fe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function de(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function he(t,e){return(he=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function ye(t){return(ye=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var me=function(t){var e=o;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&he(e,t);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,o=ye(t);n=e?(n=ye(this).constructor,Reflect.construct(o,arguments,n)):o.apply(this,arguments),o=this;if(n&&("object"===fe(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==o)return o;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(o);function o(){if(this instanceof o)return n.call(this);throw new TypeError("Cannot call a class as a function")}return e=o,(t=[{key:"render",value:function(){var t=null!=this.props.addPageBreak,e=null!=this.props.addLineBreak;return l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:ne.a.header},l.a.createElement(ee.a,{noBezel:!0,icon:l.a.createElement(re,{width:21,height:21,style:{fill:"#1A73E8"}}),backgroundColor:"transparent",accessoryType:this.props.addNote?"ADD":null,onClick:this.props.addNote,disabled:!this.props.addNote,align:"center"}),l.a.createElement(ee.a,{noBezel:!0,icon:l.a.createElement(le,{width:21,height:21,style:{fill:"#F2A41F"}}),accessoryType:this.props.addQuestion?"ADD":null,onClick:this.props.addQuestion,disabled:!this.props.addQuestion,align:"left",backgroundColor:"transparent"}),l.a.createElement(ee.a,{noBezel:!0,color:"#1E8E3E",fontSize:"18px",icon:"¶",accessoryType:e?"ADD":null,onClick:this.props.addLineBreak,disabled:!e,align:"left",backgroundColor:"transparent"}),l.a.createElement(ee.a,{noBezel:!0,icon:l.a.createElement(k,{width:21,height:21,style:{fill:"darkgray"}}),accessoryType:t?"ADD":null,onClick:this.props.addPageBreak,disabled:!t,align:"left",backgroundColor:"transparent"}),l.a.createElement(nt,{format:"annotation.edit"},l.a.createElement("div",{onClick:this.props.editAnnotationHandler,className:ne.a.edit},l.a.createElement(pe.a,null)))))}}])&&de(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),o}(l.a.Component);function ge(t){return(ge="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function be(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function ve(t,e){return(ve=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function we(t){return(we=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}lt=function(t){var e=o;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ve(e,t);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,o=we(t);n=e?(n=we(this).constructor,Reflect.construct(o,arguments,n)):o.apply(this,arguments),o=this;if(n&&("object"===ge(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==o)return o;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(o);function o(t){if(this instanceof o)return(t=n.call(this,t)).controls=null,t.arrow=null,t.arrowDs=null,t;throw new TypeError("Cannot call a class as a function")}return e=o,(t=[{key:"componentDidMount",value:function(){this.updatePosition()}},{key:"componentDidUpdate",value:function(){setTimeout(this.updatePosition.bind(this),0),this.fakeLogin=this.props.fake_login_togle}},{key:"updatePosition",value:function(){var t=this.getMeasurements();if(this.props.inline&&this.controls&&this.arrow&&t){var e=this.controls,n=e.offsetHeight,o=e.offsetWidth,r=this.arrow,i=t.bottomGap,a=i<0||n<i,s=t.top,l=t.viewPortWidth||0,c=t.left,u=c+t.width;if(this.props.selectedElementIds)for(var p=0,f=0,d=0;d<this.props.selectedElementIds.length;d++){var h,y,m=this.props.selectedElementIds[d];(m=document.getElementById(m))&&(y=(h=m.offsetLeft)+m.offsetWidth,h<p?(m.offsetTop,m.offsetHeight,c=h,u=f=y):f<y&&(f=y),h<c&&(c=h),u<y&&(u=y),p=h)}var g=u-c,b=3,v=!1,w=0;(v=!a&&i<n||v)?(r.className=st.a.arrowLeft,b=c-o-r.offsetWidth<0?4:2):(c-(a=o/2-g/2)<0&&(w=Math.abs(c-a)),l<u+a&&(w=l-(u+a))),3===b?(a=l=0,this.arrow&&(this.arrow.className=st.a.arrowTop,a=o/2-this.arrow.offsetWidth/2-w,this.arrow.style.left=(a=a<0?0:a)+"px",l=this.arrow.offsetHeight,this.arrow.style.top=0-l+"px"),e.style.top=s+t.height+l+"px",e.style.left=c+g/2-o/2+w+"px"):v?(r.className=st.a.arrowRight,a=r.offsetHeight,l=t.top+t.height/2-a/2,t.top+t.height+i-l<n&&(l=t.top+t.height+i-n),2===b?(r.style.left=o-2+"px",e.style.left=c-o-r.offsetWidth+"px"):(r.className=st.a.arrowLeft,r.style.left=-r.offsetWidth+"px",e.style.left=c+g+r.offsetWidth+"px"),r.style.top=t.top-l+t.height/2-a/2+"px",e.style.top=l+"px"):e.style.top=s+"px"}}},{key:"getMeasurements",value:function(){if(!this.props.selectedElementIds)return null;var t=this.props.selectedElementIds[this.props.selectedElementIds.length-1],e=(t=document.getElementById(t),this.props.selectedElementIds[0]),n=(e=document.getElementById(e),this.props.splitTextRect),o=0;if(this.props.list&&this.props.list.Grid.state.scrollTop,this.props.pechaImageClass&&(o=document.getElementsByClassName(this.props.pechaImageClass)[0].offsetHeight),!t)return console.warn("no valid element found in getMeasurements, elementId: %s",this.props.selectedElementId),{top:0,textTop:0,rowTop:0,left:0,width:1,height:1,topGap:0,bottomGap:0,viewPortWidth:1};o=t.offsetTop+o;var r=t.offsetTop,i=t.offsetLeft,a=t.offsetWidth,s=t.offsetHeight,l=o,c=null,u=0,p=0;return t&&n&&(t=t.getBoundingClientRect(),p=n.height+n.top-t.bottom,c=n.width),e&&n&&(t=e.getBoundingClientRect(),u=n.height-t.top),{top:o,textTop:r,rowTop:l,left:i,width:a,height:s,topGap:u,bottomGap:p,viewPortWidth:c}}},{key:"render",value:function(){var t,e,n=this,o=this.props,r=[],i=[],a=null,l=null,u=o.user.isLoggedIn,p=!1,f=(o.activeAnnotation&&(o.activeAnnotation.isType(c.a.pageBreak)||o.activeAnnotation.isType(c.a.lineBreak))&&(p=!0),o.annotationsData?(o.annotationsData.map((function(t){var e,a=!1,l=!1;t.isTemporary?l=a=!0:o.temporaryAnnotation||t.annotation.uniqueId!=o.activeAnnotation.uniqueId||(l=!0),a?(e=s.createElement(it,{annotationData:t,key:t.annotation.uniqueId,isActive:l,saveAnnotationHandler:function(e){o.saveAnnotation(t.annotation,e)},cancelAnnotationHandler:function(){o.cancelEditAnnotation(t.annotation)},isLoggedIn:u,selectAnnotationHandler:function(){},editAnnotationHandler:function(){}}),i.push(e)):(e=s.createElement(rt,{isWorkingSection:!1,fontSize:o.fontSize,annotationData:t,key:t.annotation.uniqueId,isActive:l,selectAnnotationHandler:function(){u&&!a&&o.didSelectAnnotation(t.annotation)},editAnnotationHandler:function(){u&&!a&&(n.annotation=t.annotation,o.editAnnotation(t.annotation))},isLoggedIn:u}),r.push(e))}),this),o.user.isLoggedIn||(a=s.createElement("div",{className:st.a.anonymousMessage,style:{position:"relative",background:"#eee",width:"fit-content",border:"1px solid gray",paddingInline:10}},s.createElement($.a,{id:"annotations.loginMessage",values:{loginLink:s.createElement("a",{href:"/accounts/login/"},s.createElement($.a,{id:"annotations.loginLink"}))}})))):l=s.createElement("div",{className:st.a.nothingSelected},"Nothing Selected"),null),d=!this.props.selectedWitness.isWorking,h=null,y=!this.props.selectedWitness.isWorking,g=(u&&!this.props.selectedWitness.isWorking&&(t=[],e=[],this.props.availableAnnotations&&(t=this.props.availableAnnotations.filter((function(t){return t.type===c.a.pageBreak&&t.creatorWitness.id===n.props.selectedWitness.id})),e=this.props.availableAnnotations.filter((function(t){return t.type===c.a.lineBreak&&t.creatorWitness.id===n.props.selectedWitness.id}))),0<t.length&&(f=s.createElement("div",{className:st.a.breakButtons},s.createElement(ee.a,{title:"Page Break",accessoryType:"DELETE",icon:s.createElement(k,{width:20,height:20}),onClick:function(){n.props.deleteAnnotation(t[0])},isActive:!0,backgroundColor:tt.a.activeButton})),d=!1),0<e.length&&(h=s.createElement("div",{className:st.a.breakButtons},s.createElement(ee.a,{title:"Line Break",accessoryType:"DELETE",icon:"¶",onClick:function(){n.props.deleteAnnotation(e[0])},isActive:!0,backgroundColor:tt.a.activeButton})),y=!1),(y=!!d&&y)||(d=!1)),null),b={},v=(o.temporaryNotes&&0<o.temporaryNotes.length&&(g=o.temporaryNotes.map((function(t){var e="NOTE_"+t.uniqueId;return t.basedOn&&(b[t.basedOn.uniqueId]=t.uniqueId),s.createElement(xt,{note:t,key:e,saveNote:o.saveAnnotation,cancel:function(){return o.cancelEditAnnotation(t)}})}))),null),w=(o.notes&&0<o.notes.length&&(v=o.notes.filter((function(t){return!b.hasOwnProperty(t.uniqueId)})).map((function(t){var e="NOTE_"+t.uniqueId;return s.createElement(te,{note:t,key:e,delete:n.props.deleteAnnotation,edit:n.props.editNote})}))),null),x={},S=(o.temporaryQuestions&&0<o.temporaryQuestions.length&&o.questionQuote&&(w=o.temporaryQuestions.map((function(t){x[t.uniqueId]=t.uniqueId;var e="QUESTION_"+t.uniqueId;return s.createElement(Mt,{question:t,questionQuote:o.questionQuote,defaultTitle:o.selectedWitness.text.name,key:e,saveQuestion:o.saveQuestion,cancel:function(){return o.cancelEditAnnotation(t)}})}))),[]),O=!1;if(o.questions&&0<o.questions.length){for(var E=[],A=0;A<o.questions.length;A++){var T=o.questions[A];!x.hasOwnProperty(T.uniqueId)&&o.questionsData.hasOwnProperty(T.uniqueId)&&(o.questionsData[T.uniqueId].loading&&(O=!0),E=E.concat(o.questionsData[T.uniqueId].questions))}S=E.map((function(t){return t.annotationUniqueId,s.createElement(Wt,{question:t,key:"question_"+t.annotationUniqueId})}))}var I=null,j=(0<S.length&&(I=s.createElement("h3",{className:st.a.sectionHeading},"Questions")),null),P=(O&&(j=s.createElement($t,null)),0===o.questions.length&&0===o.temporaryQuestions.length),C=[st.a.annotationControls],R=(o.inline&&C.push(st.a.inline),!0);return(a||p)&&(R=!1),s.createElement("div",{className:m.a.apply(void 0,C),ref:function(t){return n.controls=t}},R&&s.createElement(me,{addPageBreak:d?o.addPageBreak:null,addLineBreak:y?o.addLineBreak:null,addNote:u&&!g?function(){return o.addNote()}:null,addQuestion:P?o.addQuestion:null,closeAnnotation:o.closeAnnotation,editAnnotationHandler:function(){var t=document.getElementById("editBtn");null!=t&&t.click()},userLoggedIn:u}),s.createElement("div",{className:st.a.annotationContent},a,l,!p&&i,!p&&r,f,h,g,v,I,w,j,S),s.createElement("div",{className:st.a.arrow,ref:function(t){return n.arrow=t}}))}}])&&be(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),o}(s.Component);var xe=n(997),Se=n.n(xe),Oe=n(64),Ee=n(341),Ae=n(6),Te=n(2);function ke(t,e){var n,o=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,n)),o}function Ie(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ke(Object(n),!0).forEach((function(e){var o,r;o=t,r=n[e=e],e in o?Object.defineProperty(o,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):o[e]=r})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ke(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function je(t){return function(t){if(Array.isArray(t))return Re(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||Ce(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Pe(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var o,r,i=[],a=!0,s=!1;try{for(n=n.call(t);!(a=(o=n.next()).done)&&(i.push(o.value),!e||i.length!==e);a=!0);}catch(t){s=!0,r=t}finally{try{a||null==n.return||n.return()}finally{if(s)throw r}}return i}}(t,e)||Ce(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ce(t,e){if(t){if("string"==typeof t)return Re(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Re(t,e):void 0}}function Re(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}function _e(t,e,n,o){var r=[],i=e.filter((function(t){return t.isWorking||t.isBase})).map((function(t){return t.name}));if(t){for(var a={},s=0;s<t.length;s++)!function(e){var n=t[e];e=n.content+n.start;n.isTemporary?(a[Be]={name:n.getSourceName(),content:n.content,id:n.uniqueId,isTemporary:!0,annotation:n},i=i.filter((function(t){return t!==n.getSourceName()})),e=Be):i=a[e]?(a[e].name+=" "+Object(Ee.a)(n.getSourceName()),i.filter((function(t){return t!==n.getSourceName()}))):(a[e]={name:Object(Ee.a)(n.getSourceName()),content:n.content,id:n.uniqueId,userCreated:n.userCreated,annotation:n},i.filter((function(t){return t!==n.getSourceName()}))),!n.userCreated&&n.creatorWitness.isWorking?a[e].isWorking=!0:a[e].isWorking=!1}(s);i.unshift(n);var l=i;"བྱང་ཆུབ་སེམས་དཔའི་སྤྱོད་པ་ལ་འཇུག་པ་བཞུགས་སོ།"!==(null==o?void 0:o.name)&&(l=i.filter((function(t){return"Dominant"!==t}))),r=Object.keys(a).reduce((function(t,e){return(e=a[e]).isWorking&&(e.name=l.reduce((function(t,e){return t+" "+Object(Ee.a)(e,";")}),"")),t.push(e),t}),[])}return r}var Be=-3,We=Object(o.connect)((function(t,e){var n=Ae.gb(t),o=Ae.G(t),r=e.activeAnnotation,a=e.inline,s=Ae.I(t);if(s||o&&(s=Ae.mb(t,o.id)),!r||!s)return{annotationsData:null,activeAnnotation:null,baseAnnotation:null,availableAnnotations:null,user:n,temporaryAnnotation:null,inline:null,firstSelectedSegment:null,splitTextRect:null,selectedWitness:null};var u=function(t,e,n,o,r){return 0<(t=Ae.S(t,n.id,o,r,e)).length?t[0]:null}(t,c.a.variant,s,r.start,r.length),p=function(t,e,n,o){var r=[];n&&e.naturalId===n.naturalId||r.push(e),n&&r.push(n);var a=(s=Pe(t.getPositionOfAnnotation(e),2))[0],s=s[1];if(a){s=a+s;var l,u=[];e.isInsertion?((l=o["i"+a])&&(u=u.concat(l)),(l=o[String(a)])&&(u=u.concat(l))):((l=o[String(a)])&&(u=l),(a=o[String(s)])&&(u=u.concat(a)));for(var p=0;p<u.length;p++){var f=u[p];f.start===e.start&&f.length===e.length?n&&f.naturalId===n.naturalId||r.push(f):t.activeWitness.isWorking||f.type!==c.a.pageBreak&&f.type!==c.a.lineBreak||r.push(f)}r=i()(r,(function(t,e){return t.id===e.id}))}return r}(e.annotatedText,r,u,e.annotationPositions),f=_e(f=p.filter((function(t){return t.type===c.a.variant})),y=Ae.O(t),E=Ae.fb(t,"annotation.workingEdition","Working"),o),d=(o=null,r.id==h.a?o=r:(A=(d=Pe(e.annotatedText.getPositionOfAnnotation(r),2))[0],d=d[1],f=null===A||null===d?null:(A=_e([o=e.annotatedText.getBaseAnnotation(A,d)],y,E),[].concat(je(A),je(f)))),f&&f.sort((function(t,e){return t.isTemporary?-1:e.isTemporary?1:t.userCreated?-1:!e.userCreated&&t.annotation.id&&e.annotation.id?t.annotation.id-e.annotation.id:1})),p.filter((function(t){return t.type===c.a.note}))),y=Ae.S(t,s.id,r.start,r.length,c.a.note),m=p.filter((function(t){return t.type===c.a.question})),g={};if(0<m.length)for(var b=0;b<m.length;b++){var v=m[b],w=(g[v.uniqueId]={},Ae.wb(t,v));w=(g[v.uniqueId].loading=w,Ae.u(t,v.uniqueId));g[v.uniqueId].questions=w}var x,S,O,E,A=null,T=(0<(E=Ae.S(t,s.id,r.start,r.length,c.a.question)).length&&(T=E[0],S=(T=Pe(e.annotatedText.getPositionOfAnnotation(T),2))[0],T=T[1],S&&(T=(S=Pe(e.annotatedText.segmentedText.extractTextAroundPosition(S,T=T||S+1,["།"," "]),3))[0],x=S[1],S=S[2],O=document.location.href,A=l.a.createElement("blockquote",null,T,l.a.createElement("a",{href:O},x),S))),Object(Ae.X)(t));return{annotationsData:f,activeAnnotation:r,baseAnnotation:o,availableAnnotations:p,user:n,temporaryAnnotation:u,inline:a,firstSelectedSegment:e.firstSelectedSegment,splitTextRect:e.splitTextRect,selectedWitness:s,notes:d,temporaryNotes:y,questions:m,temporaryQuestions:E,questionsData:g,questionQuote:A,fontSize:T}}),null,(function(t,e,n){var o=e.dispatch;if(0<t.questions.length)for(var r=0;r<t.questions.length;r++){var i=t.questions[r],a=!0;(a=(!t.questionsData.hasOwnProperty(i.uniqueId)||!(0<t.questionsData[i.uniqueId].questions.length||t.questionsData[i.uniqueId].loading))&&a)&&o(new Te.kc(i))}function s(e){var r=1<arguments.length&&void 0!==arguments[1]&&arguments[1];return function(){var i=n.activeAnnotation,a=(i=new c.c(null,i.witness,i.end+1,0,null,e,t.selectedWitness,t.user),Ae.d(t.selectedWitness)),s=[];s.push(Te.dc(i)),s.push(Te.Hb(i.uniqueId,a)),r?s.push(Te.Vb(i)):s.push(Te.Vb(null)),o(Object(Oe.batchActions)(s))}}function l(e,n){var r,i,a;e.isTemporary?(r=t.selectedWitness,r=Ae.d(r),(n=new c.c(e.id,e.witness,e.start,e.length,n,e.type,e.creatorWitness,t.user,e.uniqueId,e.basedOn)).isSaved=e.isSaved,i=[],a=null,a=n.isSaved?Te.Xc:Te.dc,i.push(a(n)),i.push(Te.Fc(e)),i.push(Te.Hb(n.uniqueId,r)),n.type===c.a.variant&&i.push(Te.Vb(n)),o(Object(Oe.batchActions)(i))):console.warn("Tried to save a non-temporary annotation: %o",e)}return Ie(Ie(Ie({},t),n),{},{closeAnnotation:function(){var e;t.activeAnnotation&&(e=Te.Vb(null),o(e))},didSelectAnnotation:function(e){var n=e.id==h.a?t.baseAnnotation:Se()(t.availableAnnotations,(function(t){return t.uniqueId==e.uniqueId}))||null,r=[],i=t.selectedWitness,a=Ae.d(i);e.uniqueId!=t.activeAnnotation.uniqueId&&(i.isWorking?(e.id!=h.a&&r.push(Te.Hb(n.uniqueId,a)),t.activeAnnotation.id!=h.a&&r.push(Te.Dc(t.activeAnnotation.uniqueId,a))):t.activeAnnotation.creatorWitness.id===i.id?(r.push(Te.Ec(t.activeAnnotation.uniqueId,a)),n.id!==h.a&&r.push(Te.Hb(n.uniqueId,a))):(n.creatorWitness.id===i.id?r.push(Te.Ib(n.uniqueId,a)):n.id!==h.a&&r.push(Te.Hb(n.uniqueId,a)),t.activeAnnotation.id!==h.a&&r.push(Te.Dc(t.activeAnnotation.uniqueId,a))),r.push(Te.Vb(n)),o(Object(Oe.batchActions)(r)))},editAnnotation:function(e){var n=e.isWorkingAnnotation||e.userCreated||e.id===h.a?null:e;n=new c.b(n,e.witness,e.start,e.length,e.content,e.type,t.selectedWitness,t.user);e.userCreated&&(n.uniqueId=e.uniqueId,n.isSaved=e.isSaved),o(Te.Gb(n,!0))},saveAnnotation:l,cancelEditAnnotation:function(t){var e;t.isTemporary?(e=Te.Fc(t),o(e)):console.warn("Tried to call cancelEditAnnotation on a non-temporary annotation: %o",t)},deleteAnnotation:function(e){var n=t.selectedWitness,r=Ae.d(n),i=[];i=e.userCreated?[Te.fc(e,n),Te.Dc(e.uniqueId,r)]:[Te.Ec(e.uniqueId,r)],t.activeAnnotation.uniqueId===e.uniqueId&&i.push(Te.Vb(null)),o(Object(Oe.batchActions)(i))},addNote:function(){var e=n.activeAnnotation;e=new c.b(null,e.witness,e.start,e.length,"",c.a.note,t.selectedWitness,t.user);o(Te.Gb(e,!0))},editNote:function(e){e=new c.b(e,e.witness,e.start,e.length,e.content,c.a.note,t.selectedWitness,t.user),o(Te.Gb(e,!0))},addPageBreak:s(c.a.pageBreak),addLineBreak:s(c.a.lineBreak),addQuestion:function(){var e=n.activeAnnotation;e=new c.b(null,e.witness,e.start,e.length,"",c.a.question,t.selectedWitness,t.user);o(Te.Gb(e,!0))},saveQuestion:function(e,r,i){var a=((a=Pe(n.annotatedText.getPositionOfAnnotation(e),2))[0],a[1],A.a.renderToStaticMarkup(t.questionQuote)+i);l(e,i),i=Te.ec(e,r,a);o(i)}})}))(lt),Ne=(xe=n(1003),n.n(xe)),De=(lt=n(351),n.n(lt));function Le(t){return(Le="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function qe(t,e){var n,o=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,n)),o}function He(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?qe(Object(n),!0).forEach((function(e){Me(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):qe(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Me(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ve(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var o,r,i=[],a=!0,s=!1;try{for(n=n.call(t);!(a=(o=n.next()).done)&&(i.push(o.value),!e||i.length!==e);a=!0);}catch(t){s=!0,r=t}finally{try{a||null==n.return||n.return()}finally{if(s)throw r}}return i}}(t,e)||function(t,e){if(t){if("string"==typeof t)return ze(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ze(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ze(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}function Ue(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Fe(t,e){return(Fe=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Qe(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ge(t){return(Ge=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}parseInt(st.a.inlineWidth);var $e="bdrcimg_pre",Je={},Xe=function(t){var e=o;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Fe(e,t);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,o=Ge(t);n=e?(n=Ge(this).constructor,Reflect.construct(o,arguments,n)):o.apply(this,arguments),o=this;if(n&&("object"===Le(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return Qe(o)}}(o);function o(t){var e;if(this instanceof o)return(e=n.call(this,t)).textAlignmentById=[],e.childRef=s.createRef("0"),e.list=null,e.splitText=null,e.cache=new S.b({fixedWidth:!0,defaultHeight:300}),e.splitTextRef=s.createRef(null),e.rowRenderer=e.rowRenderer.bind(Qe(e)),e.textListVisible=t.textListVisible,e.editMenuVisible=t.editMenuVisible,e.isPanelLinked=t.isPanelLinked,e.activeSelection=null,e.selectedNodes=null,e._mouseDown=!1,e._activeWitness=null,e._didSetInitialScrollPosition=!1,e._modifyingSelection=!1,e.imageHeight=null,e.imageWidth=null,e.calculatedImageHeight=null,e.processProps(t),e.changeScrollToId=t.changeScrollToId,e.changeSyncIdOnClick=t.changeSyncIdOnClick,e.closeAnnotation=t.closeAnnotation,e.scrollJump=t.scrollJump,e.textAlignmentById=[],e.scrollEvent=e.scrollEvent.bind(Qe(e)),e.selectedWindow=t.selectedWindow,e.fake_login_toggle=De.a.hasFeature("fake_login_toggle"),e.condition=!1,e;throw new TypeError("Cannot call a class as a function")}return e=o,(t=[{key:"scrollEvent",value:function(t){if(2===this.selectedWindow)return null;var e;1===this.selectedWindow&&this.isPanelLinked&&this.condition&&(e=[],this.textAlignmentById.map((function(t){var n=document.getElementById("s_"+t.start);n&&102<n.getBoundingClientRect().top&&e.push({id:t.id,start:t.start,target:t.TStart})})),v()(e)||1===this.selectedWindow&&this.debouncedScroll(e))}},{key:"updateId",value:function(t){this.textAlignmentById.find((function(t){return segment.start>=t.start&&segment.start<t.end}))}},{key:"updateList",value:function(){var t=!(0<arguments.length&&void 0!==arguments[0])||arguments[0],e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;if(!this.props.showImages&&!this.calculatedImageHeight&&this.imageHeight&&this.imageWidth&&(this.calculatedImageHeight=this.calculateImageHeight()),this.list){var n=this.list;if(t)if(null!==e)if(Array.isArray(e)){if(Array.isArray(e))for(var o=0;o<e.length;o++){var r=e[o];this.cache.clear(r)}}else this.cache.clear(e);else this.cache.clearAll(),n.measureAllRows(),n.recomputeRowHeights(0);n.forceUpdateGrid()}}},{key:"mouseDown",value:function(){this._mouseDown=!0}},{key:"mouseUp",value:function(){var t;this._mouseDown=!1,this.activeSelection&&(t=(t=this.processSelection(this.activeSelection))||[],this.props.didSelectSegmentIds(t),this.activeSelection=null)}},{key:"handleSelection",value:function(t){this._modifyingSelection?(t.stopPropagation(),this._modifyingSelection=!1):(this.activeSelection=document.getSelection(),this._mouseDown||this.mouseUp())}},{key:"processSelection",value:function(t){if(0===t.rangeCount||t.isCollapsed||"Caret"===t.type)return this.selectedNodes=null;var e=(t=t.getRangeAt(0)).startContainer;if(!(e=this.getNodeSegmentSpan(e))||!e.parentNode)return null;var n=this.getRangeNodes(t,e.parentNode),o=(0<n.length&&(o=n[0],t.startOffset===o.textContent.length&&n.shift()),t.endContainer);return(o=this.getNodeSegmentSpan(o))&&o.parentNode?(o&&e.parentNode!==o.parentNode?n=n.concat(this.getRangeNodes(t,o.parentNode)):0===t.endOffset&&n.pop(),e=[],(this.selectedNodes=n).reduce((function(t,e){return e instanceof Element&&t.push(e.id),t}),e),e):null}},{key:"getNodeSegmentSpan",value:function(t){for(var e=t,n=null,o=/^(i|s|ds)_/;!n&&e.parentNode;)e instanceof Element&&o.test(e.id)&&(n=e),e=e.parentNode;return n}},{key:"getRangeNodes",value:function(t,e){for(var n=[],o=0,r=e.childNodes.length;o<r;o++){var i=e.childNodes[o];t.intersectsNode(i)&&n.push(i)}return n}},{key:"getControlsMeasurements",value:function(t){if(!this.splitText)return null;var e=this.splitText,n=null,o=null,r=null,i=null,a=null,s=[],l=0;if(t.activeAnnotation){var u=t.activeAnnotation;if(null===(l=Ve(t.splitText.annotatedText.getPositionOfAnnotation(u),1)[0]))return console.warn("No startPos in getControlsMeasurements"),null;u.type===c.a.pageBreak&&--l,u.type===c.a.lineBreak&&--l;var p=l+u.length;0<u.length&&--p,n=t.splitText.getTextIndexOfPosition(p),i=e.getBoundingClientRect()}var f=[];if(t.selectedAnnotatedSegments&&0<t.selectedAnnotatedSegments.length){f=t.selectedAnnotatedSegments;for(var h=0;h<f.length;h++){var y=f[h];if(null===o&&y instanceof d.a){o=y;break}}o&&(a=0===o.length&&t.activeAnnotation&&t.activeAnnotation.isInsertion?(r=M(o),M):(r=q(o),q))}else t.activeAnnotation&&(t.activeAnnotation.isDeletion?(r=H(u=new d.a(l,"")),a=H,f=[o=u]):t.activeAnnotation.isInsertion?(p=Ve(t.splitText.annotatedText.getPositionOfAnnotation(t.activeAnnotation),1)[0])&&(r=M(e=new d.a(p,"")),a=M,f=[o=e]):t.activeAnnotation.type===c.a.pageBreak?(f=[o=new d.a(l+1,"")],s=[r=V(new d.a(l,""))]):t.activeAnnotation.type===c.a.lineBreak&&(f=[o=new d.a(l+1,"")],s=[r=z(new d.a(l,""))]));if(a)for(var m=0;m<f.length;m++){var g=f[m];g instanceof d.a&&(g=a(g),s.push(g))}return null!=n&&o&&r&&i?{selectedTextIndex:n,firstSelectedSegment:o,selectedElementId:r,splitTextRect:i,selectedElementIds:s}:null}},{key:"shouldResetListCache",value:function(t,e){var n=!1;return!(t.showImages===e.showImages&&!this.pageBreaksChanged(t,e))||n}},{key:"pageBreaksChanged",value:function(t,e){return t=t.splitText.getTextsFinalPositions(),e=e.splitText.getTextsFinalPositions(),t.length!==e.length||JSON.stringify(t)!==JSON.stringify(e)}},{key:"lineBreaksChanges",value:function(t,e){var n=t.activeAnnotation,o=e.activeAnnotation,r=!1;return n&&n.isType(c.a.lineBreak)&&e.activeAnnotations&&!e.activeAnnotations.hasOwnProperty(n.uniqueId)&&(r=!0),!(!(o&&o.isType(c.a.lineBreak)&&t.activeAnnotations)||t.activeAnnotations.hasOwnProperty(o.uniqueId))||r}},{key:"selectedListRow",value:function(t){var e=null;return t.activeAnnotation?t.splitText.getTextIndexOfPosition(t.activeAnnotation.start):e}},{key:"processProps",value:function(t){var e=this,n=!1;if((r=((!this.props.selectedWitness||t.selectedWitness&&t.selectedWitness.id!==this.props.selectedWitness.id)&&(this._didSetInitialScrollPosition=!(n=!0)),!t.selectedSearchResult||this.props.selectedSearchResult&&t.selectedSearchResult.start===this.props.selectedSearchResult.start&&t.selectedSearchResult.textId===this.props.selectedSearchResult.textId||(console.log("resetting scroll position from search result"),this._didSetInitialScrollPosition=!1),this._filteredSelectedAnnotatedSegments=t.selectedAnnotatedSegments.reduce((function(t,e){return e instanceof d.a&&t.push(e),t}),[]),this.getControlsMeasurements(t)))&&(this.selectedTextIndex=r.selectedTextIndex,this.firstSelectedSegment=r.firstSelectedSegment,this.splitTextRect=r.splitTextRect,this.selectedElementId=r.selectedElementId,this.selectedElementIds=r.selectedElementIds),t.textListVisible!==this.textListVisible||t.editMenuVisible!==this.editMenuVisible)setTimeout((function(){e.textListVisible=t.textListVisible,e.editMenuVisible=t.editMenuVisible,e.updateList(!0)}),500);else if(n)this.updateList(!0);else if(this.pageBreaksChanged(this.props,t)){var o=null,r=this.selectedListRow(this.props);n=this.selectedListRow(t);if(r&&n){o=[];for(var i=n<r?n:r,a=this.props.splitText.texts.length;i<a;i++)o.push(i)}this.updateList(!0,o)}else if(this.lineBreaksChanges(this.props,t)){n=(n=this.selectedListRow(t))||this.selectedListRow(this.props),r=this.props.splitText.texts;var s=[];if(null!==n){for(var l=n,c=r.length;l<c;l++)s.push(l);this.updateList(!0,s)}}else this.props.fontSize!==t.fontSize?this.updateList(!0):this.props.activeAnnotation&&t.activeAnnotation&&this.annotationsInSameLocation(this.props.activeAnnotation,t.activeAnnotation)?this.updateList(!0,this.selectedListRow(t)):this.updateList(this.shouldResetListCache(this.props,t))}},{key:"annotationsInSameLocation",value:function(t,e){return t.start===e.start&&t.length===e.length}},{key:"UNSAFE_componentWillReceiveProps",value:function(t){this.processProps(t)}},{key:"componentDidMount",value:function(){var t=this;this.list,this.resizeHandler=b()((function(){t.calculatedImageHeight=null,t.updateList()}),500).bind(this),this.debouncedScroll=g()((function(e){t.changeScrollToId({id:e[0].start,from:1})}),1e3),window.addEventListener("resize",this.resizeHandler),this.selectionHandler=g()((function(e){t.handleSelection(e)}),200).bind(this),document.addEventListener("selectionchange",this.selectionHandler),document.addEventListener("mousedown",this.mouseDown.bind(this),!0),document.addEventListener("mouseup",this.mouseUp.bind(this),!0),this.processProps(this.props),this.componentDidUpdate()}},{key:"componentDidUpdate",value:function(t){var e,n,o,r,i,a,s,l,c=this,u=this.props.textAlignment,p=(this.condition=(null==u||null==(s=u.source)?void 0:s.witness)===this.props.selectedWitness.id,this.props.scrollToId),f=this.list;(null==t?void 0:t.isSecondWindowOpen)!==(null==(s=this.props)?void 0:s.isSecondWindowOpen)&&setTimeout((function(){for(var t=0;t<2;t++)c.resizeHandler()}),1e3),(null==t?void 0:t.searchResults)===(null==(s=this.props)?void 0:s.searchResults)&&(null==t?void 0:t.syncIdOnSearch)===(null==(s=this.props)?void 0:s.syncIdOnSearch)||!this.props.searchResults||(t=this.props.syncIdOnSearch||null)&&(e=this.props.splitText.getTextIndexOfPosition(t),setTimeout((function(){f.scrollToRow(e),setTimeout((function(){f.scrollToPosition(f.props.scrollTop-300)}),0)}),100)),this.textAlignmentById=this.props.textAlignmentById,this.isPanelLinked=this.props.isPanelLinked,this.selectedWindow=this.props.selectedWindow,this.targetId=this.props.scrollToId,this.fake_login_toggle=!0,this.selectedNodes&&0<this.selectedNodes.length&&(n=this.selectedNodes,o=this.props.selectedAnnotatedSegments,setTimeout((function(){var t=document.createRange(),e=n[0],r=n[n.length-1],i=o[o.length-1];i instanceof d.a&&(i=document.getElementById(q(i)))&&(r=i),e instanceof Element&&r instanceof Element&&(e=document.getElementById(e.id),r=document.getElementById(r.id),e&&r&&(t.setStart(e,0),t.setEnd(r,r.childNodes.length),(i=document.getSelection())&&(c._modifyingSelection=!0,i.removeAllRanges(),i.addRange(t),c.selectedNodes=null)))}),0)),!this._didSetInitialScrollPosition&&this.list&&(r=this.list,(this.props.activeAnnotation||this.props.selectedSearchResult)&&(i=this.getSelectedTextIndex(),setTimeout((function(){r.scrollToRow(i),setTimeout((function(){r.scrollToPosition(r.props.scrollTop-300)}),0)}),100)),this._didSetInitialScrollPosition=!0),2==p.from&&this.isPanelLinked&&this.condition&&null!==p.id&&(a=this.list,this.textAlignmentById=this.props.textAlignmentById||[],this.splitText.style.scrollBehavior="smooth",u&&this.isPanelLinked&&null!==(t=null==(s=this.textAlignmentById.find((function(t){return t.TStart===p.id})))?void 0:s.start)&&(l=this.props.splitText.getTextIndexOfPosition(t),setTimeout((function(){a.scrollToRow(l),setTimeout((function(){a.scrollToPosition(a.props.scrollTop-300)}),0)}),100)))}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mousedown",this),document.removeEventListener("mouseup",this),window.removeEventListener("resize",this.resizeHandler),this.splitText.removeEventListener("resize",this.resizeHandler),document.removeEventListener("selectionchange",this.selectionHandler)}},{key:"calculateImageHeight",value:function(){var t,e,n=null;return this.imageHeight&&this.imageWidth&&(t=this.imageWidth/this.imageHeight,e=Ne.a.pechaImage,0<(e=document.getElementsByClassName(e)).length&&(n=e[0].offsetWidth/t)),n}},{key:"getSelectedTextIndex",value:function(){var t,e=0,n=null;return this.props.activeAnnotation?n=Ve(this.props.splitText.annotatedText.getPositionOfAnnotation(this.props.activeAnnotation),1)[0]:this.props.selectedSearchResult&&((t=this.props.splitText.annotatedText.segmentAtOriginalPosition(this.props.selectedSearchResult.start))instanceof d.a?n=t.start:"number"==typeof t&&(n=t)),n?this.props.splitText.getTextIndexOfPosition(n):e}},{key:"getBaseAnnotation",value:function(t){var e=Ve(this.props.splitText.annotatedText.getPositionOfAnnotation(t),1)[0];return this.props.splitText.annotatedText.getBaseAnnotation(e=null===e?0:e,t.content.length)}},{key:"render",value:function(){var t=this,e=this.props,n=this.rowRenderer,o=this.cache,r=e.selectedWitness?e.selectedWitness.id:0;return s.createElement("div",{className:Ne.a.splitText,ref:function(e){return t.splitText=e},key:r},s.createElement("button",{id:"updateList",style:{display:"none"},onClick:function(){return t.updateList(!0)}}),s.createElement(w.a,null,(function(r){var i=r.height;r=r.width;return s.createElement(x.a,{ref:function(e){return t.list=e},height:i,rowCount:e.splitText.texts.length,rowHeight:o.rowHeight,rowRenderer:n,width:r,overscanRowCount:1,deferredMeasurementCache:o,onScroll:t.scrollEvent,scrollToAlignment:"start"})})))}},{key:"getImageUrl",value:function(t){if(!this.props.selectedWitness||!this.props.selectedWitness.properties)return"";var e=(o=this.props.selectedWitness.properties)[$e],n=o.bdrcimg_number,o=o.bdrcimg_suffix;return"//iiif.bdrc.io/"+e+(Number(n)+t)+"."+o+"/full/full/0/default.jpg"}},{key:"getStringPositions",value:function(t,e,n){var o=this.props.splitText.annotatedText.getUniqueId();if((Je=Je.hasOwnProperty(o)?Je:Me({},o,{}))[o].hasOwnProperty(e)||(Je[o]=Me({},e,{})),Je[o][e].hasOwnProperty(n))return Je[o][e][n];for(var r=new E.a,i=t.getText(),a=null==(t=t.segments[0])?void 0:t.start,s=[],l=i.indexOf(e);-1!==l;)s.push(l),l=i.indexOf(e,l+1);var c={};if(0<s.length)for(var u=r.splitGraphemes(i),p=0,f=null,d=0;d<u.length;d++){var h=u[d],y=p+(h.length-1);null!==f?f+(e.length-1)<=y&&(c[f+a]=[f+a,y+a],f=null):-1!==s.indexOf(p)?e.length===h.length?c[p+a]=[p+a,y+a]:e.length>h.length&&(f=p):f=null,p+=h.length}return Je[o][e][n]=c}},{key:"rowRenderer",value:function(t){var e=t.key,n=t.index,o=t.parent,r=(t=t.style,this.props),i=this.cache,a=r.showImages?Ne.a.pechaImage:null,l=(r.selectedWitness&&r.selectedWitness.properties&&r.selectedWitness.properties.hasOwnProperty($e)&&this.getImageUrl(n),{}),c=this.props.searchValue;c&&0<c.length&&r.splitText&&(l=this.getStringPositions(r.splitText.texts[n],c,n)),r.showImages&&a&&this.calculatedImageHeight&&this.calculatedImageHeight,t=He(He({},t),{},{height:t.height+10});return s.createElement(S.a,{columnIndex:0,key:e,parent:o,rowIndex:n,cache:i},s.createElement("div",{key:e,style:t,className:Ne.a.splitTextRow,ref:this.splitTextRef,id:"index_".concat(n)},s.createElement("div",{className:Ne.a.splitTextRowContent},s.createElement(Q,{ref:this.childRef,segmentedText:r.splitText.texts[n],annotations:r.annotations,activeAnnotations:r.activeAnnotations,activeAnnotation:r.activeAnnotation,row:n,selectedSegmentId:r.selectedSegmentId,annotationPositions:r.annotationPositions,selectedAnnotatedSegments:this._filteredSelectedAnnotatedSegments,getBaseAnnotation:this.getBaseAnnotation.bind(this),activeWitness:this.props.selectedWitness,searchValue:c,selectedSearchResult:this.props.selectedSearchResult,searchStringPositions:l,fontSize:r.fontSize,changeSyncIdOnClick:this.props.changeSyncIdOnClick,changeScrollToId:this.props.changeScrollToId,isPanelLinked:this.props.isPanelLinked,isAnnotating:this.props.isAnnotating,textAlignmentById:this.props.textAlignmentById,selectedSourceRange:this.props.selectedSourceRange,selectedTargetRange:this.props.selectedTargetRange,changeSelectedRange:this.props.changeSelectedRange,condition:this.condition})),this.props.isAnnotating&&this.selectedTextIndex===n&&this.props.activeAnnotation&&s.createElement(We,{annotationPositions:r.annotationPositions,annotatedText:r.splitText.annotatedText,activeAnnotation:r.activeAnnotation,inline:!0,firstSelectedSegment:this.firstSelectedSegment,splitTextRect:this.splitTextRect,selectedElementId:this.selectedElementId,pechaImageClass:a,splitText:r.splitText,selectedElementIds:this.selectedElementIds,list:this.list,fake_login_toggle:this.fake_login_toggle})))}}])&&Ue(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),o}(s.PureComponent),Ze=n(317);function Ke(t){return function(t){if(Array.isArray(t))return Ye(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return Ye(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ye(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ye(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}n(136);xe=n(1004);var tn=n.n(xe),en=(lt=n(196),n.n(lt)),nn=(xe=n(307),n.n(xe)),on=(lt=n(1005),n.n(lt)),rn=(xe=n(1006),n.n(xe)),an=n(917);lt=n(1045);function sn(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}n(314);var ln=Object(s.memo)(Object(y.c)(Object(lt.a)((function(t){return{root:{minWidth:60,padding:0,textAlign:"center",fontWeight:"bold"},selectEmpty:{paddingLeft:"6px",backgroundColor:"transparent"},select:{color:"black","&:not([multiple]) option":{backgroundColor:"#eee"}}}}))((function(t){var e,n="",o=t.witnesses.findIndex((function(e){return(null==e?void 0:e.id)===(null==(e=t.activeWitness)?void 0:e.id)})),r=t.classes,i=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var o,r,i=[],a=!0,s=!1;try{for(n=n.call(t);!(a=(o=n.next()).done)&&(i.push(o.value),!e||i.length!==e);a=!0);}catch(t){s=!0,r=t}finally{try{a||null==n.return||n.return()}finally{if(s)throw r}}return i}}(t,e)||function(t,e){if(t){if("string"==typeof t)return sn(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?sn(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(Object(s.useState)(null),2),a=i[0],c=i[1],u=[rn.a.selectOptions];return t.witnesses&&(e=t.witnesses.map((function(t){return t})),u=[rn.a.tab],e.sort((function(t,e){return t.isWorking?-1:e.isWorking?1:t.isBase?-1:e.isBase?1:0})),e=e.sort((function(t,e){return t.id-e.id}))),Object(s.useEffect)((function(){0<t.witnesses.length&&t.onSelectedWitness(e[a])}),[a]),l.a.createElement(an.a,{onChange:function(t){return c(t.target.value)},className:rn.a.selectVersion,value:o,label:"Version",classes:{root:r.selectEmpty,select:r.select},style:{border:0}},e.map((function(e,o){return e.id===t.activeWitness.id&&u.push(rn.a.selected),n=e.source.name,e.isWorking&&(n="en"===t.intl.locale?"User"===(null==(e=t.user)?void 0:e.name)?"Working":"My Edition":"མཉམ་འབྲེལ་པར་མ།"),l.a.createElement("option",{key:"versionSelect-".concat(o),value:o,className:u,styles:{textAlign:"center"}},n)})))})))),cn=n(942),un=(xe=n(1015),n.n(xe)),pn=n(919),fn=n(929),dn=n(927),hn=n(1046);function yn(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var o,r,i=[],a=!0,s=!1;try{for(n=n.call(t);!(a=(o=n.next()).done)&&(i.push(o.value),!e||i.length!==e);a=!0);}catch(t){s=!0,r=t}finally{try{a||null==n.return||n.return()}finally{if(s)throw r}}return i}}(t,e)||function(t,e){if(t){if("string"==typeof t)return mn(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?mn(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function mn(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}n(11);var gn=Object(o.connect)((function(t){var e=Ae.z(t),n=Ae.x(t,e),o=Ae.D(t),r=!1,i=Ae.eb(t);return{texts:i=0<e.length?null===n?(r=!0,[]):i.filter((function(t){return n.hasOwnProperty(t.id)})):i,selectedText:Object(Ae.G)(t),searchTerm:e,searchResults:n,selectedSearchResult:o,searching:r}}),(function(t){return{onSelectedText:function(e){t(Te.Mc(e))}}}))((function(t){var e=Object(s.useRef)(t.texts),n=(i=yn(Object(s.useState)(e.current),2))[0],o=i[1],r=t.onSelectedText,i=t.selectedText,a=(t=yn(Object(s.useState)(!1),2))[0],c=t[1],u=(t=(i||n[0]).name,Object(s.useRef)(new cn.c({fixedHeight:!0,defaultHeight:30,defaultWidth:400}))),p=[un.a.textlist];return l.a.createElement(pn.a,{onClickAway:function(){return c(!1)}},l.a.createElement("div",{style:{position:"relative"}},l.a.createElement(fn.a,{onClick:function(){c((function(t){return!t})),!1===a&&p.push(un.a.open)},className:un.a.listToggelBtn,component:"div",sx:{overflow:"hidden",textOverflow:"ellipsis",width:"10rem"}},l.a.createElement(dn.a,{noWrap:!0},t)),a&&l.a.createElement("div",{className:m()(p),style:{position:"absolute"}},l.a.createElement(hn.a,{onChange:function(t){var r=t.target.value;o(e.current),""!==r&&null!==r&&(t=n.filter((function(t){return t.name.includes(r)})),o(t))},id:"standard-basic",label:"filter",variant:"standard",style:{width:"100%"}}),l.a.createElement(cn.a,null,(function(t){var e=t.width;t=t.height;return l.a.createElement(cn.d,{width:e,height:t,rowHeight:u.current.rowHeight,deferredMeasurementCache:u.current,rowCount:n.length,rowRenderer:function(t){var e=t.key,o=t.index,i=t.style,a=(t=t.parent,n[o]);return l.a.createElement(cn.b,{key:"optionvalues-".concat(e),cache:u.current,parent:t,columnIndex:0,rowIndex:o},l.a.createElement("div",{style:i,onClick:function(){c(!1),r(a)}},l.a.createElement("span",{style:{paddingLeft:"10px"}},a.name)))}})})))))})),bn=(y=n(957),n.n(y)),vn=n(913),wn=n(1050),xn=n(911),Sn=n(1051),On=n(930),En=n(928),An=n(1048),Tn=n(925);n(349),n(920),n(924),n(923),n(914),n(1016),lt=n(1049),xe=n(8),y=n(442),n(934),Object(xe.a)(lt.a)((function(t){return{"&.Mui-selected, &.Mui-selected:hover":{color:"white",backgroundColor:t.selectedcolor}}})),Object(y.a)({palette:{text:{primary:"#00398e"}}});var kn=n(1017),In=n.n(kn);function jn(t){t=t.isSecondWindowOpen;var e=Object(s.useCallback)((function(){var t=document.getElementById("updateList"),e=document.getElementById("updateList2");t&&t.click(),e&&e.click()}),[t]);return Object(s.useEffect)((function(){var t=setTimeout((function(){e()}),500);return function(){return clearTimeout(t)}}),[t]),l.a.createElement(On.a,{variant:"text",size:"small",style:{padding:0,color:"black"},onClick:e},l.a.createElement(In.a,null))}kn=n(954);var Pn=n.n(kn);function Cn(t){return t=t.handleWindowSearch,l.a.createElement(On.a,{size:"small",variant:"text",onClick:t,style:{padding:0,color:"black"}},l.a.createElement(Pn.a,null))}n(350),Object(xe.a)(lt.a)((function(t){return{"&.Mui-selected, &.Mui-selected:hover":{color:"white",backgroundColor:t.selectedcolor}}})),Object(y.a)({palette:{text:{primary:"#00398e"}}});kn=n(312);var Rn=n.n(kn),_n=n(939),Bn=(xe=n(955),n.n(xe)),Wn=n(910),Nn=n(932),Dn=n(926);function Ln(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}function qn(t){var e=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var o,r,i=[],a=!0,s=!1;try{for(n=n.call(t);!(a=(o=n.next()).done)&&(i.push(o.value),!e||i.length!==e);a=!0);}catch(t){s=!0,r=t}finally{try{a||null==n.return||n.return()}finally{if(s)throw r}}return i}}(t,e)||function(t,e){if(t){if("string"==typeof t)return Ln(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ln(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(Object(s.useState)(!1),2),n=e[0],o=e[1];return l.a.createElement(pn.a,{onClickAway:function(){return o(!1)}},l.a.createElement(On.a,{onClick:function(){o((function(t){return!t}))},size:"small",variant:"text",style:{padding:0,color:"black"}},l.a.createElement(Rn.a,null),l.a.createElement(Wn.a,{in:n},l.a.createElement(Nn.a,{dense:!0,style:{position:"absolute",right:0,zIndex:2,top:30,backgroundColor:"#eee"}},l.a.createElement(_n.a,{max:20,min:14,initialvalue:t.textFontSize,changeSize:t.onChangedFontSize}),l.a.createElement(Dn.a,{onClick:function(){return t.onExport()}},"Export Document",t.exportingWitness&&l.a.createElement(Bn.a,null)),l.a.createElement(Dn.a,{onClick:function(){return t.onChangePanelLink(!t.isPanelLinked)}},t.isPanelLinked&&l.a.createElement(Bn.a,null),"link panels")))))}lt=n(956);var Hn=n.n(lt);function Mn(t){return l.a.createElement(l.a.Fragment,{key:"right"},l.a.createElement(On.a,{onClick:function(){t.changeShowTableContent(!t.showTableContent)}},l.a.createElement(Hn.a,null)))}function Vn(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var o,r,i=[],a=!0,s=!1;try{for(n=n.call(t);!(a=(o=n.next()).done)&&(i.push(o.value),!e||i.length!==e);a=!0);}catch(t){s=!0,r=t}finally{try{a||null==n.return||n.return()}finally{if(s)throw r}}return i}}(t,e)||function(t,e){if(t){if("string"==typeof t)return zn(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?zn(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function zn(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}function Un(t,e){var n,o=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,n)),o}function Fn(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Un(Object(n),!0).forEach((function(e){Qn(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Un(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Qn(t,e,n){e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n}var Gn=Object(o.connect)((function(t){var e,n,o=Ae.G(t),r=Ae.H(t),i=[],a=!1,s=(o&&(i=Ae.cb(t,o.id),(s=Ae.J(t,o.id))?(e=Ae.ib(t,s),a=Ae.p(t,s)):e=Ae.mb(t,o.id)),r&&(n=(s=Ae.K(t,r.id))?Ae.jb(t,s):Ae.nb(t,r.id)),Ae.X(t)),l=Ae.z(t);return{witnesses:i,selectedText:o,selectedText2:r,selectedWitness:e,selectedWitness2:n,textListIsVisible:Object(Ae.Z)(t),accountOverlayVisible:Object(Ae.e)(t),textFontSize:s,isSecondWindowOpen:Ae.vb(t),exportingWitness:a,isPanelLinked:Ae.tb(t),user:Ae.gb(t),isAnnotating:Ae.rb(t),searchValue:l,showTableContent:Ae.M(t),searchResults:Ae.x(t,l)}}),null,(function(t,e,n){var o=e.dispatch,r=t.selectedText;return Fn(Fn(Fn({},n),t),{},(Qn(n={navigationButtonClicked:function(){e.dispatch(Te.bc(!t.textListIsVisible))},onSelectedWitness:function(t){o(Te.Oc(null==r?void 0:r.id,null==t?void 0:t.id))},onChangedFontSize:function(t){o(Te.Zb(t))},onChangeWindowOpen:function(t,e){o(Te.Vc(t,e))},onExport:function(){o(Te.gc(t.selectedWitness.id,"docx"))}},"navigationButtonClicked",(function(){o(Te.bc(!t.textListIsVisible))})),Qn(n,"onChangePanelLink",(function(t){o(Te.Mb(t))})),Qn(n,"changeIsAnnotating",(function(t){o(Te.Kb(t)),!1===t&&(t=Te.Vb(null),o(t),o(Te.Vb(null)))})),Qn(n,"searchChanged",(function(t){o(Te.Wb(t))})),Qn(n,"changeShowTableContent",(function(t){o(Te.Tc(t))})),Qn(n,"changeSelectSyncId",(function(t){o(Te.Rb(t))})),n))}))((function(t){var e=(c=Vn(Object(s.useState)(""),2))[0],n=c[1],o=(c=Vn(Object(s.useState)(!1),2))[0],r=c[1],i=(c=Vn(Object(s.useState)(!1),2))[0],a=c[1],c=Object(s.useRef)(),u=Object(s.useRef)(),p=l.a.useRef(g()((function(e){t.searchChanged(e)}),1e3)).current,f=Object(s.useCallback)((function(t){t.preventDefault(),p(e),a(!0)}),[e]),d=Object(s.useCallback)((function(){!1===o&&p(null),r(!o)}),[o]);return Object(s.useEffect)((function(){!0===o&&u.current.focus(),!1===o&&p(null)}),[o]),l.a.createElement(vn.a,{ref:c,direction:"column",spacing:1,px:2,py:1,style:{background:"#f7f7f7"}},l.a.createElement(vn.a,{direction:"row",spacing:1,justifyContent:"space-between"},l.a.createElement(fn.a,{sx:{display:"flex",gap:2}},l.a.createElement(gn,null),l.a.createElement(ln,{witnesses:t.witnesses,activeWitness:t.selectedWitness,onSelectedWitness:t.onSelectedWitness,user:t.user})),l.a.createElement(wn.a,{size:"small","aria-label":"small button group",sx:{position:"relative",display:"flex",alignItems:"center",justifyContent:"center",width:"fit-content",border:function(t){return"1px solid ".concat(t.palette.divider)},borderRadius:1,bgcolor:"background.paper",color:"text.secondary","& svg":{m:1.5},"& hr":{mx:.5}},className:on.a.button_group_menu},l.a.createElement(jn,{isSecondWindowOpen:t.isSecondWindowOpen}),l.a.createElement(xn.a,{orientation:"vertical",variant:"middle",flexItem:!0}),l.a.createElement(Cn,{handleWindowSearch:d}),l.a.createElement(qn,t),l.a.createElement(Mn,t))),l.a.createElement(Sn.a,{in:o},l.a.createElement("form",{onSubmit:f},l.a.createElement(vn.a,{direction:"row",spacing:2,position:"relative"},l.a.createElement(hn.a,{hiddenLabel:!0,id:"filled-hidden-label-small",inputProps:{style:{height:25,padding:"0 14px"}},style:{height:25,flex:1},fullWidth:!0,inputRef:u,value:e,onChange:function(t){return n(t.target.value)}}),l.a.createElement(On.a,{variant:"outlined",size:"small",onClick:f,style:{height:25}},"Search"),t.searchResults&&i&&l.a.createElement(En.a,{sx:{position:"absolute",top:35,right:0,zIndex:1,background:"#eee",boxShadow:3}},nn()(t.searchResults)&&t.searchResults.hasOwnProperty(t.selectedText.id)&&t.searchResults[t.selectedText.id].results.map((function(e,n){return l.a.createElement(An.a,{onClick:function(){var n;n=e[0],t.changeSelectSyncId(n)},sx:{cursor:"pointer","&:hover":{background:"#fff"}},key:e[0]+"listsearch"},e[1])})),l.a.createElement(Tn.a,{"aria-label":"closeButton",onClick:function(){a(!1),p(null),n("")},size:"small",sx:{right:0,top:0,position:"absolute"}},l.a.createElement(bn.a,{fontSize:"inherit"})))))))})),$n=n(916);function Jn(){return l.a.createElement(l.a.Fragment,null,l.a.createElement(dn.a,{textTransform:"uppercase"},"Table Of Content"))}function Xn(t){return(Xn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Zn(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Kn(t,e){return(Kn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Yn(t){return(Yn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var to,eo,no,oo,ro=0,io=(y=function(t){var e=o;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Kn(e,t);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,o=Yn(t);n=e?(n=Yn(this).constructor,Reflect.construct(o,arguments,n)):o.apply(this,arguments),o=this;if(n&&("object"===Xn(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==o)return o;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(o);function o(){var t;if(this instanceof o)return(t=n.call(this)).key=ro++,t.ref=l.a.createRef(),t.selectedWindow=null,t;throw new TypeError("Cannot call a class as a function")}return e=o,(t=[{key:"mouseEnter",value:function(){2===this.selectedWindow&&this.props.changeSelectedWindow(1)}},{key:"componentDidMount",value:function(){this.ref.current.addEventListener("mouseenter",this.mouseEnter.bind(this))}},{key:"componentDidUpdate",value:function(){this.selectedWindow=this.props.selectedWindow}},{key:"render",value:function(){this.props.text&&this.props.text;var t,e,n=null;n=[this.props.annotatedText&&this.props.text&&!this.props.loading?(t=this.props.paginated?(t=this.props.pageBreaks,0===(e=Ke(t))[0]&&e.shift(),function(t){return e}):Object(Ze.a)(1e3,/^།[\s]+(?!།[\s]+)/,2,5),n=new G.a(this.props.annotatedText,t),l.a.createElement(Xe,{splitText:n,annotations:this.props.annotations,activeAnnotations:this.props.activeAnnotations,activeAnnotation:this.props.activeAnnotation,limitWidth:!1,didSelectSegmentIds:this.props.didSelectSegmentIds,selectedSegmentId:this.props.selectedSegmentId,annotationPositions:this.props.annotationPositions,selectedAnnotatedSegments:this.props.selectedAnnotatedSegments,textListVisible:this.props.textListVisible,showImages:this.props.pageImagesVisible,imagesBaseUrl:this.props.imagesBaseUrl,selectedWitness:this.props.selectedWitness,key:this.key,selectedSearchResult:this.props.selectedSearchResult,searchValue:this.props.searchValue,fontSize:this.props.fontSize,isSecondWindowOpen:this.props.isSecondWindowOpen,changeScrollToId:this.props.changeScrollToId,changeSyncIdOnClick:this.props.changeSyncIdOnClick,imageData:this.props.imageData,isPanelLinked:this.props.isPanelLinked,selectedImage:this.props.selectedImage,changeSelectedImage:this.props.changeSelectedImage,isAnnotating:this.props.isAnnotating,closeAnnotation:this.props.closeAnnotation,textAlignment:this.props.textAlignment,textAlignmentById:this.props.textAlignmentById,isPanelVisible:this.props.isPanelVisible,scrollToId:this.props.scrollToId,selectedWindow:this.props.selectedWindow,selectedSourceRange:this.props.selectedSourceRange,selectedTargetRange:this.props.selectedTargetRange,changeSelectedRange:this.props.changeSelectedRange,searchResults:this.props.searchResults,showTableContent:this.props.showTableContent,selectedText:this.props.text,syncIdOnSearch:this.props.syncIdOnSearch})):l.a.createElement("div",{key:this.key})];return l.a.createElement(fn.a,{style:{height:"100%",flex:1},className:m()(tn.a.textDetail,en.a.flex,en.a.flexColumn),key:this.key,ref:this.ref},l.a.createElement(Gn,null),l.a.createElement(zt.a,{loaded:!this.props.loading,zIndex:5}),l.a.createElement(fn.a,{style:{display:"flex",height:"100%",width:"100%",position:"relative"}},l.a.createElement(fn.a,{style:{flex:1},className:m()(tn.a.textContainer,en.a.flex)},this.props.loading?l.a.createElement("div",null):n),l.a.createElement($n.a,{direction:"left",in:this.props.showTableContent,container:this.ref.current},l.a.createElement(fn.a,{sx:{position:"absolute",height:"100%",minWidth:"50%",right:0,background:"#eee",borderLeft:"1px solid gray",padding:2}},l.a.createElement(Jn,null)))))}}])&&Zn(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),o}(l.a.Component),n(160),n(74));function ao(t,e){var n,o=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,n)),o}function so(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ao(Object(n),!0).forEach((function(e){var o,r;o=t,r=n[e=e],e in o?Object.defineProperty(o,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):o[e]=r})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ao(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function lo(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var o,r,i=[],a=!0,s=!1;try{for(n=n.call(t);!(a=(o=n.next()).done)&&(i.push(o.value),!e||i.length!==e);a=!0);}catch(t){s=!0,r=t}finally{try{a||null==n.return||n.return()}finally{if(s)throw r}}return i}}(t,e)||co(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function co(t,e){if(t){if("string"==typeof t)return uo(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?uo(t,e):void 0}}function uo(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}function po(t){return[t.start,t.length].join("-")}function fo(t,e){if(t===to&&e===eo&&t.version===oo)return no;for(var n={},o={},r=0;r<e.length;r++)!function(r){var i=e[r],a=(r=lo(t.getPositionOfAnnotation(i),2))[0],s=r[1];if(null!=a)if(0===s){if(i.isInsertion){if(r=po(i),r=o[r])return r.map((function(t){return n[t].push(i)}));a=h.c+a}i.isDeletion&&0<i.length&&(a=h.b+a),i.type===c.a.pageBreak&&(a=h.e+a),i.type===c.a.lineBreak&&(a=h.d+a),void 0===n[a]&&(n[a]=[]),-1===n[a].indexOf(i)&&n[a].push(i)}else{for(var l=[],u=a;u<a+s;u++)void 0===n[u]&&(n[u]=[]),-1===n[u].indexOf(i)&&n[u].push(i),l.push(u);i.isInsertion&&(r=po(i),o[r]=l)}}(r);return eo=e,no=n,oo=(to=t).version,n}function ho(t,e){var n=[];if(r()(t,(function(t){return n.push(t.start)})),n=n.sort((function(t,e){return t-e})),e){var o=[];if(r()(e,(function(t){return o.push(t.start)})),o=o.sort((function(t,e){return t-e})),0===n.length)return o;if(n.length/o.length<.9)for(var i=n[n.length-1],a=0,s=o.length;a<s;a++){var l=o[a];i<l&&n.push(l)}}return n}var yo=null;kn=Object(o.connect)((function(t){var e=Object(Ae.gb)(t),n=t.data.loadingWitnesses||t.data.loadingAnnotations,o=Object(Ae.Z)(t),r=Ae.tb(t),i=Ae.W(t);if(n)return{text:null,witnesses:null,baseWitness:null,annotations:null,loading:n,paginated:null,pageImagesVisible:!1,annotatedText:null,selectedAnnotatedSegments:null,annotationPositions:null,activeAnnotations:null,activeAnnotation:null,user:e,textListVisible:o,fontSize:Pt.a,isSecondWindowOpen:Object(Ae.vb)(t),isPanelLinked:r,textAlignmentById:i};var a,s,l,u=Object(Ae.G)(t),p={},f=(u&&(a=Object(Ae.mb)(t,u.id),s=Object(Ae.n)(t,u.id)),Object(Ae.D)(t)),h={},y=[],m=null,g=Object(Ae.h)(t),b=[],v={},w=[],x="",S=Object(Ae.z)(t),O=!1,E=Object(Ae.X)(t);if(a&&u&&t.data.witnessAnnotationsById.hasOwnProperty(a.id)){p=Object(Ae.cb)(t,u.id),m=((l=(A=Object(Ae.J)(t,u.id))?Object(Ae.ib)(t,A):l)||(A=(l=a).id),l.id!==a.id&&(O=!0,Object(Ae.xb)(t)),io.d(t,l.id)),v=(A=lo(io.c(t,l,a),2))[0],y=A[1];if(m&&(h=fo(m,Object.values(y))),g&&m&&(g=yo&&yo.id===l.id?g:m.getAnnotation(g.start,g.length))&&(b=m.segmentsForAnnotation(g)),l&&s&&m){var A=m.getAnnotationsOfType(c.a.pageBreak)||{},T=null;l.id!==s.id&&(T=Object(Ae.m)(t,a.id,c.a.pageBreak,s.id));for(var k=0,I=(w=ho(A,T)).length;k<I;k++){var j=w[k];(j=m.segmentAtOriginalPosition(j))instanceof d.a?w[k]=j.start:j instanceof Number&&(w[k]=j)}O&&(x="/static/images/texts/"+u.name+"/"+l.source.name+"/")}}yo=l;A=Ae.w(t),T=Ae.V(t);var P=Ae.P(t),C=Ae.L(t);return{text:u,witnesses:p,workingWitness:a,baseWitness:s,annotations:y,loading:n,paginated:O,pageImagesVisible:!1,annotatedText:m,selectedAnnotatedSegments:b,annotationPositions:h,activeAnnotations:so({},v),activeAnnotation:g,pageBreaks:w,imagesBaseUrl:x,user:e,textListVisible:o,selectedWitness:l,selectedSearchResult:f,searchValue:S,fontSize:E,isSecondWindowOpen:Object(Ae.vb)(t),imageData:Object(Ae.q)(t),isPanelLinked:r,selectedImage:Object(Ae.B)(t),isImagePortrait:Object(Ae.sb)(t),isPanelVisible:Object(Ae.ub)(t),isAnnotating:Ae.rb(t),textAlignment:T,textAlignmentById:i,scrollToId:A,syncIdOnClick:P,selectedWindow:C,selectedSourceRange:Object(Ae.E)(t),selectedTargetRange:Object(Ae.F)(t),searchResults:Object(Ae.x)(t,S),showTableContent:Object(Ae.M)(t),syncIdOnSearch:Ae.Q(t)}}),null,(function(t,e,n){function o(t,e,n){var o=[],r=[],i=[];(t=b[t])&&(o=t.filter((function(t){return t.type===c.a.variant})),r=t.filter((function(t){return t.type===c.a.pageBreak})),i=t.filter((function(t){return t.type===c.a.lineBreak}))),t=a()(o.concat(r,i),g.annotations,(function(t,e){return t.toString()==e.toString()})),r=null,r=0<t.length?t[0]:o&&0<o.length?(i=function(t){for(var e=null,n=0;n<t.length;n++){var o=t[n];(!e||o.length>e.length)&&(e=o)}return e}(o),o=(t=lo(g.getPositionOfAnnotation(i),2))[0],t=t[1],i&&i.isInsertion&&(t=0),g.getBaseAnnotation(o,t)):g.getBaseAnnotation(e,n);m(Object(Te.Vb)(r))}function r(t){return-1!==t.indexOf("i_")}function s(t){return-1!==t.indexOf("ds_")}function l(t){return-1!==t.indexOf("p_")}function d(t){return-1!==t.indexOf("l_")}function y(t){return!r(t)&&s(t)?t.substr(3):t.substr(2)}var m=e.dispatch,g=t.annotatedText,b=t.annotationPositions;return so(so(so({},t),n),{},{didSelectSegmentIds:function(e){if(0!==e.length){var n,o=[],l=[],d=function(t,e){var n,o="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!o){if(Array.isArray(t)||(o=co(t))||e&&t&&"number"==typeof t.length)return o&&(t=o),n=0,{s:e=function(){},n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:e};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i=!0,a=!1;return{s:function(){o=o.call(t)},n:function(){var t=o.next();return i=t.done,t},e:function(t){a=!0,r=t},f:function(){try{i||null==o.return||o.return()}finally{if(a)throw r}}}}(e);try{for(d.s();!(n=d.n()).done;){var v,w,x,S=n.value;s(S)||r(S)||(v=y(S),w=g.segmentedText.segmentAtPosition(v),l.push(w),(x=b[w.start])&&(o=o.concat(x)))}}catch(e){d.e(e)}finally{d.f()}o=i()(o,(function(t,e){return t.toString()==e.toString()}));var O,E,A=a()(o,g.annotations,(function(t,e){return t.toString()==e.toString()})),T=function(t,e,n,o){if(0===t.length)return null;for(var r=t[0],i=(t=t[t.length-1],r.start),a=t.end,s=null,l=null,c=0;c<n.length;c++){var u=n[c],p=null,f=(d=lo(o.getPositionOfAnnotation(u),2))[0],d=d[1];-1!==e.indexOf(u)?(f&&f<i&&(i=f,s=u),(p=f+d-1)&&a<p&&(l=a=p)):a<(p=f+d-1)&&(a=p)}return{start:i,length:a-i+1,annotation:s&&l&&s===l?s:null}}(l,A,o,t.annotatedText);T?(O=g.getBaseAnnotation(T.start,T.length),null,E=T.annotation||(0<A.length?(A=g.segmentedText.segmentsInRange(T.start,T.length).reduce((function(t,e){return t+e.text}),""),t.selectedWitness||console.log("no stateProps.selectedWitness: %o",t.selectedWitness),new c.c(h.f,function(t){var e=new u.b(h.f,u.a);return t=new f.a(t.id,t.name),new p.a(h.f,t,e,"",!1)}(t.text),O.start,O.length,A,c.a.variant,t.selectedWitness,t.user)):O),m(Object(Te.Vb)(E))):console.warn("No range for selected segment ids: %o",e)}},selectedSegmentId:function(e){var n,i=y(e),a=i;r(e)?a=h.c+i:s(e)?a=h.b+i:l(e)?a=h.e+i:d(e)&&(a=h.d+i),b[a],""===e?t.activeAnnotation&&(n=Te.Vb(null),m(n)):r(e)||s(e)||l(e)||d(e)?o(a,i,0):(n=Number(y(e)),(a=g.segmentedText.segmentAtPosition(n))&&o(a.start,a.start,a.length))},changeScrollToId:function(t){return m(Te.Nb(t))},changeSyncIdOnClick:function(t){return m(Te.Qb(t))},changeSelectedImage:function(t){m(Te.Hc(t))},changeSelectedWindow:function(t){m(Te.Pb(t))},changeSelectedRange:function(t){m(Te.Ob(t))},changeShowTableContent:function(t){m(Te.Tc(t))},closeAnnotation:function(){var t=Te.Vb(null);m(t)}})}))(y);e.default=kn},935:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var o=n(170);function r(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}n(62);var i=function(){function t(e,n){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.annotatedText=e,this.splitter=n,this._texts=null,this._textsId=null,this._textsFinalPositions=[]}var e,n;return e=t,(n=[{key:"texts",get:function(){if(!this.annotatedText)return[];if(!this._texts||this._textsId!==this.annotatedText.getUniqueId()){this._textsFinalPositions=[];var t=this.annotatedText.segmentedText,e=t.getText(),n=this.splitter(e).filter((function(t){return 0!==t}));if(0===n.length)return this._textsFinalPositions.push(e.length),[t];n[n.length-1]+1<e.length&&n.push(e.length-1);for(var r=t.segments,i=0,a=[],s=0;s<n.length;s++){var l=n[s],c=(l=t.indexOfSegmentAtPosition(l-1),void 0);c=s==n.length-1?r.slice(i):r.slice(i,l+1),c=new o.a(c);a.push(c),i=l+1,0<=l&&(c=r[l],this._textsFinalPositions.push(c.end))}this._texts=a.filter((function(t){return 0<t.segments.length})),this._textsId=this.annotatedText.getUniqueId()}return this._texts||[]}},{key:"getTextsFinalPositions",value:function(){return this.texts,this._textsFinalPositions}},{key:"getTextIndexOfPosition",value:function(t){for(var e=this.getTextsFinalPositions(),n=0,o=null,r=0;r<e.length;r++){var i=e[r];if(n<=t&&t<=i){o=r;break}n=i}return null===o&&(console.warn("no index for position %d",t),o=e.length-1),o}}])&&r(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}()},936:function(t,e,n){t.exports={"green-tint":"#88af8e","blue-tint":"#024279","active-button":"#00746b",mainTint:"#024279",activeButton:"#00746b",inlineWidth:"280px",annotationControls:"AnnotationControls---annotationControls",annotationContent:"AnnotationControls---annotationContent",subTitle:"AnnotationControls---subTitle",title:"AnnotationControls---title",sectionHeading:"AnnotationControls---sectionHeading",text:"AnnotationControls---text",padding:"AnnotationControls---padding",arrowTop:"AnnotationControls---arrowTop",arrowLeft:"AnnotationControls---arrowLeft",arrowRight:"AnnotationControls---arrowRight",inline:"AnnotationControls---inline",arrow:"AnnotationControls---arrow",arrowDs:"AnnotationControls---arrowDs",nothingSelected:"AnnotationControls---nothingSelected",anonymousMessage:"AnnotationControls---anonymousMessage",noNotes:"AnnotationControls---noNotes",breakButtons:"AnnotationControls---breakButtons"}},938:function(t,e,n){t.exports={"green-tint":"#88af8e","blue-tint":"#024279","active-button":"#00746b",mainTint:"#024279",activeButton:"#00746b",save:"Button---save",cancel:"Button---cancel",buttonContainer:"Button---buttonContainer"}},939:function(t,e,n){"use strict";var o=n(0),r=n.n(o),i=(o=n(941),n.n(o));e.a=function(t){var e=t.max,n=t.min,o=t.initialvalue,a=void 0===(t=t.changeSize)?function(t){return console.log(t)}:t;return r.a.createElement("div",{className:i.a.inputRanges},r.a.createElement("span",{style:{fontSize:13,top:"-5px"}},"ཀ"),r.a.createElement("input",{type:"range",style:{width:"70%"},className:i.a.inputRange,min:n,max:e,step:1,smooth:"yes",value:o,onChange:function(t){return a(parseInt(t.target.value))}}),r.a.createElement("span",{style:{fontSize:18,top:"-10px"}},"ཀ"))}},941:function(t,e,n){t.exports={inputRanges:"Slider---inputRanges",inputRange:"Slider---inputRange"}},951:function(t,e,n){t.exports={"green-tint":"#88af8e","blue-tint":"#024279","active-button":"#00746b",mainTint:"#024279",activeButton:"#00746b",annotationDetail:"AnnotationDetail---annotationDetail",active:"AnnotationDetail---active",annotationHeader:"AnnotationDetail---annotationHeader",activeIcon:"AnnotationDetail---activeIcon",editing:"AnnotationDetail---editing",actionButtons:"AnnotationDetail---actionButtons",edit:"AnnotationDetail---edit",editImage:"AnnotationDetail---editImage",save:"AnnotationDetail---save",cancel:"AnnotationDetail---cancel"}},982:function(t,e,n){t.exports={"green-tint":"#88af8e","blue-tint":"#024279","active-button":"#00746b",mainTint:"#024279",activeButton:"#00746b",paddingSide:"20px",maxWidth:"600px",text:"Text---text",syncIdClass:"Text---syncIdClass",textFirstRow:"Text---textFirstRow",textLine:"Text---textLine",textline:"Text---textline",limitWidth:"Text---limitWidth",textContainer:"Text---textContainer",annotation:"Text---annotation",selectedAnnotation:"Text---selectedAnnotation",removedByAnnotation:"Text---removedByAnnotation",insertion:"Text---insertion",highlight:"Text---highlight",activeHighlight:"Text---activeHighlight",lineBreak:"Text---lineBreak",pageBreak:"Text---pageBreak",selectedRange:"Text---selectedRange"}},988:function(t,e,n){t.exports={heading:"AnnotationControlsHeading---heading",title:"AnnotationControlsHeading---title",button:"AnnotationControlsHeading---button"}},989:function(t,e,n){t.exports={"green-tint":"#88af8e","blue-tint":"#024279","active-button":"#00746b",mainTint:"#024279",activeButton:"#00746b",button:"AddButton---button"}},990:function(t,e,n){t.exports={"green-tint":"#88af8e","blue-tint":"#024279","active-button":"#00746b",mainTint:"#024279",activeButton:"#00746b",editorContainer:"NoteEditor---editorContainer",textEditor:"NoteEditor---textEditor"}},991:function(t,e,n){t.exports={question:"QuestionView---question",threadLink:"QuestionView---threadLink"}},992:function(t,e,n){t.exports={name:"AnswerView---name",answer:"AnswerView---answer"}},993:function(t,e,n){t.exports={"green-tint":"#88af8e","blue-tint":"#024279","active-button":"#00746b",mainTint:"#024279",activeButton:"#00746b",editorContainer:"QuestionEditor---editorContainer",textEditor:"QuestionEditor---textEditor"}},994:function(t,e,n){t.exports={loading:"QuestionsLoading---loading"}},995:function(t,e,n){t.exports={"green-tint":"#88af8e","blue-tint":"#024279","active-button":"#00746b",mainTint:"#024279",activeButton:"#00746b",note:"Note---note",header:"Note---header",info:"Note---info",content:"Note---content",delete:"Note---delete"}},996:function(t,e,n){t.exports={"green-tint":"#88af8e","blue-tint":"#024279","active-button":"#00746b",mainTint:"#024279",activeButton:"#00746b",header:"AnnotationControlsHeader---header",Anotation_closeBtn:"AnnotationControlsHeader---Anotation_closeBtn",edit:"AnnotationControlsHeader---edit"}}}]);