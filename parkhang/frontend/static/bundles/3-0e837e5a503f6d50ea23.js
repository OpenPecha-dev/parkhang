(window.webpackJsonpparkhang=window.webpackJsonpparkhang||[]).push([[3],{1017:function(t,e,n){t.exports={"green-tint":"#88af8e","blue-tint":"#024279","active-button":"#00746b",mainTint:"#024279",activeButton:"#00746b",paddingSide:"20px",maxWidth:"600px",text:"Text---text",syncIdClass:"Text---syncIdClass",textFirstRow:"Text---textFirstRow",textLine:"Text---textLine",textline:"Text---textline",limitWidth:"Text---limitWidth",textContainer:"Text---textContainer",annotation:"Text---annotation",selectedAnnotation:"Text---selectedAnnotation",removedByAnnotation:"Text---removedByAnnotation",insertion:"Text---insertion",highlight:"Text---highlight",activeHighlight:"Text---activeHighlight",lineBreak:"Text---lineBreak",pageBreak:"Text---pageBreak",selectedRange:"Text---selectedRange"}},1020:function(t,e,n){t.exports={heading:"AnnotationControlsHeading---heading",title:"AnnotationControlsHeading---title",button:"AnnotationControlsHeading---button"}},1021:function(t,e,n){t.exports={"green-tint":"#88af8e","blue-tint":"#024279","active-button":"#00746b",mainTint:"#024279",activeButton:"#00746b",button:"AddButton---button"}},1022:function(t,e,n){t.exports={"green-tint":"#88af8e","blue-tint":"#024279","active-button":"#00746b",mainTint:"#024279",activeButton:"#00746b",editorContainer:"NoteEditor---editorContainer",textEditor:"NoteEditor---textEditor"}},1023:function(t,e,n){t.exports={question:"QuestionView---question",threadLink:"QuestionView---threadLink"}},1024:function(t,e,n){t.exports={name:"AnswerView---name",answer:"AnswerView---answer"}},1025:function(t,e,n){t.exports={"green-tint":"#88af8e","blue-tint":"#024279","active-button":"#00746b",mainTint:"#024279",activeButton:"#00746b",editorContainer:"QuestionEditor---editorContainer",textEditor:"QuestionEditor---textEditor"}},1026:function(t,e,n){t.exports={loading:"QuestionsLoading---loading"}},1027:function(t,e,n){t.exports={"green-tint":"#88af8e","blue-tint":"#024279","active-button":"#00746b",mainTint:"#024279",activeButton:"#00746b",note:"Note---note",header:"Note---header",info:"Note---info",content:"Note---content",delete:"Note---delete"}},1029:function(t,e,n){t.exports={"green-tint":"#88af8e","blue-tint":"#024279","active-button":"#00746b",mainTint:"#024279",activeButton:"#00746b",header:"AnnotationControlsHeader---header",Anotation_closeBtn:"AnnotationControlsHeader---Anotation_closeBtn",edit:"AnnotationControlsHeader---edit"}},1036:function(t,e,n){t.exports={"green-tint":"#88af8e","blue-tint":"#024279","active-button":"#00746b",mainTint:"#024279",activeButton:"#00746b",inlineWidth:"280px",annotationControls:"SplitText---annotationControls",annotationContent:"SplitText---annotationContent",subTitle:"SplitText---subTitle",title:"SplitText---title",sectionHeading:"SplitText---sectionHeading",text:"SplitText---text",padding:"SplitText---padding",arrowTop:"SplitText---arrowTop",arrowLeft:"SplitText---arrowLeft",arrowRight:"SplitText---arrowRight",inline:"SplitText---inline",arrow:"SplitText---arrow",arrowDs:"SplitText---arrowDs",nothingSelected:"SplitText---nothingSelected",anonymousMessage:"SplitText---anonymousMessage",noNotes:"SplitText---noNotes",breakButtons:"SplitText---breakButtons",splitText:"SplitText---splitText",splitTextRowContent:"SplitText---splitTextRowContent",splitTextRow:"SplitText---splitTextRow",pechaImage:"SplitText---pechaImage",controlsPlaceholder:"SplitText---controlsPlaceholder",hide:"SplitText---hide",pageNumber:"SplitText---pageNumber"}},1037:function(t,e,n){t.exports={"green-tint":"#88af8e","blue-tint":"#024279","active-button":"#00746b",mainTint:"#024279",activeButton:"#00746b",textDetail:"TextDetail---textDetail",textContainer:"TextDetail---textContainer",tableContent:"TextDetail---tableContent"}},1038:function(t,e,n){t.exports={"green-tint":"#88af8e","blue-tint":"#024279","active-button":"#00746b",mainTint:"#024279",activeButton:"#00746b",button_group_menu:"textDetailHeading---button_group_menu"}},1039:function(t,e,n){t.exports={"green-tint":"#88af8e","blue-tint":"#024279","active-button":"#00746b",mainTint:"#024279",activeButton:"#00746b",selectVersion:"SelectVersion---selectVersion",selectEmpty:"SelectVersion---selectEmpty",selectOptions:"SelectVersion---selectOptions","styled-select":"SelectVersion---styled-select"}},1048:function(t,e,n){t.exports={textlist:"TextList---textlist",open:"TextList---open",listToggelBtn:"TextList---listToggelBtn"}},1051:function(t,e,n){t.exports={highlight:"SearchStyle---highlight",searchListItem:"SearchStyle---searchListItem"}},1052:function(t,e,n){t.exports={TableContent:"TableOfContent---TableContent"}},1062:function(t,e,n){"use strict";n.r(e);var o=n(1e3),r=n.n(o),i=(o=n(980),n.n(o)),a=(o=n(988),n.n(o)),s=n(0),l=n.n(s),c=(o=n(36),n(27)),u=n(150),p=n(104),f=n(151),d=n(51),h=n(69),y=n(68),m=n.n(y),g=(y=(n(181),n(325)),n.n(y)),b=(y=n(989),n.n(y)),v=(y=n(91),n.n(y)),w=(n(59),n(329)),x=n(328),O=n(274),S=(y=(n(469),n(1017)),n.n(y)),E=(y=(n(188),n(327)),n.n(y)),T=(y=n(990),n.n(y));function A(){return(A=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n,o=arguments[e];for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])}return t}).apply(this,arguments)}function j(t){return l.a.createElement("svg",A({viewBox:"0 0 30 40",fill:"currentColor"},t),k,I,P)}var k=l.a.createElement("path",{d:"M3 0h24v15H3z"}),I=l.a.createElement("path",{stroke:"currentColor",strokeWidth:3,d:"M0 20h8M11 20h8M22 20h8"}),P=l.a.createElement("path",{d:"M3 25h24v15H3z"});function C(t){return(C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function R(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var o,r,i=[],a=!0,s=!1;try{for(n=n.call(t);!(a=(o=n.next()).done)&&(i.push(o.value),!e||i.length!==e);a=!0);}catch(t){s=!0,r=t}finally{try{a||null==n.return||n.return()}finally{if(s)throw r}}return i}}(t,e)||function(t,e){if(t){if("string"==typeof t)return _(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}function B(t,e){var n,o=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,n)),o}function W(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?B(Object(n),!0).forEach((function(e){var o,r;o=t,r=n[e=e],e in o?Object.defineProperty(o,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):o[e]=r})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):B(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function N(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function L(t,e){return(L=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function D(t){return(D=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function q(t){return"s_"+t.start}function H(t){return"ds_"+t.start}function M(t){return"i_"+t.start}function z(t){return"p_"+(t.end+1)}function V(t){return"l_"+(t.end+1)}var U=String.fromCharCode(182),F=T.a.renderToStaticMarkup(l.a.createElement(j,null)),Q=function(t){var e=o;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&L(e,t);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,o=D(t);n=e?(n=D(this).constructor,Reflect.construct(o,arguments,n)):o.apply(this,arguments),o=this;if(n&&("object"===C(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==o)return o;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(o);function o(t){var e;if(this instanceof o)return(e=n.call(this,t)).textAlignmentById=[],e.state={segmentedText:t.segmentedText},e.textAlignmentById=e.props.textAlignmentById,e._renderedSegments=null,e._renderedHtml=null,e.rangeSelect=[],e;throw new TypeError("Cannot call a class as a function")}return e=o,(t=[{key:"UNSAFE_componentWillReceiveProps",value:function(t){this.setState((function(e,n){return W(W({},e),{},{segmentedText:t.segmentedText})}))}},{key:"annotationsForSegment",value:function(t){var e=[],n=this.props.annotationPositions[String(t.start)],o=this.props.annotationPositions[h.c+t.start]||[],r=this.props.annotationPositions[h.b+t.start]||[],i=this.props.annotationPositions[h.e+(t.end+1)]||[];t=this.props.annotationPositions[h.d+(t.end+1)]||[];return(e=n||e).concat(o,r,i,t)}},{key:"segmentsContainSegment",value:function(t,e){for(var n=0;n<t.length;n++){var o=t[n];if(o.start===e.start&&o.text===e.text)return!0}return!1}},{key:"selectedElement",value:function(t){var e=[],n=[],o=document.getSelection();if(null!=t&&t.id.includes("s_")&&this.props.isPanelLinked&&this.props.condition){var r=parseInt(t.id.replace("s_","")),i=(this.props.changeSyncIdOnClick(r),this.props.changeScrollToId({id:null,from:null}),parseInt(t.id.replace("s_",""))),a=this.textAlignmentById.find((function(t){return i>=t.start&&i<t.end}));if(a){for(var s=a.start;s<a.end;s++)e.push(s);for(var l=a.TStart;l<a.TEnd;l++)n.push(l);this.props.changeSelectedRange({source:e,target:n})}}o&&"Range"===o.type||(this.props.selectedSegmentId(t.id),t.id||this.props.changeSelectedRange({source:[],target:[]}))}},{key:"generateHtml",value:function(t,e){var n=e.segmentedText.segments,o=S.a.textLine,r='<p class="'+o+'">';if(0===n.length)return{__html:r};for(var i=S.a.insertion,a=n[n.length-1].end+1,s=(t.annotationPositions[h.c+a]&&(e=new d.a(a,""),n.push(e)),t.annotationPositions[h.e+a]&&(e=new d.a(a,""),n.push(e)),t.annotationPositions[h.d+a]&&(e=new d.a(a,""),n.push(e)),t.activeAnnotations||{}),l=S.a.highlight,u=S.a.activeHighlight,p=null,f={},y=0;y<n.length;y++){var g=n[y],b="",v=[],w=this.annotationsForSegment(g),x=null,O=!1,E=!1,T=!1,A=!1,j=null;if(w){for(var k,I=[],P=[],C=[],_=[],B=0,W=w.length;B<W;B++){var N,L=w[B];L.isInsertion?L.uniqueId in s?I.push(L):(N=L.start,f.hasOwnProperty(N)||(P.push(L),f[N]=L)):L.isDeletion?L.uniqueId in s&&_.push(L):L.type!==c.a.pageBreak||t.activeWitness.isWorking?L.type!==c.a.lineBreak||t.activeWitness.isWorking?C.push(L):A=L:j=L}0===I.length&&0<P.length&&(D=P[0],k=M(g),Q=i,t.activeAnnotation&&t.activeAnnotation.isInsertion&&t.activeAnnotation.start===D.start&&(Q+=" "+S.a.selectedAnnotation),r+="<span id="+k+" key="+k+' class="'+Q+'">'+D.content+"</span>"),0<_.length&&(k=_[0],x=t.getBaseAnnotation(k).content,t.activeAnnotation&&t.activeAnnotation.isDeletion&&t.activeAnnotation.start===k.start&&t.activeAnnotation.length===k.length&&0===g.length&&(O=!0)),j&&t.activeAnnotation&&t.activeAnnotation.uniqueId===j.uniqueId&&(E=!0),A&&t.activeAnnotation&&t.activeAnnotation.uniqueId===A.uniqueId&&(T=!0),(0<C.length||0<I.length)&&v.push(S.a.annotation)}if(g.start===a)break;var D,Q=null,G=(0===g.length?(Q=H(g),v.push(S.a.removedByAnnotation),x&&(g=new d.a(g.start,x))):Q=q(g),(this.segmentsContainSegment(t.selectedAnnotatedSegments,g)||O)&&v.push(S.a.selectedAnnotation),t.selectedSourceRange.includes(g.start)&&v.push(S.a.selectedRange),0<v.length&&(b='class="'+m.a.apply(void 0,v)+'"'),g.text);if(t.searchStringPositions){var $=g.start,J=$,X=(G="",l);t.selectedSearchResult&&t.selectedSearchResult.start<=J&&t.selectedSearchResult.start+t.selectedSearchResult.length>J&&(X=u);for(var K=0;K<g.text.length;K++){var Z,Y,tt,et=g.text.charAt(K);J=$+K;p?((Z=R(p,2))[0],0===K&&(G+='<span class="'+X+'">'),J===Z[1]?(G+=et+"</span>",p=null):K===g.text.length-1?G+=et+"</span>":G+=et):J in t.searchStringPositions?(Y=(Z=R(t.searchStringPositions[J],2))[0],tt=Z[1],G+='<span class="'+X+'">'+et,K!==g.text.length-1&&J!==tt||(G+="</span>"),J<tt&&(p=[Y,tt])):G+=et}}r+="<span id="+Q+" key="+Q+" "+b+">"+G+"</span>",j&&(D=[S.a.pageBreak],E&&D.push(S.a.selectedAnnotation),x=' class="'+D.join(" ")+'" ',r+="<span id="+z(g)+" key="+z(g)+x+">"+F+"</span>"),A&&(O=[S.a.lineBreak],T&&O.push(S.a.selectedAnnotation),v=' class="'+O.join(" ")+'" ',r=r+"<span id="+V(g)+" key="+V(g)+v+">"+U+'</span></p><p class="'+o+'">')}return this._renderedSegments=n,{__html:r+="</p>"}}},{key:"shouldComponentUpdate",value:function(t,e){return e=this.generateHtml(t,e),this.props.fontSize!==t.fontSize||(!this._renderedHtml||e.__html!==this._renderedHtml.__html)&&(this._renderedHtml=e,!0)}},{key:"render",value:function(){var t=this,e=[S.a.text],n=(0===this.props.row&&e.push(S.a.textFirstRow),this._renderedHtml||this.generateHtml(this.props,this.state));return this._renderedHtml||(this._renderedHtml=n),l.a.createElement("div",{className:S.a.textContainer},l.a.createElement("div",{className:m.a.apply(void 0,e),id:"text1",dangerouslySetInnerHTML:n,style:{fontSize:this.props.fontSize,fontFamily:"var(--tibetan-fonts)"},onClick:function(e){t.selectedElement(e.target)}}))}}])&&N(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),o}(l.a.Component),G=n(974),$=n(178),J=(y=n(991),n.n(y));function X(){return(X=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n,o=arguments[e];for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])}return t}).apply(this,arguments)}function K(t){return l.a.createElement("svg",X({viewBox:"0 0 24 24"},t),Z,Y)}var Z=l.a.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),Y=l.a.createElement("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"}),tt=(y=n(277),n.n(y));function et(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}function nt(t){(e=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var o,r,i=[],a=!0,s=!1;try{for(n=n.call(t);!(a=(o=n.next()).done)&&(i.push(o.value),!e||i.length!==e);a=!0);}catch(t){s=!0,r=t}finally{try{a||null==n.return||n.return()}finally{if(s)throw r}}return i}}(t,e)||function(t,e){if(t){if("string"==typeof t)return et(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?et(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(Object(s.useState)(null),2))[0],e[1];var e=l.a.createElement("p",null,"<",l.a.createElement($.a,{id:"annotation.delete"}),">"),n=(""!==(n=t.annotationData.content).trim()&&(250<n.length&&(n=n.substr(0,250)+"…"),e=l.a.createElement("p",null,n)),[J.a.annotationDetail]);t.isActive&&n.push(J.a.active),n=m.a.apply(void 0,n);return l.a.createElement("div",{className:n,onClick:t.selectAnnotationHandler},l.a.createElement("div",{className:J.a.annotationHeader},t.isActive&&l.a.createElement("div",{className:J.a.activeIcon},l.a.createElement(K,{style:{fill:tt.a.activeButton},width:15,height:15})),l.a.createElement("h3",null,t.annotationData.name),t.isLoggedIn&&t.isActive&&l.a.createElement("button",{style:{display:"none"},className:J.a.edit,onClick:t.editAnnotationHandler,id:"editBtn"})),!t.isWorkingSection&&e)}function ot(t){var e=t.annotationData.content,n=[J.a.annotationDetail],o=null;t.isActive&&n.push(J.a.active),n=m.a.apply(void 0,n);return l.a.createElement("div",{className:n},l.a.createElement("h3",null,t.annotationData.name),l.a.createElement("div",{className:J.a.editing},l.a.createElement("textarea",{defaultValue:e,autoFocus:!0,onInput:function(t){o.style.height="5px",o.style.height=o.scrollHeight+"px"},ref:function(t){return o=t}}),l.a.createElement("div",{className:J.a.actionButtons},l.a.createElement("div",{className:J.a.save,onClick:function(){o&&t.saveAnnotationHandler(o.value)}},l.a.createElement($.a,{id:"annotation.save"})),l.a.createElement("div",{className:J.a.cancel,onClick:t.cancelAnnotationHandler},l.a.createElement($.a,{id:"annotation.cancel"})))))}function rt(t){return l.a.createElement("div",{className:lt.a.button,title:t.title,onClick:t.onClick},"+")}n(359);y=n(975);var it=n.n(y),at=(y=(n(79),n(50)),n(1020)),st=n.n(at),lt=(at=n(1021),n.n(at));function ct(t){return(ct="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ut(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function pt(t,e){return(pt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function ft(t){return(ft=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}at=function(t){var e=o;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&pt(e,t);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,o=ft(t);n=e?(n=ft(this).constructor,Reflect.construct(o,arguments,n)):o.apply(this,arguments),o=this;if(n&&("object"===ct(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==o)return o;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(o);function o(){var t=this,e=o;if(t instanceof e)return n.apply(this,arguments);throw new TypeError("Cannot call a class as a function")}return e=o,(t=[{key:"render",value:function(){var t,e=null;return this.props.buttonOnClick&&(t=this.props.buttonTitleId?this.props.intl.formatMessage({id:this.props.buttonTitleId}):"",e=l.a.createElement(rt,{title:t,onClick:this.props.buttonOnClick})),l.a.createElement("h3",{className:st.a.heading},l.a.createElement("span",{className:st.a.title},l.a.createElement($.a,{id:this.props.titleId})),e&&l.a.createElement("div",{className:st.a.button},e))}}])&&ut(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),o}(l.a.Component),Object(y.c)(at),at=n(1022);var dt=n.n(at),ht=(at=n(977),n.n(at));function yt(t){return(yt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function mt(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function gt(t,e){return(gt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function bt(t){return(bt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var vt=function(t){var e=o;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&gt(e,t);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,o=bt(t);n=e?(n=bt(this).constructor,Reflect.construct(o,arguments,n)):o.apply(this,arguments),o=this;if(n&&("object"===yt(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==o)return o;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(o);function o(t){var e;if(this instanceof o)return(e=n.call(this,t)).state={content:t.note.content},e;throw new TypeError("Cannot call a class as a function")}return e=o,(t=[{key:"save",value:function(){var t=this.textarea?this.textarea.value:"";this.props.saveNote(this.props.note,t)}},{key:"cancel",value:function(){this.props.cancel()}},{key:"handleChange",value:function(t){var e=t.target instanceof HTMLTextAreaElement?t.target.value:"";this.setState((function(t,n){return{content:e}}))}},{key:"render",value:function(){var t=this;return l.a.createElement("div",{className:dt.a.editorContainer},l.a.createElement("textarea",{className:dt.a.textEditor,ref:function(e){return t.textarea=e},value:this.state.content,onChange:this.handleChange.bind(this)}),l.a.createElement("div",{className:ht.a.buttonContainer},l.a.createElement("div",{className:ht.a.save,onClick:this.save.bind(this)},l.a.createElement($.a,{id:"annotation.save"})),l.a.createElement("div",{className:ht.a.cancel,onClick:this.cancel.bind(this)},l.a.createElement($.a,{id:"annotation.cancel"}))))}}])&&mt(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),o}(l.a.Component),wt=(at=n(1023),n.n(at)),xt=(at=(n(276),n(1024)),n.n(at)),Ot=(n(215),n(162));function St(t){return(St="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Et(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Tt(t,e){return(Tt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function At(t){return(At=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var jt=function(t){var e=o;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Tt(e,t);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,o=At(t);n=e?(n=At(this).constructor,Reflect.construct(o,arguments,n)):o.apply(this,arguments),o=this;if(n&&("object"===St(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==o)return o;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(o);function o(){var t=this,e=o;if(t instanceof e)return n.apply(this,arguments);throw new TypeError("Cannot call a class as a function")}return e=o,(t=[{key:"render",value:function(){return l.a.createElement("div",{className:xt.a.answer},l.a.createElement("p",{className:it.a.text,dangerouslySetInnerHTML:{__html:this.props.answer.content}}),l.a.createElement("p",{className:it.a.subTitle},l.a.createElement($.a,{id:"question.answeredBy"})," ",this.props.answer.name,","," ",l.a.createElement(Ot.FormattedDate,{value:this.props.answer.created})))}}])&&Et(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),o}(l.a.Component),kt=n(72),It=n(968);function Pt(t){return(Pt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ct(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Rt(t,e){return(Rt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _t(t){return(_t=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Bt=function(t){var e=o;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Rt(e,t);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,o=_t(t);n=e?(n=_t(this).constructor,Reflect.construct(o,arguments,n)):o.apply(this,arguments),o=this;if(n&&("object"===Pt(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==o)return o;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(o);function o(){var t=this,e=o;if(t instanceof e)return n.apply(this,arguments);throw new TypeError("Cannot call a class as a function")}return e=o,(t=[{key:"render",value:function(){var t=kt.g+this.props.question.topicId,e=[],n=this.props.question.answers;console.log(n);for(var o=0;o<n.length;o++){var r=n[o];e.push(l.a.createElement(jt,{answer:r,key:"answer_"+r.created}))}var i=0<this.props.question.name.length?this.props.question.name:this.props.question.username;return l.a.createElement(It.a,{className:m()(wt.a.question,it.a.padding),sx:{boxShadow:2}},l.a.createElement("span",{className:m()(wt.a.threadLink,it.a.text)},l.a.createElement("a",{href:t,target:"_blank"},l.a.createElement($.a,{id:"question.viewThread"}))),l.a.createElement("p",{className:it.a.text,dangerouslySetInnerHTML:{__html:this.props.question.content}}),l.a.createElement("p",{className:it.a.subTitle},i,","," ",l.a.createElement(Ot.FormattedDate,{value:this.props.question.created})),e)}}])&&Ct(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),o}(l.a.Component),Wt=(at=n(1025),n.n(at));function Nt(t){return(Nt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Lt(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Dt(t,e){return(Dt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function qt(t){return(qt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Ht=function(t){var e=o;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Dt(e,t);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,o=qt(t);n=e?(n=qt(this).constructor,Reflect.construct(o,arguments,n)):o.apply(this,arguments),o=this;if(n&&("object"===Nt(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==o)return o;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(o);function o(t){var e;if(this instanceof o)return(e=n.call(this,t)).state={content:t.question.content},e;throw new TypeError("Cannot call a class as a function")}return e=o,(t=[{key:"save",value:function(){var t=this.textarea?this.textarea.value:"";this.props.saveQuestion(this.props.question,this.props.defaultTitle,t)}},{key:"cancel",value:function(){this.props.cancel()}},{key:"handleChange",value:function(t){var e=t.target instanceof HTMLTextAreaElement?t.target.value:"";this.setState((function(t,n){return{content:e}}))}},{key:"render",value:function(){var t=this;return l.a.createElement("div",{className:Wt.a.editorContainer},l.a.createElement("div",null,this.props.questionQuote),l.a.createElement("textarea",{className:Wt.a.textEditor,ref:function(e){return t.textarea=e},value:this.state.content,onChange:this.handleChange.bind(this)}),l.a.createElement("div",{className:ht.a.buttonContainer},l.a.createElement("div",{className:ht.a.save,onClick:this.save.bind(this)},l.a.createElement($.a,{id:"annotation.save"})),l.a.createElement("div",{className:ht.a.cancel,onClick:this.cancel.bind(this)},l.a.createElement($.a,{id:"annotation.cancel"}))))}}])&&Lt(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),o}(l.a.Component),Mt=(at=n(1026),n.n(at)),zt=(at=n(189),n.n(at));function Vt(t){return(Vt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ut(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Ft(t,e){return(Ft=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Qt(t){return(Qt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Gt=function(t){var e=o;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ft(e,t);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,o=Qt(t);n=e?(n=Qt(this).constructor,Reflect.construct(o,arguments,n)):o.apply(this,arguments),o=this;if(n&&("object"===Vt(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==o)return o;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(o);function o(){var t=this,e=o;if(t instanceof e)return n.apply(this,arguments);throw new TypeError("Cannot call a class as a function")}return e=o,(t=[{key:"render",value:function(){return l.a.createElement("div",{className:m()(Mt.a.loading,it.a.text)},l.a.createElement(zt.a,{loaded:!1,scale:.25,position:"relative",top:"50%",left:"50%",lines:9,width:8,length:8,radius:14}),"Loading questions...")}}])&&Ut(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),o}(l.a.Component),$t=(at=n(1027),n.n(at)),Jt=n(964),Xt=(at=n(1028),n.n(at));function Kt(t){return(Kt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Zt(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Yt(t,e){return(Yt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function te(t){return(te=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var ee=function(t){var e=o;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Yt(e,t);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,o=te(t);n=e?(n=te(this).constructor,Reflect.construct(o,arguments,n)):o.apply(this,arguments),o=this;if(n&&("object"===Kt(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==o)return o;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(o);function o(){var t=this,e=o;if(t instanceof e)return n.apply(this,arguments);throw new TypeError("Cannot call a class as a function")}return e=o,(t=[{key:"delete",value:function(){this.props.delete&&this.props.delete(this.props.note)}},{key:"edit",value:function(){this.props.edit&&this.props.edit(this.props.note)}},{key:"render",value:function(){return l.a.createElement(It.a,{className:$t.a.note,sx:{boxShadow:2}},l.a.createElement("p",null,"Note:"),l.a.createElement("div",{className:$t.a.header},l.a.createElement("h4",{className:$t.a.info},this.props.note.creatorUser.name),this.props.delete&&l.a.createElement("div",{className:$t.a.delete,onClick:this.delete.bind(this)},l.a.createElement(Jt.a,{"aria-label":"delete",size:"small"},l.a.createElement(Xt.a,{fontSize:"inherit"})))),l.a.createElement("div",{className:$t.a.content,onClick:this.edit.bind(this)},this.props.note.content))}}])&&Zt(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),o}(l.a.Component),ne=n(334),oe=(at=n(1029),n.n(at));function re(){return(re=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n,o=arguments[e];for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])}return t}).apply(this,arguments)}function ie(t){return l.a.createElement("svg",re({viewBox:"0 0 24 24"},t),ae,se)}var ae=l.a.createElement("path",{d:"M3 18h12v-2H3v2zM3 6v2h18V6H3zm0 7h18v-2H3v2z"}),se=l.a.createElement("path",{fill:"none",d:"M0 0h24v24H0V0z"});function le(){return(le=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n,o=arguments[e];for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])}return t}).apply(this,arguments)}function ce(t){return l.a.createElement("svg",le({viewBox:"0 0 24 24",fill:"currentColor"},t),ue,pe)}var ue=l.a.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),pe=l.a.createElement("path",{d:"M21 6h-2v9H6v2c0 .55.45 1 1 1h11l4 4V7c0-.55-.45-1-1-1zm-4 6V3c0-.55-.45-1-1-1H3c-.55 0-1 .45-1 1v14l4-4h10c.55 0 1-.45 1-1z"});function fe(){return(fe=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n,o=arguments[e];for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])}return t}).apply(this,arguments)}function de(t){return l.a.createElement("svg",fe({viewBox:"0 0 512 512"},t),he)}var he=l.a.createElement("path",{d:"M497.9 142.1l-46.1 46.1c-4.7 4.7-12.3 4.7-17 0l-111-111c-4.7-4.7-4.7-12.3 0-17l46.1-46.1c18.7-18.7 49.1-18.7 67.9 0l60.1 60.1c18.8 18.7 18.8 49.1 0 67.9zM284.2 99.8L21.6 362.4.4 483.9c-2.9 16.4 11.4 30.6 27.8 27.8l121.5-21.3 262.6-262.6c4.7-4.7 4.7-12.3 0-17l-111-111c-4.8-4.7-12.4-4.7-17.1 0zM124.1 339.9c-5.5-5.5-5.5-14.3 0-19.8l154-154c5.5-5.5 14.3-5.5 19.8 0s5.5 14.3 0 19.8l-154 154c-5.5 5.5-14.3 5.5-19.8 0zM88 424h48v36.3l-64.5 11.3-31.1-31.1L51.7 376H88v48z"});function ye(t){return(ye="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function me(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function ge(t,e){return(ge=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function be(t){return(be=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var ve=function(t){var e=o;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ge(e,t);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,o=be(t);n=e?(n=be(this).constructor,Reflect.construct(o,arguments,n)):o.apply(this,arguments),o=this;if(n&&("object"===ye(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==o)return o;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(o);function o(){if(this instanceof o)return n.call(this);throw new TypeError("Cannot call a class as a function")}return e=o,(t=[{key:"render",value:function(){var t=null!=this.props.addPageBreak,e=null!=this.props.addLineBreak;return l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:oe.a.header},l.a.createElement(ne.a,{noBezel:!0,icon:l.a.createElement(ie,{width:15,height:15,style:{fill:"#fff"}}),backgroundColor:"transparent",onClick:this.props.addNote,disabled:!this.props.addNote,align:"center",tooltipTitle:"Note",shortcut:"n"}),l.a.createElement(ne.a,{noBezel:!0,icon:l.a.createElement(ce,{width:15,height:15,style:{fill:"#fff"}}),onClick:this.props.addQuestion,disabled:!this.props.addQuestion,align:"left",backgroundColor:"transparent",tooltipTitle:"Question",shortcut:"q"}),l.a.createElement(ne.a,{noBezel:!0,color:"#fff",fontSize:"".concat(15,"px"),icon:"¶",onClick:this.props.addLineBreak,disabled:!e,align:"left",backgroundColor:"transparent",tooltipTitle:"LineBreak",shortcut:"l"}),l.a.createElement(ne.a,{noBezel:!0,icon:l.a.createElement(j,{width:15,height:15,style:{fill:"#fff"}}),onClick:this.props.addPageBreak,disabled:!t,align:"left",backgroundColor:"transparent",tooltipTitle:"PageBreak",shortcut:"p"}),l.a.createElement(ne.a,{onClick:this.props.editAnnotationHandler,backgroundColor:"transparent",noBezel:!0,icon:l.a.createElement(de,{width:15,height:15,style:{fill:"#fff"}}),tooltipTitle:"Edit",shortcut:"e"})))}}])&&me(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),o}(l.a.Component);function we(t){return(we="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function xe(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Oe(t,e){return(Oe=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Se(t){return(Se=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}at=function(t){var e=o;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Oe(e,t);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,o=Se(t);n=e?(n=Se(this).constructor,Reflect.construct(o,arguments,n)):o.apply(this,arguments),o=this;if(n&&("object"===we(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==o)return o;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(o);function o(t){if(this instanceof o)return(t=n.call(this,t)).controls=null,t.arrow=null,t.arrowDs=null,t;throw new TypeError("Cannot call a class as a function")}return e=o,(t=[{key:"componentDidMount",value:function(){this.updatePosition()}},{key:"componentDidUpdate",value:function(){setTimeout(this.updatePosition.bind(this),0)}},{key:"updatePosition",value:function(){var t=this.getMeasurements();if(this.props.inline&&this.controls&&this.arrow&&t){var e=this.controls,n=e.offsetHeight,o=e.offsetWidth,r=this.arrow,i=t.bottomGap,a=i<0||n<i,s=t.top,l=t.viewPortWidth||0,c=t.left,u=c+t.width;if(r.style.display="none",this.props.selectedElementIds)for(var p=0,f=0,d=0;d<this.props.selectedElementIds.length;d++){var h,y,m=this.props.selectedElementIds[d];(m=document.getElementById(m))&&(y=(h=m.offsetLeft)+m.offsetWidth,h<p?(m.offsetTop,m.offsetHeight,c=h,u=f=y):f<y&&(f=y),h<c&&(c=h),u<y&&(u=y),p=h)}var g=u-c,b=3,v=!1,w=0;(v=!a&&i<n||v)?(r.className=it.a.arrowLeft,b=c-o-r.offsetWidth<0?4:2):(c-(a=o/2-g/2)<0&&(w=Math.abs(c-a)),l<u+a&&(w=l-(u+a))),3===b?(a=l=0,this.arrow&&(this.arrow.className=it.a.arrowTop,a=o/2-this.arrow.offsetWidth/2-w,this.arrow.style.left=(a=a<0?0:a)+"px",l=this.arrow.offsetHeight,this.arrow.style.top=0-l+"px"),e.style.top=s+t.height+l+"px",e.style.left=c+g/2-o/2+w+"px"):v?(r.className=it.a.arrowRight,a=r.offsetHeight,l=t.top+t.height/2-a/2,t.top+t.height+i-l<n&&(l=t.top+t.height+i-n),2===b?(r.style.left=o-2+"px",e.style.left=c-o-r.offsetWidth+"px"):(r.className=it.a.arrowLeft,r.style.left=-r.offsetWidth+"px",e.style.left=c+g+r.offsetWidth+"px"),r.style.top=t.top-l+t.height/2-a/2+"px",e.style.top=l+"px"):e.style.top=s+"px"}}},{key:"getMeasurements",value:function(){if(!this.props.selectedElementIds)return null;var t=this.props.selectedElementIds[this.props.selectedElementIds.length-1],e=(t=document.getElementById(t),this.props.selectedElementIds[0]),n=(e=document.getElementById(e),this.props.splitTextRect),o=0;if(this.props.list&&this.props.list.Grid.state.scrollTop,this.props.pechaImageClass&&(o=document.getElementsByClassName(this.props.pechaImageClass)[0].offsetHeight),!t)return console.warn("no valid element found in getMeasurements, elementId: %s",this.props.selectedElementId),{top:0,textTop:0,rowTop:0,left:0,width:1,height:1,topGap:0,bottomGap:0,viewPortWidth:1};o=t.offsetTop+o;var r=t.offsetTop,i=t.offsetLeft,a=t.offsetWidth,s=t.offsetHeight,l=o,c=null,u=0,p=0;return t&&n&&(t=t.getBoundingClientRect(),p=n.height+n.top-t.bottom,c=n.width),e&&n&&(t=e.getBoundingClientRect(),u=n.height-t.top),{top:o,textTop:r,rowTop:l,left:i,width:a,height:s,topGap:u,bottomGap:p,viewPortWidth:c}}},{key:"render",value:function(){var t,e,n=this,o=this.props,r=[],i=[],a=null,l=null,u=o.user.isLoggedIn||!1,p=!1,f=(o.activeAnnotation&&(o.activeAnnotation.isType(c.a.pageBreak)||o.activeAnnotation.isType(c.a.lineBreak))&&(p=!0),o.annotationsData?(o.annotationsData.map((function(t){var e,a=!1,l=!1;t.isTemporary?l=a=!0:o.temporaryAnnotation||t.annotation.uniqueId!=o.activeAnnotation.uniqueId||(l=!0),a?(e=s.createElement(ot,{annotationData:t,key:t.annotation.uniqueId,isActive:l,saveAnnotationHandler:function(e){o.saveAnnotation(t.annotation,e)},cancelAnnotationHandler:function(){o.cancelEditAnnotation(t.annotation)},isLoggedIn:u,selectAnnotationHandler:function(){},editAnnotationHandler:function(){}}),i.push(e)):(e=s.createElement(nt,{isWorkingSection:!1,fontSize:o.fontSize,annotationData:t,key:t.annotation.uniqueId,isActive:l,selectAnnotationHandler:function(){u&&!a&&o.didSelectAnnotation(t.annotation)},editAnnotationHandler:function(){u&&!a&&(n.annotation=t.annotation,o.editAnnotation(t.annotation))},isLoggedIn:u}),r.push(e))}),this),1==!o.user.isLoggedIn&&(console.log(1==!o.user.isLoggedIn),a=s.createElement("div",{className:it.a.anonymousMessage,style:{position:"relative",width:"fit-content",border:"1px solid gray",paddingInline:10}},s.createElement($.a,{id:"annotations.loginMessage",values:{loginLink:s.createElement(s.Fragment,null,s.createElement($.a,{id:"annotations.loginLink"}))}})))):l=s.createElement("div",{className:it.a.nothingSelected},"Nothing Selected"),null),d=!this.props.selectedWitness.isWorking,h=null,y=!this.props.selectedWitness.isWorking,g=(u&&!this.props.selectedWitness.isWorking&&(t=[],e=[],this.props.availableAnnotations&&(t=this.props.availableAnnotations.filter((function(t){return t.type===c.a.pageBreak&&t.creatorWitness.id===n.props.selectedWitness.id})),e=this.props.availableAnnotations.filter((function(t){return t.type===c.a.lineBreak&&t.creatorWitness.id===n.props.selectedWitness.id}))),0<t.length&&(f=s.createElement("div",{className:it.a.breakButtons},s.createElement(ne.a,{title:"Page Break",accessoryType:"DELETE",icon:s.createElement(j,{width:20,height:20}),onClick:function(){n.props.deleteAnnotation(t[0])},isActive:!0,backgroundColor:tt.a.activeButton})),d=!1),0<e.length&&(h=s.createElement("div",{className:it.a.breakButtons},s.createElement(ne.a,{title:"Line Break",accessoryType:"DELETE",icon:"¶",onClick:function(){n.props.deleteAnnotation(e[0])},isActive:!0,backgroundColor:tt.a.activeButton})),y=!1),(y=!!d&&y)||(d=!1)),null),b={},v=(o.temporaryNotes&&0<o.temporaryNotes.length&&(g=o.temporaryNotes.map((function(t){var e="NOTE_"+t.uniqueId;return t.basedOn&&(b[t.basedOn.uniqueId]=t.uniqueId),s.createElement(vt,{note:t,key:e,saveNote:o.saveAnnotation,cancel:function(){return o.cancelEditAnnotation(t)}})}))),null),w=(o.notes&&0<o.notes.length&&(v=o.notes.filter((function(t){return!b.hasOwnProperty(t.uniqueId)})).map((function(t){var e="NOTE_"+t.uniqueId;return s.createElement(ee,{note:t,key:e,delete:n.props.deleteAnnotation,edit:n.props.editNote})}))),null),x={},O=(o.temporaryQuestions&&0<o.temporaryQuestions.length&&o.questionQuote&&(w=o.temporaryQuestions.map((function(t){x[t.uniqueId]=t.uniqueId;var e="QUESTION_"+t.uniqueId;return s.createElement(Ht,{question:t,questionQuote:o.questionQuote,defaultTitle:o.selectedWitness.text.name,key:e,saveQuestion:o.saveQuestion,cancel:function(){return o.cancelEditAnnotation(t)}})}))),[]),S=!1;if(o.questions&&0<o.questions.length){for(var E=[],T=0;T<o.questions.length;T++){var A=o.questions[T];!x.hasOwnProperty(A.uniqueId)&&o.questionsData.hasOwnProperty(A.uniqueId)&&(o.questionsData[A.uniqueId].loading&&(S=!0),E=E.concat(o.questionsData[A.uniqueId].questions))}O=E.map((function(t){return t.annotationUniqueId,s.createElement(Bt,{question:t,key:"question_"+t.annotationUniqueId})}))}var k=null,I=(0<O.length&&(k=s.createElement("h3",{className:it.a.sectionHeading},"Questions")),null),P=(S&&(I=s.createElement(Gt,null)),0===o.questions.length&&0===o.temporaryQuestions.length),C=[it.a.annotationControls],R=(o.inline&&C.push(it.a.inline),!0);return(a||p)&&(R=!1),s.createElement("div",{className:m.a.apply(void 0,C),ref:function(t){return n.controls=t}},R&&s.createElement(ve,{addPageBreak:d?o.addPageBreak:null,addLineBreak:y?o.addLineBreak:null,addNote:u&&!g?function(){return o.addNote()}:null,addQuestion:P?o.addQuestion:null,closeAnnotation:o.closeAnnotation,editAnnotationHandler:function(){var t=document.getElementById("editBtn");null!=t&&t.click()},userLoggedIn:u}),s.createElement("div",{className:it.a.annotationContent},a,l,!p&&i,!p&&r,f,h,g,v,k,w,I,O),s.createElement("div",{className:it.a.arrow,ref:function(t){return n.arrow=t}}))}}])&&xe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),o}(s.Component);var Ee=n(1030),Te=n.n(Ee),Ae=n(71),je=n(231),ke=n(10),Ie=n(3);function Pe(t,e){var n,o=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,n)),o}function Ce(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Pe(Object(n),!0).forEach((function(e){var o,r;o=t,r=n[e=e],e in o?Object.defineProperty(o,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):o[e]=r})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Pe(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Re(t){return function(t){if(Array.isArray(t))return We(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||Be(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _e(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var o,r,i=[],a=!0,s=!1;try{for(n=n.call(t);!(a=(o=n.next()).done)&&(i.push(o.value),!e||i.length!==e);a=!0);}catch(t){s=!0,r=t}finally{try{a||null==n.return||n.return()}finally{if(s)throw r}}return i}}(t,e)||Be(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Be(t,e){if(t){if("string"==typeof t)return We(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?We(t,e):void 0}}function We(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}function Ne(t,e,n,o){var r=[],i=e.filter((function(t){return t.isWorking||t.isBase})).map((function(t){return t.name}));if(t){for(var a={},s=0;s<t.length;s++)!function(e){var n=t[e];e=n.content+n.start;n.isTemporary?(a[Le]={name:n.getSourceName(),content:n.content,id:n.uniqueId,isTemporary:!0,annotation:n},i=i.filter((function(t){return t!==n.getSourceName()})),e=Le):i=a[e]?(a[e].name+=" "+Object(je.a)(n.getSourceName()),i.filter((function(t){return t!==n.getSourceName()}))):(a[e]={name:Object(je.a)(n.getSourceName()),content:n.content,id:n.uniqueId,userCreated:n.userCreated,annotation:n},i.filter((function(t){return t!==n.getSourceName()}))),!n.userCreated&&n.creatorWitness.isWorking?a[e].isWorking=!0:a[e].isWorking=!1}(s);i.unshift(n);var l=i;"བྱང་ཆུབ་སེམས་དཔའི་སྤྱོད་པ་ལ་འཇུག་པ་བཞུགས་སོ།"!==(null==o?void 0:o.name)&&(l=i.filter((function(t){return"Dominant"!==t}))),r=Object.keys(a).reduce((function(t,e){return(e=a[e]).isWorking&&(e.name=l.reduce((function(t,e){return t+" "+Object(je.a)(e,";")}),"")),t.push(e),t}),[])}return r}var Le=-3,De=Object(o.connect)((function(t,e){var n=ke.gb(t),o=ke.G(t),r=e.activeAnnotation,a=e.inline,s=ke.I(t);if(s||o&&(s=ke.mb(t,o.id)),!r||!s)return{annotationsData:null,activeAnnotation:null,baseAnnotation:null,availableAnnotations:null,user:n,temporaryAnnotation:null,inline:null,firstSelectedSegment:null,splitTextRect:null,selectedWitness:null};var u=function(t,e,n,o,r){return 0<(t=ke.S(t,n.id,o,r,e)).length?t[0]:null}(t,c.a.variant,s,r.start,r.length),p=function(t,e,n,o){var r=[];n&&e.naturalId===n.naturalId||r.push(e),n&&r.push(n);var a=(s=_e(t.getPositionOfAnnotation(e),2))[0],s=s[1];if(a){s=a+s;var l,u=[];e.isInsertion?((l=o["i"+a])&&(u=u.concat(l)),(l=o[String(a)])&&(u=u.concat(l))):((l=o[String(a)])&&(u=l),(a=o[String(s)])&&(u=u.concat(a)));for(var p=0;p<u.length;p++){var f=u[p];f.start===e.start&&f.length===e.length?n&&f.naturalId===n.naturalId||r.push(f):t.activeWitness.isWorking||f.type!==c.a.pageBreak&&f.type!==c.a.lineBreak||r.push(f)}r=i()(r,(function(t,e){return t.id===e.id}))}return r}(e.annotatedText,r,u,e.annotationPositions),f=Ne(f=p.filter((function(t){return t.type===c.a.variant})),y=ke.O(t),E=ke.fb(t,"annotation.workingEdition","Working"),o),d=(o=null,r.id==h.a?o=r:(T=(d=_e(e.annotatedText.getPositionOfAnnotation(r),2))[0],d=d[1],f=null===T||null===d?null:(T=Ne([o=e.annotatedText.getBaseAnnotation(T,d)],y,E),[].concat(Re(T),Re(f)))),f&&f.sort((function(t,e){return t.isTemporary?-1:e.isTemporary?1:t.userCreated?-1:!e.userCreated&&t.annotation.id&&e.annotation.id?t.annotation.id-e.annotation.id:1})),p.filter((function(t){return t.type===c.a.note}))),y=ke.S(t,s.id,r.start,r.length,c.a.note),m=p.filter((function(t){return t.type===c.a.question})),g={};if(0<m.length)for(var b=0;b<m.length;b++){var v=m[b],w=(g[v.uniqueId]={},ke.wb(t,v));w=(g[v.uniqueId].loading=w,ke.u(t,v.uniqueId));g[v.uniqueId].questions=w}var x,O,S,E,T=null,A=(0<(E=ke.S(t,s.id,r.start,r.length,c.a.question)).length&&(A=E[0],O=(A=_e(e.annotatedText.getPositionOfAnnotation(A),2))[0],A=A[1],O&&(A=(O=_e(e.annotatedText.segmentedText.extractTextAroundPosition(O,A=A||O+1,["།"," "]),3))[0],x=O[1],O=O[2],S=document.location.href,T=l.a.createElement("blockquote",null,A,l.a.createElement("a",{href:S},x),O))),Object(ke.X)(t));return{annotationsData:f,activeAnnotation:r,baseAnnotation:o,availableAnnotations:p,user:n,temporaryAnnotation:u,inline:a,firstSelectedSegment:e.firstSelectedSegment,splitTextRect:e.splitTextRect,selectedWitness:s,notes:d,temporaryNotes:y,questions:m,temporaryQuestions:E,questionsData:g,questionQuote:T,fontSize:A}}),null,(function(t,e,n){var o=e.dispatch;if(0<t.questions.length)for(var r=0;r<t.questions.length;r++){var i=t.questions[r],a=!0;(a=(!t.questionsData.hasOwnProperty(i.uniqueId)||!(0<t.questionsData[i.uniqueId].questions.length||t.questionsData[i.uniqueId].loading))&&a)&&o(new Ie.jc(i))}function s(e){var r=1<arguments.length&&void 0!==arguments[1]&&arguments[1];return function(){var i=n.activeAnnotation,a=(i=new c.c(null,i.witness,i.end+1,0,null,e,t.selectedWitness,t.user),ke.d(t.selectedWitness)),s=[];s.push(Ie.cc(i)),s.push(Ie.Gb(i.uniqueId,a)),r?s.push(Ie.Ub(i)):s.push(Ie.Ub(null)),o(Object(Ae.batchActions)(s))}}function l(e,n){var r,i,a;e.isTemporary?(r=t.selectedWitness,r=ke.d(r),(n=new c.c(e.id,e.witness,e.start,e.length,n,e.type,e.creatorWitness,t.user,e.uniqueId,e.basedOn)).isSaved=e.isSaved,i=[],a=null,a=n.isSaved?Ie.Vc:Ie.cc,i.push(a(n)),i.push(Ie.Dc(e)),i.push(Ie.Gb(n.uniqueId,r)),n.type===c.a.variant&&i.push(Ie.Ub(n)),o(Object(Ae.batchActions)(i))):console.warn("Tried to save a non-temporary annotation: %o",e)}return Ce(Ce(Ce({},t),n),{},{closeAnnotation:function(){var e;t.activeAnnotation&&(e=Ie.Ub(null),o(e))},didSelectAnnotation:function(e){var n=e.id==h.a?t.baseAnnotation:Te()(t.availableAnnotations,(function(t){return t.uniqueId==e.uniqueId}))||null,r=[],i=t.selectedWitness,a=ke.d(i);e.uniqueId!=t.activeAnnotation.uniqueId&&(i.isWorking?(e.id!=h.a&&r.push(Ie.Gb(n.uniqueId,a)),t.activeAnnotation.id!=h.a&&r.push(Ie.Bc(t.activeAnnotation.uniqueId,a))):t.activeAnnotation.creatorWitness.id===i.id?(r.push(Ie.Cc(t.activeAnnotation.uniqueId,a)),n.id!==h.a&&r.push(Ie.Gb(n.uniqueId,a))):(n.creatorWitness.id===i.id?r.push(Ie.Hb(n.uniqueId,a)):n.id!==h.a&&r.push(Ie.Gb(n.uniqueId,a)),t.activeAnnotation.id!==h.a&&r.push(Ie.Bc(t.activeAnnotation.uniqueId,a))),r.push(Ie.Ub(n)),o(Object(Ae.batchActions)(r)))},editAnnotation:function(e){var n=e.isWorkingAnnotation||e.userCreated||e.id===h.a?null:e;n=new c.b(n,e.witness,e.start,e.length,e.content,e.type,t.selectedWitness,t.user);e.userCreated&&(n.uniqueId=e.uniqueId,n.isSaved=e.isSaved),o(Ie.Fb(n,!0))},saveAnnotation:l,cancelEditAnnotation:function(t){var e;t.isTemporary?(e=Ie.Dc(t),o(e)):console.warn("Tried to call cancelEditAnnotation on a non-temporary annotation: %o",t)},deleteAnnotation:function(e){var n=t.selectedWitness,r=ke.d(n),i=[];i=e.userCreated?[Ie.ec(e,n),Ie.Bc(e.uniqueId,r)]:[Ie.Cc(e.uniqueId,r)],t.activeAnnotation.uniqueId===e.uniqueId&&i.push(Ie.Ub(null)),o(Object(Ae.batchActions)(i))},addNote:function(){var e=n.activeAnnotation;e=new c.b(null,e.witness,e.start,e.length,"",c.a.note,t.selectedWitness,t.user);o(Ie.Fb(e,!0))},editNote:function(e){e=new c.b(e,e.witness,e.start,e.length,e.content,c.a.note,t.selectedWitness,t.user),o(Ie.Fb(e,!0))},addPageBreak:s(c.a.pageBreak),addLineBreak:s(c.a.lineBreak),addQuestion:function(){var e=n.activeAnnotation;e=new c.b(null,e.witness,e.start,e.length,"",c.a.question,t.selectedWitness,t.user);o(Ie.Fb(e,!0))},saveQuestion:function(e,r,i){var a=((a=_e(n.annotatedText.getPositionOfAnnotation(e),2))[0],a[1],T.a.renderToStaticMarkup(t.questionQuote)+i);l(e,i),i=Ie.dc(e,r,a);o(i)}})}))(at),qe=(Ee=n(1036),n.n(Ee));function He(t){return(He="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Me(t,e){var n,o=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,n)),o}function ze(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Me(Object(n),!0).forEach((function(e){Ve(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Me(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Ve(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ue(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var o,r,i=[],a=!0,s=!1;try{for(n=n.call(t);!(a=(o=n.next()).done)&&(i.push(o.value),!e||i.length!==e);a=!0);}catch(t){s=!0,r=t}finally{try{a||null==n.return||n.return()}finally{if(s)throw r}}return i}}(t,e)||function(t,e){if(t){if("string"==typeof t)return Fe(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Fe(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Fe(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}function Qe(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Ge(t,e){return(Ge=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function $e(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Je(t){return(Je=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}parseInt(it.a.inlineWidth);var Xe="bdrcimg_pre",Ke={},Ze=function(t){var e=o;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ge(e,t);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,o=Je(t);n=e?(n=Je(this).constructor,Reflect.construct(o,arguments,n)):o.apply(this,arguments),o=this;if(n&&("object"===He(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return $e(o)}}(o);function o(t){var e;if(this instanceof o)return(e=n.call(this,t)).textAlignmentById=[],e.childRef=s.createRef("0"),e.list=null,e.splitText=null,e.cache=new O.b({fixedWidth:!0}),e.splitTextRef=s.createRef(null),e.rowRenderer=e.rowRenderer.bind($e(e)),e.textListVisible=t.textListVisible,e.editMenuVisible=t.editMenuVisible,e.isPanelLinked=t.isPanelLinked,e.activeSelection=null,e.selectedNodes=null,e._mouseDown=!1,e._activeWitness=null,e._didSetInitialScrollPosition=!1,e._modifyingSelection=!1,e.imageHeight=null,e.imageWidth=null,e.calculatedImageHeight=null,e.processProps(t),e.changeScrollToId=t.changeScrollToId,e.changeSyncIdOnClick=t.changeSyncIdOnClick,e.closeAnnotation=t.closeAnnotation,e.scrollJump=t.scrollJump,e.textAlignmentById=[],e.scrollEvent=e.scrollEvent.bind($e(e)),e.selectedWindow=t.selectedWindow,e.condition=!1,e;throw new TypeError("Cannot call a class as a function")}return e=o,(t=[{key:"scrollEvent",value:function(t){if(2===this.selectedWindow)return null;var e;1===this.selectedWindow&&this.isPanelLinked&&this.condition&&(e=[],this.textAlignmentById.map((function(t){var n=document.getElementById("s_"+t.start);n&&102<n.getBoundingClientRect().top&&e.push({id:t.id,start:t.start,target:t.TStart})})),v()(e)||1===this.selectedWindow&&this.debouncedScroll(e))}},{key:"updateList",value:function(){var t=!(0<arguments.length&&void 0!==arguments[0])||arguments[0],e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;if(!this.calculatedImageHeight&&this.imageHeight&&this.imageWidth&&(this.calculatedImageHeight=this.calculateImageHeight()),this.list){var n=this.list;if(t)if(null!==e)if(Array.isArray(e)){if(Array.isArray(e))for(var o=0;o<e.length;o++){var r=e[o];this.cache.clear(r)}}else this.cache.clear(e);else this.cache.clearAll(),n.measureAllRows(),n.recomputeRowHeights(0);n.forceUpdateGrid()}}},{key:"mouseDown",value:function(){this._mouseDown=!0}},{key:"mouseUp",value:function(){var t;this._mouseDown=!1,this.activeSelection&&(t=(t=this.processSelection(this.activeSelection))||[],this.props.didSelectSegmentIds(t),this.activeSelection=null)}},{key:"handleSelection",value:function(t){this._modifyingSelection?(t.stopPropagation(),this._modifyingSelection=!1):(this.activeSelection=document.getSelection(),this._mouseDown||this.mouseUp())}},{key:"processSelection",value:function(t){if(0===t.rangeCount||t.isCollapsed||"Caret"===t.type)return this.selectedNodes=null;var e=(t=t.getRangeAt(0)).startContainer;if(!(e=this.getNodeSegmentSpan(e))||!e.parentNode)return null;var n=this.getRangeNodes(t,e.parentNode),o=(0<n.length&&(o=n[0],t.startOffset===o.textContent.length&&n.shift()),t.endContainer);return(o=this.getNodeSegmentSpan(o))&&o.parentNode?(o&&e.parentNode!==o.parentNode?n=n.concat(this.getRangeNodes(t,o.parentNode)):0===t.endOffset&&n.pop(),e=[],(this.selectedNodes=n).reduce((function(t,e){return e instanceof Element&&t.push(e.id),t}),e),e):null}},{key:"getNodeSegmentSpan",value:function(t){for(var e=t,n=null,o=/^(i|s|ds)_/;!n&&e.parentNode;)e instanceof Element&&o.test(e.id)&&(n=e),e=e.parentNode;return n}},{key:"getRangeNodes",value:function(t,e){for(var n=[],o=0,r=e.childNodes.length;o<r;o++){var i=e.childNodes[o];t.intersectsNode(i)&&n.push(i)}return n}},{key:"getControlsMeasurements",value:function(t){if(!this.splitText)return null;var e=this.splitText,n=null,o=null,r=null,i=null,a=null,s=[],l=0;if(t.activeAnnotation){var u=t.activeAnnotation;if(null===(l=Ue(t.splitText.annotatedText.getPositionOfAnnotation(u),1)[0]))return console.warn("No startPos in getControlsMeasurements"),null;u.type===c.a.pageBreak&&--l,u.type===c.a.lineBreak&&--l;var p=l+u.length;0<u.length&&--p,n=t.splitText.getTextIndexOfPosition(p),i=e.getBoundingClientRect()}var f=[];if(t.selectedAnnotatedSegments&&0<t.selectedAnnotatedSegments.length){f=t.selectedAnnotatedSegments;for(var h=0;h<f.length;h++){var y=f[h];if(null===o&&y instanceof d.a){o=y;break}}o&&(a=0===o.length&&t.activeAnnotation&&t.activeAnnotation.isInsertion?(r=M(o),M):(r=q(o),q))}else t.activeAnnotation&&(t.activeAnnotation.isDeletion?(r=H(u=new d.a(l,"")),a=H,f=[o=u]):t.activeAnnotation.isInsertion?(p=Ue(t.splitText.annotatedText.getPositionOfAnnotation(t.activeAnnotation),1)[0])&&(r=M(e=new d.a(p,"")),a=M,f=[o=e]):t.activeAnnotation.type===c.a.pageBreak?(f=[o=new d.a(l+1,"")],s=[r=z(new d.a(l,""))]):t.activeAnnotation.type===c.a.lineBreak&&(f=[o=new d.a(l+1,"")],s=[r=V(new d.a(l,""))]));if(a)for(var m=0;m<f.length;m++){var g=f[m];g instanceof d.a&&(g=a(g),s.push(g))}return null!=n&&o&&r&&i?{selectedTextIndex:n,firstSelectedSegment:o,selectedElementId:r,splitTextRect:i,selectedElementIds:s}:null}},{key:"shouldResetListCache",value:function(t,e){var n=!1;return!(t.showImages===e.showImages&&!this.pageBreaksChanged(t,e))||n}},{key:"pageBreaksChanged",value:function(t,e){return t=t.splitText.getTextsFinalPositions(),e=e.splitText.getTextsFinalPositions(),t.length!==e.length||JSON.stringify(t)!==JSON.stringify(e)}},{key:"lineBreaksChanges",value:function(t,e){var n=t.activeAnnotation,o=e.activeAnnotation,r=!1;return n&&n.isType(c.a.lineBreak)&&e.activeAnnotations&&!e.activeAnnotations.hasOwnProperty(n.uniqueId)&&(r=!0),!(!(o&&o.isType(c.a.lineBreak)&&t.activeAnnotations)||t.activeAnnotations.hasOwnProperty(o.uniqueId))||r}},{key:"selectedListRow",value:function(t){var e=null;return t.activeAnnotation?t.splitText.getTextIndexOfPosition(t.activeAnnotation.start):e}},{key:"processProps",value:function(t){var e=this,n=!1;if((r=((!this.props.selectedWitness||t.selectedWitness&&t.selectedWitness.id!==this.props.selectedWitness.id)&&(this._didSetInitialScrollPosition=!(n=!0)),!t.selectedSearchResult||this.props.selectedSearchResult&&t.selectedSearchResult.start===this.props.selectedSearchResult.start&&t.selectedSearchResult.textId===this.props.selectedSearchResult.textId||(console.log("resetting scroll position from search result"),this._didSetInitialScrollPosition=!1),this._filteredSelectedAnnotatedSegments=t.selectedAnnotatedSegments.reduce((function(t,e){return e instanceof d.a&&t.push(e),t}),[]),this.getControlsMeasurements(t)))&&(this.selectedTextIndex=r.selectedTextIndex,this.firstSelectedSegment=r.firstSelectedSegment,this.splitTextRect=r.splitTextRect,this.selectedElementId=r.selectedElementId,this.selectedElementIds=r.selectedElementIds),t.textListVisible!==this.textListVisible||t.editMenuVisible!==this.editMenuVisible)setTimeout((function(){e.textListVisible=t.textListVisible,e.editMenuVisible=t.editMenuVisible,e.updateList(!0)}),500);else if(n)this.updateList(!0);else if(this.pageBreaksChanged(this.props,t)){var o=null,r=this.selectedListRow(this.props);n=this.selectedListRow(t);if(r&&n){o=[];for(var i=n<r?n:r,a=this.props.splitText.texts.length;i<a;i++)o.push(i)}this.updateList(!0,o)}else if(this.lineBreaksChanges(this.props,t)){n=(n=this.selectedListRow(t))||this.selectedListRow(this.props),r=this.props.splitText.texts;var s=[];if(null!==n){for(var l=n,c=r.length;l<c;l++)s.push(l);this.updateList(!0,s)}}else this.props.fontSize!==t.fontSize?this.updateList(!0):this.props.activeAnnotation&&t.activeAnnotation&&this.annotationsInSameLocation(this.props.activeAnnotation,t.activeAnnotation)?this.updateList(!0,this.selectedListRow(t)):this.updateList(this.shouldResetListCache(this.props,t))}},{key:"annotationsInSameLocation",value:function(t,e){return t.start===e.start&&t.length===e.length}},{key:"UNSAFE_componentWillReceiveProps",value:function(t){this.processProps(t)}},{key:"componentDidMount",value:function(){var t=this;this.list,this.resizeHandler=b()((function(){t.calculatedImageHeight=null,t.updateList()}),600).bind(this),this.debouncedScroll=g()((function(e){t.changeScrollToId({id:e[0].start,from:1})}),1e3),window.addEventListener("resize",this.resizeHandler),this.selectionHandler=g()((function(e){t.handleSelection(e)}),200).bind(this),document.addEventListener("selectionchange",this.selectionHandler),document.addEventListener("mousedown",this.mouseDown.bind(this),!0),document.addEventListener("mouseup",this.mouseUp.bind(this),!0),this.processProps(this.props),this.componentDidUpdate(),this.timer=setTimeout((function(){t.resizeHandler()}),2e3)}},{key:"componentDidUpdate",value:function(t){var e,n,o,r,i,a,s,l,c=this,u=this.props.textAlignment,p=(this.condition=(null==u||null==(s=u.source)?void 0:s.witness)===this.props.selectedWitness.id,this.props.scrollToId),f=this.list;(null==t?void 0:t.searchResults)===(null==(s=this.props)?void 0:s.searchResults)&&(null==t?void 0:t.syncIdOnSearch)===(null==(s=this.props)?void 0:s.syncIdOnSearch)||!this.props.searchResults||(t=this.props.syncIdOnSearch||null)&&(e=this.props.splitText.getTextIndexOfPosition(t),setTimeout((function(){f.scrollToRow(e),setTimeout((function(){f.scrollToPosition(f.props.scrollTop-300)}),0)}),100)),this.textAlignmentById=this.props.textAlignmentById,this.isPanelLinked=this.props.isPanelLinked,this.selectedWindow=this.props.selectedWindow,this.targetId=this.props.scrollToId,this.selectedNodes&&0<this.selectedNodes.length&&(n=this.selectedNodes,o=this.props.selectedAnnotatedSegments,setTimeout((function(){var t=document.createRange(),e=n[0],r=n[n.length-1],i=o[o.length-1];i instanceof d.a&&(i=document.getElementById(q(i)))&&(r=i),e instanceof Element&&r instanceof Element&&(e=document.getElementById(e.id),r=document.getElementById(r.id),e&&r&&(t.setStart(e,0),t.setEnd(r,r.childNodes.length),(i=document.getSelection())&&(c._modifyingSelection=!0,i.removeAllRanges(),i.addRange(t),c.selectedNodes=null)))}),0)),!this._didSetInitialScrollPosition&&this.list&&(r=this.list,(this.props.activeAnnotation||this.props.selectedSearchResult)&&(i=this.getSelectedTextIndex(),setTimeout((function(){r.scrollToRow(i),setTimeout((function(){r.scrollToPosition(r.props.scrollTop-300)}),0)}),100)),this._didSetInitialScrollPosition=!0),2==p.from&&this.isPanelLinked&&this.condition&&null!==p.id&&(a=this.list,this.textAlignmentById=this.props.textAlignmentById||[],this.splitText.style.scrollBehavior="smooth",u&&this.isPanelLinked&&null!==(t=null==(s=this.textAlignmentById.find((function(t){return t.TStart===p.id})))?void 0:s.start)&&(l=this.props.splitText.getTextIndexOfPosition(t),setTimeout((function(){a.scrollToRow(l),setTimeout((function(){a.scrollToPosition(a.props.scrollTop-300)}),0)}),100)))}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mousedown",this),document.removeEventListener("mouseup",this),window.removeEventListener("resize",this.resizeHandler),document.removeEventListener("selectionchange",this.selectionHandler),clearTimeout(this.timer)}},{key:"calculateImageHeight",value:function(){var t,e,n=null;return this.imageHeight&&this.imageWidth&&(t=this.imageWidth/this.imageHeight,e=qe.a.pechaImage,0<(e=document.getElementsByClassName(e)).length&&(n=e[0].offsetWidth/t)),n}},{key:"getSelectedTextIndex",value:function(){var t,e=0,n=null;return this.props.activeAnnotation?n=Ue(this.props.splitText.annotatedText.getPositionOfAnnotation(this.props.activeAnnotation),1)[0]:this.props.selectedSearchResult&&((t=this.props.splitText.annotatedText.segmentAtOriginalPosition(this.props.selectedSearchResult.start))instanceof d.a?n=t.start:"number"==typeof t&&(n=t)),n?this.props.splitText.getTextIndexOfPosition(n):e}},{key:"getBaseAnnotation",value:function(t){var e=Ue(this.props.splitText.annotatedText.getPositionOfAnnotation(t),1)[0];return this.props.splitText.annotatedText.getBaseAnnotation(e=null===e?0:e,t.content.length)}},{key:"render",value:function(){var t=this,e=this.props,n=this.rowRenderer,o=this.cache,r=e.selectedWitness?e.selectedWitness.id:0;return s.createElement("div",{className:qe.a.splitText,ref:function(e){return t.splitText=e},key:r,style:{cursor:this.props.isAnnotating?"text":"pointer"}},s.createElement("button",{id:"updateList",style:{display:"none"},onClick:this.resizeHandler}),s.createElement(w.a,null,(function(r){var i=r.height;r=r.width;return s.createElement(x.a,{ref:function(e){return t.list=e},height:i,rowCount:e.splitText.texts.length,rowHeight:o.rowHeight,rowRenderer:n,width:r,overscanRowCount:1,deferredMeasurementCache:o,onScroll:t.scrollEvent,scrollToAlignment:"start"})})))}},{key:"getImageUrl",value:function(t){if(!this.props.selectedWitness||!this.props.selectedWitness.properties)return"";var e=(o=this.props.selectedWitness.properties)[Xe],n=o.bdrcimg_number,o=o.bdrcimg_suffix;return"//iiif.bdrc.io/"+e+(Number(n)+t)+"."+o+"/full/full/0/default.jpg"}},{key:"getStringPositions",value:function(t,e,n){var o=this.props.splitText.annotatedText.getUniqueId();if((Ke=Ke.hasOwnProperty(o)?Ke:Ve({},o,{}))[o].hasOwnProperty(e)||(Ke[o]=Ve({},e,{})),Ke[o][e].hasOwnProperty(n))return Ke[o][e][n];for(var r=new E.a,i=t.getText(),a=null==(t=t.segments[0])?void 0:t.start,s=[],l=i.indexOf(e);-1!==l;)s.push(l),l=i.indexOf(e,l+1);var c={};if(0<s.length)for(var u=r.splitGraphemes(i),p=0,f=null,d=0;d<u.length;d++){var h=u[d],y=p+(h.length-1);null!==f?f+(e.length-1)<=y&&(c[f+a]=[f+a,y+a],f=null):-1!==s.indexOf(p)?e.length===h.length?c[p+a]=[p+a,y+a]:e.length>h.length&&(f=p):f=null,p+=h.length}return Ke[o][e][n]=c}},{key:"rowRenderer",value:function(t){var e=t.key,n=t.index,o=t.parent,r=(t=t.style,this.props),i=this.cache,a=r.showImages?qe.a.pechaImage:null,l=(r.selectedWitness&&r.selectedWitness.properties&&r.selectedWitness.properties.hasOwnProperty(Xe)&&this.getImageUrl(n),{}),c=this.props.searchValue;c&&0<c.length&&r.splitText&&(l=this.getStringPositions(r.splitText.texts[n],c,n)),r.showImages&&a&&this.calculatedImageHeight&&this.calculatedImageHeight,t=ze(ze({},t),{},{height:t.height+10});return s.createElement(O.a,{columnIndex:0,key:e,parent:o,rowIndex:n,cache:i},s.createElement("div",{key:e,style:t,className:qe.a.splitTextRow,ref:this.splitTextRef,id:"index_".concat(n)},s.createElement("div",{className:qe.a.splitTextRowContent},s.createElement(Q,{ref:this.childRef,segmentedText:r.splitText.texts[n],annotations:r.annotations,activeAnnotations:r.activeAnnotations,activeAnnotation:r.activeAnnotation,row:n,selectedSegmentId:r.selectedSegmentId,annotationPositions:r.annotationPositions,selectedAnnotatedSegments:this._filteredSelectedAnnotatedSegments,getBaseAnnotation:this.getBaseAnnotation.bind(this),activeWitness:this.props.selectedWitness,searchValue:c,selectedSearchResult:this.props.selectedSearchResult,searchStringPositions:l,fontSize:r.fontSize,changeSyncIdOnClick:this.props.changeSyncIdOnClick,changeScrollToId:this.props.changeScrollToId,isPanelLinked:this.props.isPanelLinked,isAnnotating:this.props.isAnnotating,textAlignmentById:this.props.textAlignmentById,selectedSourceRange:this.props.selectedSourceRange,selectedTargetRange:this.props.selectedTargetRange,changeSelectedRange:this.props.changeSelectedRange,condition:this.condition})),this.props.isAnnotating&&this.selectedTextIndex===n&&this.props.activeAnnotation&&s.createElement(De,{annotationPositions:r.annotationPositions,annotatedText:r.splitText.annotatedText,activeAnnotation:r.activeAnnotation,inline:!0,firstSelectedSegment:this.firstSelectedSegment,splitTextRect:this.splitTextRect,selectedElementId:this.selectedElementId,pechaImageClass:a,splitText:r.splitText,selectedElementIds:this.selectedElementIds,list:this.list})))}}])&&Qe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),o}(s.PureComponent),Ye=n(333);function tn(t){return function(t){if(Array.isArray(t))return en(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return en(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?en(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function en(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}n(154);at=n(1037);var nn=n.n(at),on=(Ee=n(216),n.n(Ee)),rn=(at=n(275),n.n(at)),an=(Ee=n(1038),n.n(Ee)),sn=(at=n(1039),n.n(at)),ln=n(955),cn=Object(s.memo)(Object(y.c)((function(t){var e=[],n="",o="",r=[];return t.witnesses&&t.activeWitness&&(o=t.witnesses.findIndex((function(e){return e.id===t.activeWitness.id})),(e=t.witnesses.map((function(t){return t}))).sort((function(t,e){return t.isWorking?-1:e.isWorking?1:t.isBase?-1:e.isBase?1:0})),e=e.sort((function(t,e){return t.id-e.id}))),0===e.length?null:l.a.createElement(ln.a,{onChange:function(n){v()(e)||t.onSelectedWitness(e[n.target.value])},className:sn.a.selectVersion,value:o,label:"Version",classes:{root:sn.a.selectEmpty,select:sn.a.selectOptions}},e.map((function(e,o){return e.id===t.activeWitness.id&&r.push(sn.a.selected),n=e.source.name,e.isWorking&&(n="en"===t.intl.locale?"User"===(null==(e=t.user)?void 0:e.name)?"Working":"My Edition":"མཉམ་འབྲེལ་པར་མ།"),l.a.createElement("option",{key:"versionSelect-".concat(o),value:o,className:sn.a.selectOptions},n)})))}))),un=n(976),pn=(Ee=n(1048),n.n(Ee)),fn=n(956),dn=n(966),hn=n(958);function yn(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var o,r,i=[],a=!0,s=!1;try{for(n=n.call(t);!(a=(o=n.next()).done)&&(i.push(o.value),!e||i.length!==e);a=!0);}catch(t){s=!0,r=t}finally{try{a||null==n.return||n.return()}finally{if(s)throw r}}return i}}(t,e)||function(t,e){if(t){if("string"==typeof t)return mn(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?mn(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function mn(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}n(16);var gn=Object(o.connect)((function(t){var e=ke.z(t),n=ke.x(t,e),o=ke.D(t),r=!1,i=ke.eb(t);return{texts:i=0<e.length?null===n?(r=!0,[]):i.filter((function(t){return n.hasOwnProperty(t.id)})):i,selectedText:Object(ke.G)(t),searchTerm:e,searchResults:n,selectedSearchResult:o,searching:r}}),(function(t){return{onSelectedText:function(e){t(Ie.Kc(e))}}}))((function(t){var e=Object(s.useRef)(t.texts),n=(i=yn(Object(s.useState)(e.current),2))[0],o=i[1],r=t.onSelectedText,i=t.selectedText,a=(t=yn(Object(s.useState)(!1),2))[0],c=t[1],u=(t=(i||n[0]).name,Object(s.useRef)(new un.c({fixedHeight:!0,defaultHeight:30,defaultWidth:400}))),p=[pn.a.textlist];return l.a.createElement(fn.a,{onClickAway:function(){return c(!1)}},l.a.createElement("div",{style:{position:"relative",border:"1px solid #eee"}},l.a.createElement(It.a,{onClick:function(){c((function(t){return!t})),!1===a&&p.push(pn.a.open)},className:pn.a.listToggelBtn,component:"div",sx:{overflow:"hidden",textOverflow:"ellipsis",width:"10rem",height:"100%"}},l.a.createElement(dn.a,{noWrap:!0},t)),a&&l.a.createElement("div",{className:m()(p),style:{position:"absolute"}},l.a.createElement(hn.a,{onChange:function(t){var r=t.target.value;o(e.current),""!==r&&null!==r&&(t=n.filter((function(t){return t.name.includes(r)})),o(t))},id:"standard-basic",label:"filter",variant:"standard",style:{width:"100%"}}),l.a.createElement(un.a,null,(function(t){var e=t.width;t=t.height;return l.a.createElement(un.d,{width:e,height:t,rowHeight:u.current.rowHeight,deferredMeasurementCache:u.current,rowCount:n.length,rowRenderer:function(t){var e=t.key,o=t.index,i=t.style,a=(t=t.parent,n[o]);return l.a.createElement(un.b,{key:"optionvalues-".concat(e),cache:u.current,parent:t,columnIndex:0,rowIndex:o},l.a.createElement("div",{style:i,onClick:function(){c(!1),r(a)}},l.a.createElement(It.a,{sx:{overflow:"hidden",textOverflow:"ellipsis",width:"13rem",paddingLeft:2,fontSize:{lg:12,md:11,sm:10,xs:10}},component:"div"},l.a.createElement(dn.a,{noWrap:!0},Object(je.a)(a.name)))))}})})))))})),bn=(at=n(997),n.n(at)),vn=n(950),wn=n(1065),xn=n(948),On=n(973),Sn=n(969);n(367),n(892),n(962),n(961),n(951),n(1049),n(366),y=n(1064),Ee=n(4),at=n(463),n(963),Object(Ee.a)(y.a)((function(t){return{"&.Mui-selected, &.Mui-selected:hover":{color:"white",backgroundColor:t.selectedcolor}}})),Object(at.a)({palette:{text:{primary:"#00398e"}}});var En=n(1050),Tn=n.n(En);function An(t){t=t.isSecondWindowOpen;var e=Object(s.useCallback)((function(){var t=document.getElementById("updateList"),e=document.getElementById("updateList2");t&&t.click(),e&&e.click()}),[t]);return Object(s.useEffect)((function(){var t=setTimeout((function(){e()}),500);return function(){return clearTimeout(t)}}),[t]),l.a.createElement(Sn.a,{variant:"text",size:"small",style:{padding:0,color:"black"},onClick:e},l.a.createElement(Tn.a,null))}En=n(978);var jn=n.n(En);function kn(t){return t=t.handleWindowSearch,l.a.createElement(Sn.a,{size:"small",variant:"text",onClick:t,style:{padding:0,color:"black"}},l.a.createElement(jn.a,null))}n(368),Object(Ee.a)(y.a)((function(t){return{"&.Mui-selected, &.Mui-selected:hover":{color:"white",backgroundColor:t.selectedcolor}}})),Object(at.a)({palette:{text:{primary:"#00398e"}}});var In=n(981),Pn=n(979),Cn=(En=n(994),n.n(En)),Rn=n(330),_n=n(947),Bn=n(971),Wn=n(965);function Nn(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var o,r,i=[],a=!0,s=!1;try{for(n=n.call(t);!(a=(o=n.next()).done)&&(i.push(o.value),!e||i.length!==e);a=!0);}catch(t){s=!0,r=t}finally{try{a||null==n.return||n.return()}finally{if(s)throw r}}return i}}(t,e)||function(t,e){if(t){if("string"==typeof t)return Ln(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ln(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ln(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}function Dn(t){var e=Nn(Object(s.useState)(!1),2),n=e[0],o=e[1],r=(e=Nn(Object(Rn.a)("WindowOneFont","Tibetan"),2))[0],i=e[1];return Object(s.useEffect)((function(){document.body.style.setProperty("--tibetan-fonts",r)}),[]),l.a.createElement(fn.a,{onClickAway:function(){return o(!1)}},l.a.createElement(It.a,null,l.a.createElement(Sn.a,{onClick:function(){o((function(t){return!t}))},size:"small",variant:"text",style:{padding:0,color:"black"}},l.a.createElement(In.a,{height:20,width:20})),l.a.createElement(_n.a,{in:n},l.a.createElement(Bn.a,{dense:!0,style:{position:"absolute",right:0,zIndex:2,top:30,backgroundColor:"#eee"}},l.a.createElement(Pn.a,{max:20,min:7,initialvalue:t.textFontSize,changeSize:t.onChangedFontSize}),l.a.createElement(xn.a,null),l.a.createElement(qn,{selectFont:function(t){i(t),document.body.style.setProperty("--tibetan-fonts","".concat(t));var e=document.getElementById("updateList"),n=1,r=setInterval((function(){e.click(),3<++n&&clearInterval(r)}),800);o(!1)},selectedfont:r}),l.a.createElement(Wn.a,{onClick:function(){return t.onExport()}},l.a.createElement(dn.a,{variant:"subtitle2"},"Export Document")),l.a.createElement(xn.a,null),l.a.createElement(Wn.a,{onClick:function(){return t.onChangePanelLink(!t.isPanelLinked)}},t.isPanelLinked&&l.a.createElement(Cn.a,null),l.a.createElement(dn.a,{variant:"subtitle2"},"link panels"))))))}var qn=function(t){var e=t.selectFont,n=(t=t.selectedfont,kt.c||[]);return l.a.createElement(It.a,{textAlign:"center"},l.a.createElement("span",null,"Font:")," ",l.a.createElement("select",{onChange:function(t){return e(t.target.value)},value:t},n.map((function(t,e){return l.a.createElement("option",{key:e+"-fontselect",value:t},t)}))))},Hn=(y=n(996),n.n(y)),Mn=(at=n(995),n.n(at));function zn(t){return l.a.createElement(l.a.Fragment,null,l.a.createElement(Jt.a,{onClick:function(){t.changeShowTableContent(!t.showTableContent)}},t.showTableContent?l.a.createElement(Mn.a,null):l.a.createElement(Hn.a,null)))}En=n(331);var Vn=n.n(En);function Un(t){return(Un="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Fn(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Qn(t,e){return(Qn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Gn(t){return(Gn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var $n=function(t){var e=o;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Qn(e,t);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,o=Gn(t);n=e?(n=Gn(this).constructor,Reflect.construct(o,arguments,n)):o.apply(this,arguments),o=this;if(n&&("object"===Un(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==o)return o;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(o);function o(t){if(this instanceof o)return n.call(this,t);throw new TypeError("Cannot call a class as a function")}return e=o,(t=[{key:"render",value:function(){var t=this,e=this.props.string,n=e,o=this.props.stringClass||"";if(this.props.searchTerm){var r=this.props.searchTerm,i=(new E.a).splitGraphemes(e),a=e.indexOf(r),l=a+r.length,c=0,u="";if(-1<a)for(var p=0;p<i.length;p++){var f=i[p];a<=c&&c<l&&(u+=f),c+=f.length}0<u.length&&(n=Vn()(e,u,(function(e,n){return s.createElement("span",{className:t.props.highlightClass,key:"highlight-".concat(n)},e)})))}return s.createElement("span",{className:o},n)}}])&&Fn(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),o}(s.Component),Jn=(y=n(1051),n.n(y));function Xn(t){function e(t){var e=t.key,i=t.index,s=t.parent,c=(t=t.style,r[i]);return l.a.createElement(un.b,{key:"listkeys2-".concat(e),cache:a.current,parent:s,columnIndex:0,rowIndex:i},l.a.createElement("div",{style:t},0<r.length&&l.a.createElement("div",{className:Jn.a.searchListItem,onClick:function(){return n(c[0])}},l.a.createElement($n,{string:c[1],highlightClass:Jn.a.highlight,searchTerm:o}))))}var n=t.handleListItemClick,o=t.searchValue,r=t.results,i=(t.selectedText,Object(s.useRef)()),a=Object(s.useRef)(new un.c({fixedWidth:!0,defaultHeight:100}));return r?l.a.createElement(l.a.Fragment,null,l.a.createElement(un.a,null,(function(t){var n=t.height;t=t.width;return l.a.createElement(un.d,{ref:i,height:n,rowCount:null==r?void 0:r.length,rowHeight:a.current.rowHeight,deferredMeasurementCache:a.current,rowRenderer:e,width:t,overscanRowCount:1})}))):null}function Kn(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var o,r,i=[],a=!0,s=!1;try{for(n=n.call(t);!(a=(o=n.next()).done)&&(i.push(o.value),!e||i.length!==e);a=!0);}catch(t){s=!0,r=t}finally{try{a||null==n.return||n.return()}finally{if(s)throw r}}return i}}(t,e)||function(t,e){if(t){if("string"==typeof t)return Zn(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Zn(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Zn(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}function Yn(t,e){var n,o=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,n)),o}function to(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Yn(Object(n),!0).forEach((function(e){eo(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Yn(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function eo(t,e,n){e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n}at=l.a.memo((function(t){var e=(c=Kn(Object(s.useState)(""),2))[0],n=c[1],o=(c=Kn(Object(s.useState)(!1),2))[0],r=c[1],i=(c=Kn(Object(s.useState)(!1),2))[0],a=c[1],c=Object(s.useRef)(),u=Object(s.useRef)(),p=l.a.useRef(g()((function(e){t.searchChanged(e)}),1e3)).current,f=Object(s.useCallback)((function(t){t.preventDefault(),p(e),a(!0)}),[e]),d=Object(s.useCallback)((function(){!1===o&&p(null),r(!o)}),[o]),h=(Object(s.useEffect)((function(){!0===o&&u.current.focus(),!1===o&&p(null)}),[o]),Object(s.useCallback)((function(){a(!1),p(null),n("")}),[])),y=Object(s.useMemo)((function(){return rn()(t.searchResults)&&t.searchResults.hasOwnProperty(t.selectedText.id)}),[t.searchResults,t.selectedText]),m=y?t.searchResults[t.selectedText.id].results:[];return l.a.createElement(vn.a,{ref:c,direction:"column",spacing:1,sx:{background:"#f7f7f7",paddingInline:{md:2,xs:0},paddingBlock:{md:1,xs:0},marginTop:{md:0,xs:1}}},l.a.createElement(vn.a,{direction:"row",spacing:1,justifyContent:"space-between"},l.a.createElement(It.a,{sx:{display:"flex",gap:{md:2,sx:0},flexDirection:{md:"row",xs:"column"}}},l.a.createElement(gn,null),l.a.createElement(cn,{witnesses:t.witnesses,activeWitness:t.selectedWitness,onSelectedWitness:t.onSelectedWitness,user:t.user})),l.a.createElement(wn.a,{size:"small",sx:{position:"relative",display:"flex",height:"fit-content",alignItems:"center",justifyContent:"center",width:"fit-content",border:function(t){return"1px solid ".concat(t.palette.divider)},borderRadius:1,bgcolor:"background.paper",color:"text.secondary","& svg":{m:1},"& hr":{mx:.5}},className:an.a.button_group_menu},l.a.createElement(An,{isSecondWindowOpen:t.isSecondWindowOpen}),l.a.createElement(xn.a,{orientation:"vertical",variant:"middle",flexItem:!0}),l.a.createElement(kn,{handleWindowSearch:d}),l.a.createElement(Dn,t),l.a.createElement(zn,t))),l.a.createElement(On.a,{in:o},l.a.createElement("form",{onSubmit:f},l.a.createElement(vn.a,{direction:"row",spacing:2,position:"relative"},l.a.createElement(hn.a,{hiddenLabel:!0,id:"filled-hidden-label-small",inputProps:{style:{height:25,padding:"0 14px"}},style:{height:25,flex:1},fullWidth:!0,inputRef:u,value:e,onChange:function(t){return n(t.target.value)}}),l.a.createElement(Sn.a,{variant:"outlined",size:"small",onClick:f,style:{height:25}},"Search"),t.searchResults&&i&&l.a.createElement(It.a,{sx:((c="boxShadow")in(f={position:"absolute",top:35,right:0,zIndex:1,background:"#eee",height:350,width:350,boxShadow:d=3,overflowX:"hidden"})?Object.defineProperty(f,c,{value:d,enumerable:!0,configurable:!0,writable:!0}):f[c]=d,f)},0===m.length&&l.a.createElement("p",null,"no such word present"),y&&0<m.length&&l.a.createElement(Xn,{handleListItemClick:function(e){t.changeSelectSyncId(e)},searchValue:t.searchValue,results:m,selectedText:t.selectedText}),l.a.createElement(Jt.a,{"aria-label":"closeButton",onClick:h,size:"small",sx:{right:15,top:0,position:"absolute"}},l.a.createElement(bn.a,{fontSize:"inherit"})))))))}));var no=Object(o.connect)((function(t){var e,n,o=ke.G(t),r=ke.H(t),i=[],a=!1,s=(o&&(i=ke.cb(t,o.id),(s=ke.J(t,o.id))?(e=ke.ib(t,s),a=ke.p(t,s)):e=ke.mb(t,o.id)),r&&(n=(s=ke.K(t,r.id))?ke.jb(t,s):ke.nb(t,r.id)),ke.X(t)),l=ke.z(t);return{witnesses:i,selectedText:o,selectedText2:r,selectedWitness:e,selectedWitness2:n,textListIsVisible:Object(ke.Z)(t),accountOverlayVisible:Object(ke.e)(t),textFontSize:s,isSecondWindowOpen:ke.vb(t),exportingWitness:a,isPanelLinked:ke.tb(t),user:ke.gb(t),isAnnotating:ke.rb(t),searchValue:l,showTableContent:ke.M(t),searchResults:ke.x(t,l)}}),null,(function(t,e,n){var o=e.dispatch,r=t.selectedText;return to(to(to({},n),t),{},(eo(n={navigationButtonClicked:function(){e.dispatch(Ie.ac(!t.textListIsVisible))},onSelectedWitness:function(t){o(Ie.Mc(null==r?void 0:r.id,null==t?void 0:t.id))},onChangedFontSize:function(t){o(Ie.Yb(t))},onChangeWindowOpen:function(t,e){o(Ie.Tc(t,e))},onExport:function(){o(Ie.fc(t.selectedWitness.id,"docx"))}},"navigationButtonClicked",(function(){o(Ie.ac(!t.textListIsVisible))})),eo(n,"onChangePanelLink",(function(t){o(Ie.Lb(t))})),eo(n,"changeIsAnnotating",(function(t){o(Ie.Jb(t)),!1===t&&(t=Ie.Ub(null),o(t),o(Ie.Ub(null)))})),eo(n,"searchChanged",(function(t){o(Ie.Vb(t))})),eo(n,"changeShowTableContent",(function(t){o(Ie.Rc(t))})),eo(n,"changeSelectSyncId",(function(t){o(Ie.Qb(t))})),n))}))(at),oo=n(953),ro=(En=n(1052),n.n(En)),io=n(882),ao=(y=n(62),n(1066));function so(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var lo=Object(Ee.a)("div")((function(t){return so({position:"relative",borderRadius:(t=t.theme).shape.borderRadius,backgroundColor:Object(io.a)(t.palette.common.white,.15),"&:hover":{backgroundColor:Object(io.a)(t.palette.common.white,.25)},marginLeft:0,width:"100%"},t.breakpoints.up("sm"),{marginLeft:t.spacing(1),width:"auto"})})),co=Object(Ee.a)("div")((function(t){return{padding:t.theme.spacing(0,2),height:"100%",position:"absolute",pointerEvents:"none",display:"flex",alignItems:"center",justifyContent:"center"}})),uo=Object(Ee.a)(y.c)((function(t){return{color:"inherit","& .MuiInputBase-input":so({padding:(t=t.theme).spacing(1,1,1,0),paddingLeft:"calc(1em + ".concat(t.spacing(4),")"),transition:t.transitions.create("width"),width:"100%"},t.breakpoints.up("sm"),{width:"0",cursor:"pointer","&:focus":{width:"20ch"}})}}));function po(){var t=[{Id:1,Title:"chapter 1",segment_id:0},{Id:2,Title:"chapter 2",segment_id:400}];return t.length,l.a.createElement(It.a,{className:ro.a.TableContent},l.a.createElement(ao.a,{sx:{justifyContent:"space-between",paddingLeft:"0 !important",margin:0}},l.a.createElement(dn.a,{textTransform:"uppercase",component:"h6"},"Table Of Content"),l.a.createElement(lo,null,l.a.createElement(co,null,l.a.createElement(jn.a,null)),l.a.createElement(uo,{placeholder:"Search…",inputProps:{"aria-label":"search"}}))),l.a.createElement(It.a,null,t.map((function(t,e){return l.a.createElement(It.a,{key:"TableContent-"+e,sx:{cursor:"pointer",width:"fit-content","&:hover":{fontWeight:"bold"}}},t.Title)}))))}function fo(t){return(fo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ho(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function yo(t,e){return(yo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function mo(t){return(mo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var go,bo,vo,wo,xo=0,Oo=(at=function(t){var e=o;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&yo(e,t);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,o=mo(t);n=e?(n=mo(this).constructor,Reflect.construct(o,arguments,n)):o.apply(this,arguments),o=this;if(n&&("object"===fo(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==o)return o;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(o);function o(){var t;if(this instanceof o)return(t=n.call(this)).key=xo++,t.ref=l.a.createRef(),t.selectedWindow=null,t;throw new TypeError("Cannot call a class as a function")}return e=o,(t=[{key:"mouseEnter",value:function(){2===this.selectedWindow&&this.props.changeSelectedWindow(1)}},{key:"componentDidMount",value:function(){this.ref.current.addEventListener("mouseenter",this.mouseEnter.bind(this))}},{key:"componentDidUpdate",value:function(){this.selectedWindow=this.props.selectedWindow}},{key:"render",value:function(){this.props.text&&this.props.text;var t,e,n=null;n=[this.props.annotatedText&&this.props.text&&!this.props.loading?(t=this.props.paginated?(t=this.props.pageBreaks,0===(e=tn(t))[0]&&e.shift(),function(t){return e}):Object(Ye.a)(1e3,/^།[\s]+(?!།[\s]+)/,2,5),n=new G.a(this.props.annotatedText,t),l.a.createElement(Ze,{splitText:n,annotations:this.props.annotations,activeAnnotations:this.props.activeAnnotations,activeAnnotation:this.props.activeAnnotation,limitWidth:!1,didSelectSegmentIds:this.props.didSelectSegmentIds,selectedSegmentId:this.props.selectedSegmentId,annotationPositions:this.props.annotationPositions,selectedAnnotatedSegments:this.props.selectedAnnotatedSegments,textListVisible:this.props.textListVisible,showImages:this.props.pageImagesVisible,imagesBaseUrl:this.props.imagesBaseUrl,selectedWitness:this.props.selectedWitness,key:this.key,selectedSearchResult:this.props.selectedSearchResult,searchValue:this.props.searchValue,fontSize:this.props.fontSize,isSecondWindowOpen:this.props.isSecondWindowOpen,changeScrollToId:this.props.changeScrollToId,changeSyncIdOnClick:this.props.changeSyncIdOnClick,imageData:this.props.imageData,isPanelLinked:this.props.isPanelLinked,selectedImage:this.props.selectedImage,changeSelectedImage:this.props.changeSelectedImage,isAnnotating:this.props.isAnnotating,closeAnnotation:this.props.closeAnnotation,textAlignment:this.props.textAlignment,textAlignmentById:this.props.textAlignmentById,isPanelVisible:this.props.isPanelVisible,scrollToId:this.props.scrollToId,selectedWindow:this.props.selectedWindow,selectedSourceRange:this.props.selectedSourceRange,selectedTargetRange:this.props.selectedTargetRange,changeSelectedRange:this.props.changeSelectedRange,searchResults:this.props.searchResults,showTableContent:this.props.showTableContent,selectedText:this.props.text,syncIdOnSearch:this.props.syncIdOnSearch})):l.a.createElement("div",{key:this.key})];return l.a.createElement(It.a,{style:{height:"100%",flex:1},className:m()(nn.a.textDetail,on.a.flex,on.a.flexColumn),key:this.key,ref:this.ref},l.a.createElement(no,null),l.a.createElement(zt.a,{loaded:!this.props.loading,zIndex:5}),l.a.createElement(It.a,{style:{display:"flex",height:"100%",width:"100%",position:"relative"}},l.a.createElement(It.a,{style:{flex:1},className:m()(nn.a.textContainer,on.a.flex)},this.props.loading?l.a.createElement("div",null):n),l.a.createElement(oo.a,{direction:"left",in:this.props.showTableContent,container:this.ref.current},l.a.createElement(It.a,{sx:{position:"absolute",height:"100%",minWidth:"50%",right:0,background:"#eee",borderLeft:"1px solid gray",padding:2}},l.a.createElement(po,null)))))}}])&&ho(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),o}(l.a.Component),n(177),n(82));function So(t,e){var n,o=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,n)),o}function Eo(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?So(Object(n),!0).forEach((function(e){var o,r;o=t,r=n[e=e],e in o?Object.defineProperty(o,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):o[e]=r})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):So(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function To(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var o,r,i=[],a=!0,s=!1;try{for(n=n.call(t);!(a=(o=n.next()).done)&&(i.push(o.value),!e||i.length!==e);a=!0);}catch(t){s=!0,r=t}finally{try{a||null==n.return||n.return()}finally{if(s)throw r}}return i}}(t,e)||Ao(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ao(t,e){if(t){if("string"==typeof t)return jo(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?jo(t,e):void 0}}function jo(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}function ko(t){return[t.start,t.length].join("-")}function Io(t,e){var n=[];if(r()(t,(function(t){return n.push(t.start)})),n=n.sort((function(t,e){return t-e})),e){var o=[];if(r()(e,(function(t){return o.push(t.start)})),o=o.sort((function(t,e){return t-e})),0===n.length)return o;if(n.length/o.length<.9)for(var i=n[n.length-1],a=0,s=o.length;a<s;a++){var l=o[a];i<l&&n.push(l)}}return n}var Po=null;En=Object(o.connect)((function(t){var e=Object(ke.gb)(t),n=t.data.loadingWitnesses||t.data.loadingAnnotations,o=Object(ke.Z)(t),r=ke.tb(t),i=ke.W(t);if(n)return{text:null,witnesses:null,baseWitness:null,annotations:null,loading:n,paginated:null,pageImagesVisible:!1,annotatedText:null,selectedAnnotatedSegments:null,annotationPositions:null,activeAnnotations:null,activeAnnotation:null,user:e,textListVisible:o,fontSize:kt.a,isSecondWindowOpen:Object(ke.vb)(t),isPanelLinked:r,textAlignmentById:i};var a,s,l,u=Object(ke.G)(t),p={},f=(u&&(a=Object(ke.mb)(t,u.id),s=Object(ke.n)(t,u.id)),Object(ke.D)(t)),y={},m=[],g=null,b=Object(ke.h)(t),v=[],w={},x=[],O="",S=Object(ke.z)(t),E=!1,T=Object(ke.X)(t);if(a&&u&&t.data.witnessAnnotationsById.hasOwnProperty(a.id)){p=Object(ke.cb)(t,u.id),g=((l=(A=Object(ke.J)(t,u.id))?Object(ke.ib)(t,A):l)||(A=(l=a).id),l.id!==a.id&&(E=!0,Object(ke.xb)(t)),Oo.d(t,l.id)),w=(A=To(Oo.c(t,l,a),2))[0],m=A[1];if(g&&(y=function(t,e){if(t===go&&e===bo&&t.version===wo)return vo;for(var n={},o={},r=0;r<e.length;r++)!function(r){var i=e[r],a=(r=To(t.getPositionOfAnnotation(i),2))[0],s=r[1];if(null!=a)if(0===s){if(i.isInsertion){if(r=ko(i),r=o[r])return r.map((function(t){return n[t].push(i)}));a=h.c+a}i.isDeletion&&0<i.length&&(a=h.b+a),i.type===c.a.pageBreak&&(a=h.e+a),i.type===c.a.lineBreak&&(a=h.d+a),void 0===n[a]&&(n[a]=[]),-1===n[a].indexOf(i)&&n[a].push(i)}else{for(var l=[],u=a;u<a+s;u++)void 0===n[u]&&(n[u]=[]),-1===n[u].indexOf(i)&&n[u].push(i),l.push(u);i.isInsertion&&(r=ko(i),o[r]=l)}}(r);return bo=e,vo=n,wo=(go=t).version,n}(g,Object.values(m))),b&&g&&(b=Po&&Po.id===l.id?b:g.getAnnotation(b.start,b.length))&&(v=g.segmentsForAnnotation(b)),l&&s&&g){var A=g.getAnnotationsOfType(c.a.pageBreak)||{},j=null;l.id!==s.id&&(j=Object(ke.m)(t,a.id,c.a.pageBreak,s.id));for(var k=0,I=(x=Io(A,j)).length;k<I;k++){var P=x[k];(P=g.segmentAtOriginalPosition(P))instanceof d.a?x[k]=P.start:P instanceof Number&&(x[k]=P)}E&&(O="/static/images/texts/"+u.name+"/"+l.source.name+"/")}}Po=l;A=ke.w(t),j=ke.V(t);var C=ke.P(t),R=ke.L(t);return{text:u,witnesses:p,workingWitness:a,baseWitness:s,annotations:m,loading:n,paginated:E,pageImagesVisible:!1,annotatedText:g,selectedAnnotatedSegments:v,annotationPositions:y,activeAnnotations:Eo({},w),activeAnnotation:b,pageBreaks:x,imagesBaseUrl:O,user:e,textListVisible:o,selectedWitness:l,selectedSearchResult:f,searchValue:S,fontSize:T,isSecondWindowOpen:Object(ke.vb)(t),imageData:Object(ke.q)(t),isPanelLinked:r,selectedImage:Object(ke.B)(t),isImagePortrait:Object(ke.sb)(t),isPanelVisible:Object(ke.ub)(t),isAnnotating:ke.rb(t),textAlignment:j,textAlignmentById:i,scrollToId:A,syncIdOnClick:C,selectedWindow:R,selectedSourceRange:Object(ke.E)(t),selectedTargetRange:Object(ke.F)(t),searchResults:Object(ke.x)(t,S),showTableContent:Object(ke.M)(t),syncIdOnSearch:ke.Q(t)}}),null,(function(t,e,n){function o(t,e,n){var o=[],r=[],i=[];(t=b[t])&&(o=t.filter((function(t){return t.type===c.a.variant})),r=t.filter((function(t){return t.type===c.a.pageBreak})),i=t.filter((function(t){return t.type===c.a.lineBreak}))),t=a()(o.concat(r,i),g.annotations,(function(t,e){return t.toString()==e.toString()})),r=null,r=0<t.length?t[0]:o&&0<o.length?(i=function(t){for(var e=null,n=0;n<t.length;n++){var o=t[n];(!e||o.length>e.length)&&(e=o)}return e}(o),o=(t=To(g.getPositionOfAnnotation(i),2))[0],t=t[1],i&&i.isInsertion&&(t=0),g.getBaseAnnotation(o,t)):g.getBaseAnnotation(e,n);m(Object(Ie.Ub)(r))}function r(t){return-1!==t.indexOf("i_")}function s(t){return-1!==t.indexOf("ds_")}function l(t){return-1!==t.indexOf("p_")}function d(t){return-1!==t.indexOf("l_")}function y(t){return!r(t)&&s(t)?t.substr(3):t.substr(2)}var m=e.dispatch,g=t.annotatedText,b=t.annotationPositions;return Eo(Eo(Eo({},t),n),{},{didSelectSegmentIds:function(e){if(0!==e.length){var n,o=[],l=[],d=function(t,e){var n,o="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!o){if(Array.isArray(t)||(o=Ao(t))||e&&t&&"number"==typeof t.length)return o&&(t=o),n=0,{s:e=function(){},n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:e};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i=!0,a=!1;return{s:function(){o=o.call(t)},n:function(){var t=o.next();return i=t.done,t},e:function(t){a=!0,r=t},f:function(){try{i||null==o.return||o.return()}finally{if(a)throw r}}}}(e);try{for(d.s();!(n=d.n()).done;){var v,w,x,O=n.value;s(O)||r(O)||(v=y(O),w=g.segmentedText.segmentAtPosition(v),l.push(w),(x=b[w.start])&&(o=o.concat(x)))}}catch(e){d.e(e)}finally{d.f()}o=i()(o,(function(t,e){return t.toString()==e.toString()}));var S,E,T=a()(o,g.annotations,(function(t,e){return t.toString()==e.toString()})),A=function(t,e,n,o){if(0===t.length)return null;for(var r=t[0],i=(t=t[t.length-1],r.start),a=t.end,s=null,l=null,c=0;c<n.length;c++){var u=n[c],p=null,f=(d=To(o.getPositionOfAnnotation(u),2))[0],d=d[1];-1!==e.indexOf(u)?(f&&f<i&&(i=f,s=u),(p=f+d-1)&&a<p&&(l=a=p)):a<(p=f+d-1)&&(a=p)}return{start:i,length:a-i+1,annotation:s&&l&&s===l?s:null}}(l,T,o,t.annotatedText);A?(S=g.getBaseAnnotation(A.start,A.length),null,E=A.annotation||(0<T.length?(T=g.segmentedText.segmentsInRange(A.start,A.length).reduce((function(t,e){return t+e.text}),""),t.selectedWitness||console.log("no stateProps.selectedWitness: %o",t.selectedWitness),new c.c(h.f,function(t){var e=new u.b(h.f,u.a);return t=new f.a(t.id,t.name),new p.a(h.f,t,e,"",!1)}(t.text),S.start,S.length,T,c.a.variant,t.selectedWitness,t.user)):S),m(Object(Ie.Ub)(E))):console.warn("No range for selected segment ids: %o",e)}},selectedSegmentId:function(e){var n,i=y(e),a=i;r(e)?a=h.c+i:s(e)?a=h.b+i:l(e)?a=h.e+i:d(e)&&(a=h.d+i),b[a],""===e?t.activeAnnotation&&(n=Ie.Ub(null),m(n)):r(e)||s(e)||l(e)||d(e)?o(a,i,0):(n=Number(y(e)),(a=g.segmentedText.segmentAtPosition(n))&&o(a.start,a.start,a.length))},changeScrollToId:function(t){return m(Ie.Mb(t))},changeSyncIdOnClick:function(t){return m(Ie.Pb(t))},changeSelectedImage:function(t){m(Ie.Fc(t))},changeSelectedWindow:function(t){m(Ie.Ob(t))},changeSelectedRange:function(t){m(Ie.Nb(t))},changeShowTableContent:function(t){m(Ie.Rc(t))},closeAnnotation:function(){var t=Ie.Ub(null);m(t)}})}))(at);e.default=En},974:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var o=n(188);function r(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}n(69);var i=function(){function t(e,n){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.annotatedText=e,this.splitter=n,this._texts=null,this._textsId=null,this._textsFinalPositions=[]}var e,n;return e=t,(n=[{key:"texts",get:function(){if(!this.annotatedText)return[];if(!this._texts||this._textsId!==this.annotatedText.getUniqueId()){this._textsFinalPositions=[];var t=this.annotatedText.segmentedText,e=t.getText(),n=this.splitter(e).filter((function(t){return 0!==t}));if(0===n.length)return this._textsFinalPositions.push(e.length),[t];n[n.length-1]+1<e.length&&n.push(e.length-1);for(var r=t.segments,i=0,a=[],s=0;s<n.length;s++){var l=n[s],c=(l=t.indexOfSegmentAtPosition(l-1),void 0);c=s==n.length-1?r.slice(i):r.slice(i,l+1),c=new o.a(c);a.push(c),i=l+1,0<=l&&(c=r[l],this._textsFinalPositions.push(c.end))}this._texts=a.filter((function(t){return 0<t.segments.length})),this._textsId=this.annotatedText.getUniqueId()}return this._texts||[]}},{key:"getTextsFinalPositions",value:function(){return this.texts,this._textsFinalPositions}},{key:"getTextIndexOfPosition",value:function(t){for(var e=this.getTextsFinalPositions(),n=0,o=null,r=0;r<e.length;r++){var i=e[r];if(n<=t&&t<=i){o=r;break}n=i}return null===o&&(console.warn("no index for position %d",t),o=e.length-1),o}}])&&r(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}()},975:function(t,e,n){t.exports={"green-tint":"#88af8e","blue-tint":"#024279","active-button":"#00746b",mainTint:"#024279",activeButton:"#00746b",inlineWidth:"280px",annotationControls:"AnnotationControls---annotationControls",annotationContent:"AnnotationControls---annotationContent",subTitle:"AnnotationControls---subTitle",title:"AnnotationControls---title",sectionHeading:"AnnotationControls---sectionHeading",text:"AnnotationControls---text",padding:"AnnotationControls---padding",arrowTop:"AnnotationControls---arrowTop",arrowLeft:"AnnotationControls---arrowLeft",arrowRight:"AnnotationControls---arrowRight",inline:"AnnotationControls---inline",arrow:"AnnotationControls---arrow",arrowDs:"AnnotationControls---arrowDs",nothingSelected:"AnnotationControls---nothingSelected",anonymousMessage:"AnnotationControls---anonymousMessage",noNotes:"AnnotationControls---noNotes",breakButtons:"AnnotationControls---breakButtons"}},977:function(t,e,n){t.exports={"green-tint":"#88af8e","blue-tint":"#024279","active-button":"#00746b",mainTint:"#024279",activeButton:"#00746b",save:"Button---save",cancel:"Button---cancel",buttonContainer:"Button---buttonContainer"}},979:function(t,e,n){"use strict";var o=n(325),r=n.n(o),i=n(0),a=n.n(i),s=(o=n(982),n.n(o));function l(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var o,r,i=[],a=!0,s=!1;try{for(n=n.call(t);!(a=(o=n.next()).done)&&(i.push(o.value),!e||i.length!==e);a=!0);}catch(t){s=!0,r=t}finally{try{a||null==n.return||n.return()}finally{if(s)throw r}}return i}}(t,e)||function(t,e){if(t){if("string"==typeof t)return c(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}e.a=function(t){var e=t.max,n=(t.min,t.initialvalue),o=void 0===(t=t.changeSize)?function(t){return console.log(t)}:t,c=(t=n/e*100,(t=l(Object(i.useState)(t),2))[0]),u=t[1];t=r()((function(t){o(Math.floor(parseInt(c/100*e)))}),500);return a.a.createElement("div",{className:s.a.inputRanges},a.a.createElement("span",{style:{fontSize:13,top:"-5px"},onClick:function(){return o(n-2)}},"ཀ"),a.a.createElement("input",{type:"range",style:{width:"70%"},className:s.a.inputRange,min:40,max:100,smooth:"yes",step:1,value:c,onChange:function(t){return u(t.target.value)},onMouseUp:t,onTouchEnd:t}),a.a.createElement("span",{style:{fontSize:18,top:"-10px"},onClick:function(){return o(n+2)}},"ཀ"))}},981:function(t,e,n){"use strict";var o=n(0),r=n.n(o);function i(){return(i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n,o=arguments[e];for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])}return t}).apply(this,arguments)}var a=r.a.createElement("path",{d:"M507.73 109.1c-2.24-9.03-13.54-12.09-20.12-5.51l-74.36 74.36-67.88-11.31-11.31-67.88 74.36-74.36c6.62-6.62 3.43-17.9-5.66-20.16-47.38-11.74-99.55.91-136.58 37.93-39.64 39.64-50.55 97.1-34.05 147.2L18.74 402.76c-24.99 24.99-24.99 65.51 0 90.5 24.99 24.99 65.51 24.99 90.5 0l213.21-213.21c50.12 16.71 107.47 5.68 147.37-34.22 37.07-37.07 49.7-89.32 37.91-136.73zM64 472c-13.25 0-24-10.75-24-24 0-13.26 10.75-24 24-24s24 10.74 24 24c0 13.25-10.75 24-24 24z"});e.a=function(t){return r.a.createElement("svg",i({viewBox:"0 0 512 512"},t),a)}},982:function(t,e,n){t.exports={inputRanges:"Slider---inputRanges",inputRange:"Slider---inputRange"}},991:function(t,e,n){t.exports={"green-tint":"#88af8e","blue-tint":"#024279","active-button":"#00746b",mainTint:"#024279",activeButton:"#00746b",annotationDetail:"AnnotationDetail---annotationDetail",active:"AnnotationDetail---active",annotationHeader:"AnnotationDetail---annotationHeader",activeIcon:"AnnotationDetail---activeIcon",editing:"AnnotationDetail---editing",actionButtons:"AnnotationDetail---actionButtons",edit:"AnnotationDetail---edit",editImage:"AnnotationDetail---editImage",save:"AnnotationDetail---save",cancel:"AnnotationDetail---cancel"}}}]);